{"version":3,"sources":["../../03/JScomponents/modules/dataHandler/filterLocation.js","../../03/JScomponents/modules/dataHandler/filterYear.js","../../03/JScomponents/modules/dataHandler/flipData.js","../../03/JScomponents/modules/dataHandler/getHumanReadData.js","../../03/JScomponents/modules/dataHandler/sortDimensions0.js","../../03/JScomponents/modules/dataHandler/sortDimensions0sum.js","../../03/JScomponents/modules/dataHandler/sortDimensions1.js","../../03/JScomponents/modules/dataHandler/getLatestYearData.js","../../03/JScomponents/modules/dataHandler/getTableData.js","../../03/JScomponents/modules/maps/getMapData.js","../../03/JScomponents/modules/maps/getIndicatorColorScale.js","../../03/JScomponents/modules/maps/getBubbleSize.js","../../03/JScomponents/modules/maps/getDisputedLines.js","../../03/JScomponents/modules/maps/getMapSubPoints.js","../../03/JScomponents/modules/maps/addMapLayers.js","../../03/JScomponents/modules/maps/updateLegend.js","../../03/JScomponents/modules/maps/mapStandardPlotting.js","../../03/JScomponents/modules/maps/highlightAndPopup.js","../../03/JScomponents/modules/maps/getFlows.js","../../03/JScomponents/modules/maps/updateFlowData.js","../../03/JScomponents/modules/mapTeaser/mapTeaserText.js","../../03/JScomponents/modules/mapTeaser/mapTeaserTextMulti.js","../../03/JScomponents/modules/mapTeaser/mapTeaserExportRestrictions.js","../../03/JScomponents/modules/mapTeaser/mapTeaserExportRestrictionsMain.js","../../03/JScomponents/modules/mapTeaser/mapTeaserIfiCountryData.js","../../03/JScomponents/modules/mapLayers/mapLayerFuncs.js","../../03/JScomponents/modules/mapLayers/mapWizardLayer.js","../../03/JScomponents/modules/mapLayers/updateCountryProfile.js","../../03/JScomponents/modules/mapLayers/updateCountryProfileSimple.js","../../03/JScomponents/modules/tables/addSimpleTable.js","../../03/JScomponents/modules/tables/addComplexTable.js","../../03/JScomponents/modules/highcharts/simpleChartsCore.js","../../03/JScomponents/modules/highcharts/simpleChartConfigs.js"],"names":["filterLocation","d","filter","parseFilter","$","each","k","v","push","toUpperCase","newData","title","definition","options","data","dimensions","keys","key","value","inArray","a","indexOf","filterYear","idxYear","cr","yKey","flipData","r","slice","reverse","map","i0","i1","getHumanReadData","number","decimals","trimZeros","undefined","parseFloat","abs","Math","decimalAdjust","type","exp","isNaN","NaN","toString","split","toFixed","s","replace","spaceSeparateNumber","val","test","commaSeparateNumber","window","lang_labels","sortDimension0","key1","desc","sorted","i","sort","b","sortDimension0sum","add","reduce","sortDimension1","key0","l","getLatestYearData","latestYear","length","getTableData","getMapData","wizardConfig","page","countrylist","Chart","tab","project","tabs","mapType","flowStatus","ConfigProject","getPageCharts","DataforMap","DataforMap1","max","charts","labels","order","name","unit","getCountryData","minimum","minValueLatest","maximum","maxValueLatest","chart","values","MapColors","lang","dMax","dMin","minColor","quantize","x","idx","maxColor","pageCharts","minValue","series","min","maxValue","arrayValue","getStandardDeviationWizard","devVal","average","getAverageFromNumArr","deviation","getStandardDeviation","group","getIndicatorColorScale","feature","colors","properties","mapCode","toLowerCase","MapGroup","landmass","range","scaleToInteger","scaleMin","scaleMax","floor","getBubbleSize","radius","sqrt","getDisputedLines","lines","disputedLinesNew","features","SOVEREIGNT","getMapSubPoints","mapCentroides","themeURL","mapSubPoints","smallIslands","this","addMapLayers","bubbleMap","mapdataviz","bubbles","layers","layerName","L","geoJson","mapShapes","style","getBasicCountryShapesStyle","clickable","addTo","matchIndex","value1","colorIndicator","pointToLayer","bubblesSizeColorGeneric","onEachFeature","highlightAndPopup","html","text","updateMultiLegend","mapLayerIndex","mapLayerMatchIndex","width","control","collapsed","click","index","parent","closePopup","updateLegend","bubblesSimpleGeneric","updateFlowData","maxBubble","clearFlows","clearFlowLegend","shapes","layerGroup","getColorCountryShapesStyleGeneric","bubblesSimpleColorGeneric","stamp","DataforMapAll","defaultLayer","embed","textColor","hex","match","rgb","parseInt","apply","Data","mode","empty","append","color","el","addClass","css","subtext","lang_countries","show","hide","relatedDataControl","updateColors","id","setLegend","chartType","loopMapIndicator","setInterval","changeColor","changeBubble","currentLayer","removeLayer","layer","random","landmassBorder","landmassBorderWidth","landmassGroup","bubbleDefaultBorder","bubbleDefaultColor","bubbleHighlightBorder","shapeHighlightBorder","landmassNA","layerData","weight","opacity","fillOpacity","fillColor","className","latlng","circleMarker","getBubbleStyleGeneric","colorData","getBubbleColorGeneric","sizeData","getBubbleSizeColorGeneric","bubbleColor","getBasicGroupColor","interaction","clickFlow","inEuroArea","on","mouseover","inFront","setStyle","bringToFront","mouseout","disputedLines","flowGroup","eachLayer","sublayer","Util","setOptions","notClickable","e","target","specialTooltip","specialTooltipLinks","teaserText","mapTeaserExportRestrictionsMain","mapTeaserExportRestrictions","mapTeaserIfiCountryData","mapTeaserTextMulti","mapTeaserText","popup","setLatLng","setContent","_map","openOn","popupLoop","countryISO","Centroides","setView","colorIdx","activeLayer","layerCode","addLines","center","stars","getFlows","centroides","updateFlowLegend","clearLayers","country","DataforFlow","idxCountry","crData","crData1","getLineSize","flowLabels","tableHead1","en","cn","tableHead2","world","unspecified","asia","headlinePrefix","headlineSuffix","remove","legendData","getFlowsLegend","round","flow","centros","Lat","Long","polyline","latlong","fill","addLayer","indicator","ajax","dataType","url","baseURL","success","ajaxSuccess","error","xhr","ajaxOptions","thrownError","status","alert","euGroup","teaser","teaserTitle","teaserTable","countryProfile","attr","countrynotes","countryName","ISO3toFlags","tableLineCanvas","tooltipData","dataValue","hasData","ChartsWithData","after","teaserTitleStart","teaserTitleEnd","teaserTableStart","teaserTableLineCenter","teaserTableEnd","tableLines","tableLine","labels2","1","2","3","4","5","6","links","link","topLarge","heightSmall","largeContainer","height","top","fadeIn","fadeOut","padding-top","largeContainerPDF","smallContainer","animate","startContainer","document","ready","subTabsType","teaserLayer","secondVisit","TabCountryNote","subTabs","updateCountryProfileSimple","updateCountryProfile","siblings","removeClass","profileCountry","lang_countries_titles","subTab","subTabVal","content","section","subSection","element","parts","addChartSections","subSubSection","subkey","subcontent","display","expand","expandElements","nextUntil","slideToggle","toggle","find","sectionName","sectionLevel","config","chartHeader","ConfigSubCharts","tooltipUnit","addSimpleTable","legendType","addLineChart","addColumnChart","highlightDataPoint","addCharts","complexCharts","complexTable","addBarChart","complexTableLabel","addComplexTable","tablesorter","formatInt","formatFloat","sortList","headers","sorter","textExtraction","node","txt","tableLabels","0","labels1","selectedLabels","head","foot","rows","concat","commodityLabels","purposeCodes","labels3","A","B","C","D","E","F","G","H","I","J","labels4","labels5","comLabel","restrictExplain","purpCode","purpCodeExplain","purpCodeList","codeValue","valRow1","valRow2","labelRow1","labelRow2","ChartElement","self","loadChart","newChart","chartBasis","loadData","displayCharts","container","displayChart","loadedData","defaults","highcharts","backgroundColor","plotOptions","marker","enabled","states","hover","pointPadding","borderWidth","connectNulls","exporting","legend","credits","xAxis","step","fontSize","yAxis","CYCoptions","typeOfFirstSeries","extend","categories","dataPoints","y","cats","seriesOptions","renderTo","Highcharts","labelFormat","translatedLables","flag","tooltipFormat","points","numericSymbols","sbars","loadAndDisplayData","verticalAlign","padding","margin","markers","lineWidth","reversed","tickmarkPlacement","font-size","tooltip","shared","useHTML","headerFormat","pointFormat","footerFormat","tooltipDecimals","addLineStackedBarChart","area","stacking","bar","column","addStackedAreaChart","marginBottom","dataLabels","overflow","crop","allowOverlap","gridLineWidth","addBarChartFlag","translatedLabels","marginLeft","formatter","addBarsDiamondsChart","lineWidthPlus","addStackedColumnChart","addStackedBarChart","addPyramidRight","animation","opposite","addPyramidLeft"],"mappings":"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","file":"mapWizardLayer.min.js","sourcesContent":["\n\n\nfunction filterLocation(d,filter) {\n  var parseFilter  = [];\n  $.each(filter, function (k,v) {\n    parseFilter.push(v.toUpperCase());\n  });\n\tvar newData = {}\n\tnewData['title'] = d.title\n\tnewData['definition'] = d.definition\n\tnewData['options'] = d.options\n\tnewData['data'] = {}\n\tnewData.data['dimensions'] = d.data.dimensions;\n\tnewData.data['keys'] = [];\n\tnewData.data['keys'][0] = [];\n\tnewData.data['keys'][1] = d.data.keys[1];\n\tnewData.data['data'] = [];\n\t$.each(d.data.keys[0], function (key,value) {\n\t\tif ($.inArray(value.toUpperCase(),parseFilter)>-1) {\n\t\t\tnewData.data.keys[0].push(value.toUpperCase());\n\t\t\tvar a = d.data.keys[0].indexOf(value);\n\t\t\tnewData.data.data.push(d.data.data[a]);\n\t\t}\n  });\n\treturn newData;\n}\n","\n\n\nfunction filterYear(d,filter) {\n\tvar newData = {}\n\tnewData['title'] = d.title\n\tnewData['definition'] = d.definition\n\tnewData['options'] = d.options\n\tnewData['data'] = {}\n\tnewData.data['dimensions'] = d.data.dimensions;\n\tnewData.data['keys'] = [];\n\tnewData.data['keys'][0] = d.data.keys[0];\n\tnewData.data['keys'][1] = [];\n\tnewData.data['data'] = [];\n\tvar idxYear = []\n\t$.each(filter, function (key,value) {\n\t\tidxYear.push(d.data.keys[1].indexOf(value))\n\t\tnewData.data.keys[1].push(value);\n\t});\n\t$.each(newData.data.keys[0], function(key,cr){\n\t\tnewData.data.data[key] = [];\n\t\t$.each(idxYear, function (yKey,value) {\n\t\t\tnewData.data.data[key].push(d.data.data[key][value])\n\t\t});\n\t});\n\treturn newData;\n}\n","\n\n//flips dimensions on two dimensional data model\nfunction flipData(d) {\n    var r = {keys: d.keys.slice(0), dimensions: d.dimensions.slice(0)};\n    r.keys.reverse();\n    r.dimensions.reverse();\n    r.data = r.keys[0].map(function(k, i0) {\n        return r.keys[1].map(function(k, i1) {\n            return d.data[i1][i0];\n        });\n    });\n    return r;\n}\n","// function to convert large numbers in human readable numbers\n// passing a negative number for decimals returns the unmodified number\nfunction getHumanReadData(number, decimals, trimZeros) {\n  if (decimals === undefined) {\n    decimals = 0;\n  }\n\n  if (decimals < 0) {\n    return number;\n  }\n\n  number = parseFloat(number);\n  var abs = Math.abs(number);\n\n  /* code from MDN (public domain)\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round$revision/981487#Decimal_rounding\n  */\n  /**\n   * Decimal adjustment of a number.\n   *\n   * @param {String}  type  The type of adjustment.\n   * @param {Number}  value The number.\n   * @param {Integer} exp   The exponent (the 10 logarithm of the adjustment base).\n   * @returns {Number} The adjusted value.\n   */\n  function decimalAdjust(type, value, exp) {\n    // If the exp is undefined or zero...\n    if (typeof exp === 'undefined' || +exp === 0) {\n      return Math[type](value);\n    }\n    value = +value;\n    exp = +exp;\n    // If the value is not a number or the exp is not an integer...\n    if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0)) {\n      return NaN;\n    }\n    // Shift\n    value = value.toString().split('e');\n    value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));\n    // Shift back\n    value = value.toString().split('e');\n    return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));\n  }\n\n  function toFixed(number, decimals) {\n    var s = decimalAdjust('round', number, -decimals).toFixed(decimals);\n    return trimZeros ? s.replace(/\\.0+$|(\\..*?)0+$/,'$1') : s;\n  }\n\n  // this function prints larger number in OECD format 10 000.23 usw.\n  function spaceSeparateNumber(val){\n    while (/(\\d+)(\\d{3})/.test(val.toString())){\n      val = val.toString().replace(/(\\d+)(\\d{3})/, '$1' + ' ' + '$2');\n    }\n    return val;\n  }\n\n  // this function prints larger number in US format 10,000.23 usw.\n  function commaSeparateNumber(val){\n    while (/(\\d+)(\\d{3})/.test(val.toString())){\n      val = val.toString().replace(/(\\d+)(\\d{3})/, '$1' + ',' + '$2');\n    }\n    return val;\n  }\n\n  if(abs > 1e12) {\n    return toFixed(number / 1e12, decimals) + '&nbsp;' + window.lang_labels['trillion'];\n  } else if(abs > 1e9) {\n    return toFixed(number / 1e9, decimals) + '&nbsp;' + window.lang_labels['billion'];\n  } else if(abs > 1e6) {\n    return toFixed(number / 1e6, decimals) + '&nbsp;' + window.lang_labels['million'];\n  } else if(abs > 1e5) {\n    return toFixed(number / 1e3, decimals) + '&nbsp;' + window.lang_labels['thousand'];\n  } else {\n    return spaceSeparateNumber(toFixed(number, decimals));\n  }\n}\n","// sorts first dimension on key of second dimension\nfunction sortDimension0(d, key1, desc) {\n  desc = desc || true;\n  var r = {dimensions: d.dimensions, keys: d.keys.slice(0)};\n  var sorted = d.data.map(function(v, i) {\n    return {v: v, i: i};\n  });\n  sorted.sort(function(a, b) {\n    return (a.v[key1] == b.v[key1]) ? 0\n            : (a.v[key1] == null) ? 1\n            : (b.v[key1] == null) ? -1\n            : (a.v[key1] < b.v[key1]) != desc ? -1\n            : 1;\n  });\n  r.data = sorted.map(function(v) {\n    return v.v;\n  });\n  r.keys[0] = sorted.map(function(v) {\n    return d.keys[0][v.i];\n  });\n  return r;\n}\n","// sorts first dimension on sum of keys of second dimension\nfunction sortDimension0sum(d, desc) {\n  function add(a, b) {\n    return a == null ? b\n         : b == null ? a\n         : a + b;\n  }\n  desc = desc || true;\n  var r = {dimensions: d.dimensions, keys: d.keys.slice(0)};\n  var sorted = d.data.map(function(v, i) {\n    return {v: v, i: i};\n  });\n  sorted.sort(function(a, b) {\n    return (a.v.reduce(add, 0) == b.v.reduce(add, 0)) ? 0\n            : (a.v.reduce(add, 0) < b.v.reduce(add, 0)) != desc ? -1\n            : 1;\n  });\n  r.data = sorted.map(function(v) {\n    return v.v;\n  });\n  r.keys[0] = sorted.map(function(v) {\n    return d.keys[0][v.i];\n  });\n  return r;\n}\n","// sorts second dimension on key of first dimension\nfunction sortDimension1(d, key0, desc) {\n  desc = desc || true;\n  var r = {dimensions: d.dimensions, keys: d.keys.slice(0)};\n  var sorted = d.data[key0].map(function(v, i) {\n    return {v: v, i: i};\n  });\n  sorted.sort(function(a, b) {\n    return (a.v == b.v) ? 0\n           : (a.v == null) ? 1\n           : (b.v == null) ? -1\n           : (a.v < b.v) != desc ? -1\n           : 1;\n  });\n  r.data = d.data.map(function(l) {\n    return sorted.map(function(v) {\n      return l[v.i];\n    });\n  });\n  r.keys[1] = sorted.map(function(v) {\n    return d.keys[1][v.i];\n  });\n  return r;\n}\n","\n\n\n// returns the latest available year for a two dimensional JSON data set\n\nfunction getLatestYearData (data) {\n  var newData = {};\n  var latestYear = data.keys[1].length-1;\n  $.each(data.keys[0], function (key,value) {\n      newData[value]=[];\n      while (data.data[data.keys[0].indexOf(value)][latestYear] == null && latestYear>=0) {\n          latestYear = latestYear-1;\n      };\n      newData[value][0]=data.keys[1][latestYear];\n      newData[value][1]=data.data[data.keys[0].indexOf(value)][latestYear];\n      latestYear = data.keys[1].length-1;\n  });\n  return newData;\n}\n","\n//convert JSON model into table format\n\nfunction getTableData (data) {\n\tvar newData = {};\n\t$.each(data.keys[1], function (key,value) {\n\t  newData[value]={};\n\t  $.each(data.keys[0], function (k,v) {\n\t  newData[value][v] = data.data[data.keys[0].indexOf(v)][data.keys[1].indexOf(value)];\n\t  });\n\t});\n\treturn newData;\n}\n","\nfunction getMapData (wizardConfig,page,countrylist,Chart) {\n\n  var tab = wizardConfig.project.tabs[page];\n  var mapType = wizardConfig.tabs[tab].mapType;\n  var flowStatus = wizardConfig.tabs[tab].type;\n\n  var ConfigProject = getPageCharts(wizardConfig,page);\n\n  var DataforMap = [];\n  var DataforMap1 = [];\n  \n  var data = {};\n\n  data['defaultLayer'] = 0;\n  if (Chart != null) {\n// set default layer to index of first element of Chart or 0\n    data['defaultLayer'] = Math.max(0, wizardConfig.tabs[tab].charts.indexOf(Chart[0]));\n  }\n\n  if (mapType == 'TwoIndicatorsSplitOnYears') {\n//returns data of the first chart as separate maps - split on the YEARS dimension (data.keys[1])\n//returns data of the second chart as separate maps - split on the YEARS dimension (data.keys[1])\n\n    var labels = wizardConfig.tabs[tab].labels;\n    var key=0;\n    $.each(labels.order, function (order,value) {\n      if($.inArray(value, ConfigProject[0].data.keys[1]) > -1) {\n        DataforMap[key]               = filterYear(ConfigProject[0],[value]);\n        if (labels.labels[value]) {\n          DataforMap[key]['title']      = labels.labels[value].name;\n          DataforMap[key]['unit']      = labels.labels[value].unit;\n        } else {\n          DataforMap[key]['title']      = value;\n          DataforMap[key]['unit']      = '';\n        }\n        DataforMap[key]['code']       = value;\n        DataforMap[key]['definition'] = value;\n        DataforMap[key]['values']     = getCountryData(getLatestYearData(DataforMap[key]['data']),countrylist);\n  \n        if (ConfigProject[0].options.minimum && ConfigProject[0].options.minimum != null) {\n          DataforMap[key]['min']      = ConfigProject[0].options.minimum;\n        } else {\n          DataforMap[key]['min']      = minValueLatest(DataforMap[key]['values']);\n        }\n        if (ConfigProject[0].options.maximum && ConfigProject[0].options.maximum != null) {\n          DataforMap[key]['max']      = ConfigProject[0].options.maximum;\n        } else {\n          DataforMap[key]['max']      = maxValueLatest(DataforMap[key]['values'],1);\n        }\n        DataforMap[key]['latestYear'] = maxValueLatest(DataforMap[key]['values'],0);\n        key++;\n      }\n    });\n\n    if (ConfigProject[1] != null) {\n      $.each(ConfigProject[1].data.keys[1], function (key, value) {\n        DataforMap1[key] = filterYear(ConfigProject[1],[value]);\n        if (labels.labels[value]) {\n          DataforMap1[key]['title']      = labels.labels[value].name;\n        } else {\n          DataforMap1[key]['title']      = value;\n        }\n        DataforMap1[key]['code']        = value;\n        DataforMap1[key]['definition']  = value;\n        DataforMap1[key]['values']      = getCountryData(getLatestYearData(DataforMap1[key]['data']),countrylist);\n  \n        if (ConfigProject[1].options.minimum && ConfigProject[1].options.minimum != null) {\n          DataforMap1[key]['min']       = ConfigProject[1].options.minimum;\n        } else {\n          DataforMap1[key]['min']       = minValueLatest(DataforMap1[key]['values']);\n        }\n        if (ConfigProject[1].options.maximum && ConfigProject[1].options.maximum != null) {\n          DataforMap1[key]['max']       = ConfigProject[1].options.maximum;\n        } else {\n          DataforMap1[key]['max']       = maxValueLatest(DataforMap1[key]['values'],1);\n        }\n        DataforMap1[key]['latestYear']  = maxValueLatest(DataforMap1[key]['values'],0);\n      });\n    }\n\n\n  } else {\n\n    var i=0;\n    $.each(ConfigProject, function (chart, values) {\n      if (values.type != 'flow') {\n        DataforMap[i] = {};\n        DataforMap[i]['colors']     = MapColors;\n        DataforMap[i]['title']      = values['title'][lang];\n        DataforMap[i]['definition'] = values['definition'][lang];\n        DataforMap[i]['options']    = values['options'];\n        DataforMap[i]['values']     = getCountryData(getLatestYearData(values['data']),countrylist);\n        if (DataforMap[i]['options']['minimum'] && DataforMap[i]['options']['minimum'] != null) {\n          DataforMap[i]['min']    = DataforMap[i]['options']['minimum'];\n        } else {\n          DataforMap[i]['min']    = minValueLatest(DataforMap[i]['values']);\n      //    DataforMap[i]['min'] = getStandardDeviationWizard(DataforMap[i]['values'],'min');\n        }\n        if (DataforMap[i]['options']['maximum'] && DataforMap[i]['options']['maximum'] != null) {\n          DataforMap[i]['max']    = DataforMap[i]['options']['maximum'];\n        } else {\n          DataforMap[i]['max']    = maxValueLatest(DataforMap[i]['values'],1);\n      //    DataforMap[i]['max'] = getStandardDeviationWizard(DataforMap[i]['values'],'max');\n        }\n        if (DataforMap[i]['options']['mapDivergent']) {\n          var dMax = Math.max(Math.abs(DataforMap[i]['min']), Math.abs(DataforMap[i]['max']));\n          var dMin = -dMax;\n          // adjust color scale if min/max is assymetric\n          var minColor = quantize(DataforMap[i]['min'], dMin, dMax, DataforMap[i]['colors'].map(function (x,idx) { return idx; }));\n          var maxColor = quantize(DataforMap[i]['max'], dMin, dMax, DataforMap[i]['colors'].map(function (x,idx) { return idx; }));\n          if (minColor > 0) {\n            dMin += minColor * (dMax - dMin) / DataforMap[i]['colors'].length;\n            DataforMap[i]['colors'] = DataforMap[i]['colors'].slice(minColor);\n          } else if (maxColor+1 < DataforMap[i]['colors'].length) {\n            dMax -= (DataforMap[i]['colors'].length - (maxColor+1)) * (dMax - dMin) / DataforMap[i]['colors'].length;\n            DataforMap[i]['colors'] = DataforMap[i]['colors'].slice(0, maxColor+1);\n          }\n          DataforMap[i]['max'] = dMax;\n          DataforMap[i]['min'] = dMin;\n        }\n        DataforMap[i]['latestYear'] = maxValueLatest(DataforMap[i]['values'],0);\n        if ('mapRegion' in DataforMap[i]['options']) {\n          DataforMap[i]['values'][DataforMap[i]['options']['mapRegion']] = getLatestYearData(values['data'])[DataforMap[i]['options']['mapRegion']];\n        }\n        i = i+1;\n      }\n    });\n\n  }\n  \n  data['map'] = DataforMap;\n  data['map1'] = DataforMap1;\n  data['flow'] = flowStatus;\n\n  function getPageCharts (wizardConfig,page) {\n    var tab = wizardConfig.project.tabs[page];\n    var charts = wizardConfig.tabs[tab].charts;\n\n    var pageCharts = [];\n    $.each(charts, function (k,v){\n      pageCharts.push(wizardConfig.charts[v]);\n    });\n    return pageCharts;\n  };\n\n  function minValue(series) {\n    //private\n    var min = null;\n    $.each(series, function (k, v) {\n      if (v == null) return;\n      if (min == null) min = v;\n      else if (min > v) min = v;\n    });\n    return min;\n  }\n\n  function maxValue(series) {\n    //private\n    var max = null;\n    $.each(series, function (k, v) {\n      if (v == null) return;\n      if (max == null) max = v;\n      else if (max < v) max = v;\n    });\n    return max;\n  }\n\n  function minValueLatest(series) {\n    //public\n    var min = null;\n    $.each(series, function (k, v) {\n      v = v[1];\n      if (v == null) return;\n      if (min == null) min = v;\n      else if (min > v) min = v;\n    });\n    return min;\n  }\n\n  function maxValueLatest(series, arrayValue) {\n    //public\n    var max = null;\n    $.each(series, function (k, v) {\n      v = v[arrayValue];\n      if (v == null) return;\n      if (max == null) max = v;\n      else if (max < v) max = v;\n    });\n    return max;\n  }\n\n  function getStandardDeviationWizard (series,value) {\n    //public\n    var devVal = [];\n    $.each(series, function (k, v) {\n        devVal.push(v[1])\n    });\n    var average = getAverageFromNumArr(devVal, 2 );\n    var deviation = getStandardDeviation(devVal, 2 );\n\n    if (value == 'max') {\n      return (average + deviation);\n    } if (value == 'min') {\n      return (average - deviation);\n    } else {return null;}\n\n  }\n\n  function getCountryData(series, group) {\n    //public\n    var data = {};\n    $.each(series, function (k, v) {\n      if ($.inArray(k, group) > -1) {\n        data[k] = v;\n      }\n    });\n    return data;\n  }\n\n  return data;\n  \n};\n\n\n","function getIndicatorColorScale(d, dMin, dMax, feature, colors) {\n  if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n    return quantize(d, dMin, dMax, colors)\n  } else {\n    return landmass;\n  }\n\n}\n\nfunction quantize(d, dMin, dMax, range) {\n  function scaleToInteger(d, dMin, dMax, scaleMin, scaleMax) {\n    var i = Math.floor((d - dMin) / (dMax - dMin) * (scaleMax - scaleMin + 1)) + scaleMin;\n    if (i < scaleMin) return scaleMin;\n    if (i > scaleMax) return scaleMax;\n    return i;\n  }\n\n  return range[scaleToInteger(d, dMin, dMax, 0, range.length - 1)];\n}\n","\n\nfunction getBubbleSize(d, dMax, feature) {\n  //private\n  if (d == null || d <= 0) return null;\n  var radius = Math.sqrt(d / dMax) * 25;\n  if (radius < 3) radius = 3;\n  return radius;\n}\n","\n\n//returns lines for disputed territories for a given country group\n\nfunction getDisputedLines (lines,group) {\n  var disputedLinesNew = {\n        \"type\": \"FeatureCollection\",\n        \"features\": []\n        }\n  if ($.inArray('ind', group)>-1 || $.inArray('chn', group)>-1 || $.inArray('pak', group)>-1) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'IndiaChinaPakistan' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('ind', group)>-1 || $.inArray('chn', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'IndiaChina' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('egy', group)>-1 || $.inArray('sdn', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'EgyptSudan' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('sdn', group)>-1 || $.inArray('ssd', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'Sudan' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('ken', group)>-1 || $.inArray('som', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'KenyaSom' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  }\n  return disputedLinesNew;\n\n}\n","\n\n\n//adds small islands as dots on color coded maps\n\nfunction getMapSubPoints(mapCentroides) {\n  if (themeURL == 'ecb') return;\n  var mapSubPoints = {\n        \"type\": \"FeatureCollection\",\n        \"features\": []\n        }\n  var smallIslands = ['AND','ATG','AIA','ASM','ABW','ALA','BRB','BLM','BMU','BVT','CCK','COK','CPV','CUW','CXR','DMA','FLK','FSM','GRD','GGY','GIB','GLP','SGS','GUM','HKG','IMN','JEY','KIR','COM','KNA','CYM','LCA','LIE','MCO','MAF','MHL','MAC','MNP','MTQ','MSR','MLT','MUS','MDV','NFK','NRU','NIU','PYF','SPM','PCN','PRI','PLW','REU','SYC','SHN','SJM','SMR','STP','SXM','TCA','ATF','TKL','TON','TTO','TUV','VAT','VCT','VGB','VIR','WLF','WSM','MYT','ANT'];\n  $(mapCentroides.features).each(function(feature){\n    if ($.inArray(this.properties[mapCode], smallIslands) > -1) {\n      mapSubPoints['features'].push(this);\n    }\n  });\n  return mapSubPoints;\n}\n","\n//add mapLayers for the different display types (bubbles, colored bublbes (simple and complex), colored shapes)\n\nfunction addMapLayers (bubbleMap,mapdataviz,flowStatus) {\n  var bubbles=[];\n  var layers={};\n  var layerName=[];\n  \n  if (bubbleMap == 'multiColored') {\n// used on template 'multipleColoredBubbles'\n// A colored bubble map. The first chart sets the bubble size, the second the bubble color. The second dimension (YEARS) is represented as a separate indicator\n\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    var i=0;\n    var matchIndex = [];\n    $.each(DataforMap, function (key, value) {\n      $.each(DataforMap1, function (key1, value1) {\n        if (value1.title == value.title) {\n          matchIndex[key] = key1+1;\n        }\n      });\n\n      if (matchIndex[key]) {\n        var colorIndicator = DataforMap1[matchIndex[key]-1]\n      } else {\n        var colorIndicator = null;\n      }\n\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSizeColorGeneric(value,colorIndicator),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i]['title']).text()] = bubbles[i];\n      i++;\n    });\n\n    bubbles[0].addTo(mapdataviz);\n    updateMultiLegend(DataforMap[0],'size');\n    updateMultiLegend(DataforMap1[matchIndex[0]-1],'color');\n//global variables to define map layer (used for popup window)\n    window.mapLayerIndex = 0;\n    window.mapLayerMatchIndex = matchIndex;\n    if (DataforMap.length > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateMultiLegend(DataforMap[index],'size');\n      updateMultiLegend(DataforMap1[matchIndex[index]-1],'color');\n      mapdataviz.closePopup();\n      window.mapLayerIndex = index;\n    });\n\n  } else if (bubbleMap == 'colored') {\n// first indicator bubble size, all other indicators bubble color\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    for (i=0;i<DataforMap.length-1;i++) {\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSizeColorGeneric(DataforMap[0],DataforMap[i+1]),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i+1]['title']).text()] = bubbles[i]\n    }\n    bubbles[0].addTo(mapdataviz);\n    updateLegend(DataforMap[0],'size');\n    updateLegend(DataforMap[1],'color');\n    if (DataforMap.length-1 > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateLegend(DataforMap[index+1],'color');\n    });\n\n  } else if (bubbleMap == 'coloredPairUnpair') {\n// pair indicators bubble size, unpair indicators bubble color\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    for (i=0;i<DataforMap.length/2;i++) {\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSizeColorGeneric(DataforMap[i*2],DataforMap[(i*2)+1]),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i*2]['title']).text()] = bubbles[i]\n    }\n    bubbles[0].addTo(mapdataviz);\n    updateLegend(DataforMap[0],'size');\n    updateLegend(DataforMap[1],'color');\n    if (DataforMap.length-1 > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateLegend(DataforMap[index*2],'size');\n      updateLegend(DataforMap[(index*2)+1],'color');\n    });\n\n\n  } else if (bubbleMap == 'simple') {\n\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    for (i=0;i<DataforMap.length;i++) {\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSimpleGeneric(DataforMap[i]),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i]['title']).text()] = bubbles[i]\n    }\n    bubbles[0].addTo(mapdataviz);\n//add flows\n    if (flowStatus=='flow') {\n      updateLegend(DataforMap[0],'flows');\n      updateFlowData(DataforMap[0]['code']);\n//add global variable for value behind bubble size as a scaling reference for flow lines\n      window.maxBubble = DataforMap[0]['max'];\n    } else {\n      updateLegend(DataforMap[0],'size');\n    }\n    \n    if (DataforMap.length > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n//add flows\n      if (flowStatus=='flow') {\n        updateFlowData(DataforMap[index]['code']);\n        clearFlows();\n        clearFlowLegend();\n        updateLegend(DataforMap[index],'flows');\n//add global variable for value behind bubble size as a scaling reference for flow lines\n        window.maxBubble = DataforMap[index]['max'];\n      } else {\n        updateLegend(DataforMap[index],'size');\n      }\n    });\n\n  } else {\n\n    var shapes=[];\n    var layerGroup=[];\n    var mapSubPoints = getMapSubPoints(mapCentroides);\n\n    for (i=0;i<DataforMap.length;i++) {\n      shapes[i] = L.geoJson(\n        mapShapes, {\n          style: getColorCountryShapesStyleGeneric(DataforMap[i]),\n          onEachFeature: highlightAndPopup,\n          clickable: false\n        });\n      if (mapSubPoints != undefined) {\n        bubbles[i] = L.geoJson(\n          mapSubPoints, {\n            pointToLayer: bubblesSimpleColorGeneric(DataforMap[i]),\n            onEachFeature: highlightAndPopup\n          });\n        layerGroup[i] = L.layerGroup([shapes[i],bubbles[i]])\n      } else {\n        layerGroup[i] = L.layerGroup([shapes[i]])\n      }\n      // force the layer control to display the indicators in the correct order\n      L.stamp(layerGroup[i]);\n      layerName[$('<div>').html(DataforMap[i]['title']).text()] = layerGroup[i];\n    }\n    layerGroup[DataforMapAll.defaultLayer].addTo(mapdataviz);\n    updateLegend(DataforMap[DataforMapAll.defaultLayer],'color');\n    if (DataforMap.length > 1) {\n      if ($(window).width() < 750 || embed == 2) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateLegend(DataforMap[index],'color');\n    });\n\n  }\n\n}\n","function textColor(hex) {\n  var match = hex.match(/^#(..)(..)(..)$/);\n  if (match) {\n    var rgb = match.slice(1).map(function (s) { return parseInt(s, 16) / 255; });\n    // calculate L from HSL\n    var L = (Math.min.apply(null, rgb) + Math.max.apply(null, rgb)) / 2;\n    return L < 0.5 ? '#fff' : '#000';\n  } else {\n    return '#000';\n  }\n}\n\nfunction updateLegend(Data,mode) {\n  if (mode == 'color') {\n    if (Data) {\n      var colors = Data['colors'];\n      $('#legendMinColor').parent().parent()\n        .empty()\n        .append(colors.map(function (color, idx, colors) {\n          var el = $('<li>');\n          if (idx === 0) {\n            el.addClass('firstLegendElement');\n            el.append($('<span id=\"legendMinColor\" class=\"firstLegendElement\">').css('background', color).css('color', textColor(color)));\n          } else if (idx+1 === colors.length) {\n            el.addClass('lastLegendElement');\n            el.append($('<span id=\"legendMaxColor\" class=\"lastLegendElement\">').css('background', color).css('color',  textColor(color)));\n          } else {\n            el.append($('<span>').css('background', color));\n          }\n          return el;\n        }));\n      $('#legendMaxColor').html(getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendMinColor').html(getHumanReadData(Data['min'],Data['options']['tooltipDecimals']));\n      $('#legendTitleColor').text($('<div>').html(Data['title']).text());\n\n      if ('mapRegion' in Data['options'] && Data['options']['mapRegion'] != '' && Data['values'][Data['options']['mapRegion']]) {\n        var subtext = lang_countries[Data['options']['mapRegion'].toLowerCase()]+': '+getHumanReadData(Data['values'][Data['options']['mapRegion']][1],Data['options']['tooltipDecimals']);\n        if (Data['options']['tooltipUnit']!= '') {\n          subtext += ' '+Data['options']['tooltipUnit'];\n        }\n        if (Data['values'][Data['options']['mapRegion']][0] != Data['latestYear']) {\n          subtext += ' ('+Data['values'][Data['options']['mapRegion']][0]+')';\n        }\n        $('#legendSubtextColor').html(subtext);\n        $('#legendSubtextColor').show();\n        if ('mapSource' in lang_labels) {\n          $('#topContainer').css('height', '66px');\n        } else {\n          $('#topContainer').css('height', '58px');\n        }\n      } else {\n        if ('mapSource' in lang_labels) {\n          $('#topContainer').css('height', '58px');\n        }\n        $('#legendSubtextColor').hide();\n      }\n\n      if (window.relatedDataControl) {\n        window.relatedDataControl.updateColors(function (id) {\n          return Data.values[id] && quantize(Data.values[id][1], Data.min, Data.max, Data.colors);\n        });\n      }\n\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitColor').text(', '+Data['options']['tooltipUnit']);\n      } else {\n        $('#legendUnitColor').text('');\n      }\n      $('#legendYearColor').text(Data['latestYear']);\n    } else {\n      $('#legendMaxColor').html('');\n      $('#legendMinColor').html('');\n      $('#legendTitleColor').text('No data available');\n      $('#legendUnitColor').text('');\n      $('#legendYearColor').text('');\n    }\n  } else if (mode == 'flows') {\n    if (Data) {\n      $('#legendBubble').html(window.lang_labels['min']+': '+getHumanReadData(Data['min'],Data['options']['tooltipDecimals']) +' - '+window.lang_labels['max']+': '+getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendTitleSize').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitSize').text(', '+Data['options']['tooltipUnit']);\n      } else {\n        $('#legendUnitSize').text('');\n      }\n      $('#legendYearSize').text('');\n    } else {\n      $('#legendBubble').html('');\n      $('#legendTitleSize').text('No data available');\n      $('#legendUnitSize').text('');\n      $('#legendYearSize').text('');\n    }\n  } else {\n    if (Data) {\n      $('#legendBubble').html(window.lang_labels['min']+': '+getHumanReadData(Data['min'],Data['options']['tooltipDecimals']) +' - '+window.lang_labels['max']+': '+getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendTitleSize').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitSize').text(', '+Data['options']['tooltipUnit']);\n      } else {\n        $('#legendUnitSize').text('');\n      }\n      $('#legendYearSize').text(Data['latestYear']);\n    } else {\n      $('#legendBubble').html('');\n      $('#legendTitleSize').text('No data available');\n      $('#legendUnitSize').text('');\n      $('#legendYearSize').text('');\n    }\n  }\n  $('#flowLayer .commodity').text(Data['title']);\n\n}\n\n\nfunction updateMultiLegend(Data,mode) {\n  if (mode == 'color') {\n    if (Data) {\n      $('#legendMaxColor').html(getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendMinColor').html(getHumanReadData(Data['min'],Data['options']['tooltipDecimals']));\n      $('#legendTitleColor').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitColor').text(', '+Data['unit']);\n      } else {\n        $('#legendUnitColor').text('');\n      }\n      $('#legendYearColor').text('');\n    } else {\n      $('#legendMaxColor').html('');\n      $('#legendMinColor').html('');\n      $('#legendTitleColor').text('No data available');\n      $('#legendUnitColor').text('');\n      $('#legendYearColor').text('');\n    }\n  } else {\n    if (Data) {\n      $('#legendBubble').html(window.lang_labels['min']+': '+getHumanReadData(Data['min'],Data['options']['tooltipDecimals']) +' - '+window.lang_labels['max']+': '+getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendTitleSize').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitSize').text(', '+Data['unit']);\n      } else {\n        $('#legendUnitSize').text('');\n      }\n      $('#legendYearColor').text('');\n    } else {\n      $('#legendBubble').html('');\n      $('#legendTitleSize').text('No data available');\n      $('#legendUnitSize').text('');\n      $('#legendYearSize').text('');\n    }\n  }\n}\n\n\n\nfunction setLegend(chartType,bubbleMap) {\n\n  if (bubbleMap == 'colored' || bubbleMap == 'multiColored' || bubbleMap == 'coloredPairUnpair') {\n    $('#textLegend').hide();\n  } else if (bubbleMap == 'simple') {\n    $('#colorLegend').hide();\n    if (chartType == 'mapWizard') {\n      $('#textLegend').hide();\n      $('#sizeLegend').css({\"width\": \"100%\"});\n    }\n  } else {\n    $('#sizeLegend').hide();\n    if (chartType == 'mapWizard') {\n      $('#textLegend').hide();\n      $('#colorLegend').css({\"width\": \"100%\"});\n    }\n  }\n}\n\n\nfunction loopMapIndicator (mode) {\n\n  if (mode == 'color') {\n    setInterval(changeColor,2000);\n  } else if (mode == 'bubble') {\n    setInterval(changeBubble,2000);\n  }\n\n  var currentLayer = 0;\n\n  function changeBubble() {\n    mapdataviz.removeLayer(bubbles[currentLayer]);\n    layer = Math.floor((Math.random() * bubbles.length) + 1);\n    currentLayer = layer-1\n    bubbles[currentLayer].addTo(mapdataviz);\n    updateLegend(DataforMap[currentLayer],'size');\n  }\n\n  function changeColor() {\n    mapdataviz.removeLayer(shapes[currentLayer]);\n    layer = Math.floor((Math.random() * shapes.length) + 1);\n    currentLayer = layer-1\n    shapes[currentLayer].addTo(mapdataviz);\n    updateLegend(DataforMap[currentLayer],'color');\n  }\n\n}\n","var landmass;\nvar landmassBorder;\nvar landmassBorderWidth;\nvar landmassGroup;\nvar bubbleDefaultBorder;\nvar bubbleDefaultColor;\nvar bubbleHighlightBorder;\nvar shapeHighlightBorder;\nif (themeURL=='ecb') {\n  landmass = '#f0f0f0';\n  landmassNA = '#fff';\n  landmassBorder = '#000';\n  landmassBorderWidth = 0.5;\n  landmassGroup = '#f0f0f0';\n  bubbleDefaultBorder = \"#494444\";\n  bubbleDefaultColor = \"#d56620\";\n  bubbleHighlightBorder = \"#fff\";\n  shapeHighlightBorder = '#fff';\n} else {\n  landmass = '#939393';\n  landmassNA = '#939393';\n  landmassBorder = '#939393';\n  landmassBorderWidth = 1;\n  landmassGroup = '#BBBBBB';\n  bubbleDefaultBorder = \"#494444\";\n  bubbleDefaultColor = \"#d56620\";\n  bubbleHighlightBorder = \"#fff\";\n  shapeHighlightBorder = '#fff';\n}\n\nif (project == 'trade-in-raw-materials') {\n  landmass = '#BBBBBB';\n  landmassNA = '#BBBBBB';\n}\n\nif (project == 'itf-test') {\n  landmass = '#BBBBBB';\n  landmassNA = '#BBBBBB';\n}\n\nfunction getColorCountryShapesStyleGeneric(layerData) {\n  //public\n  return function (feature) {\n\n    if (feature && feature.properties && layerData['values'][feature.properties[mapCode]] != null) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: getIndicatorColorScale(layerData['values'][feature.properties[mapCode]][1], layerData['min'], layerData['max'], feature, layerData['colors']) || landmassNA,\n        className: \"hasValue\"\n      };\n    } else if (feature && feature.properties && $.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: landmassNA,\n        className: \"hasValue\"\n      };\n    } else if (feature && feature.properties && $.inArray(feature.properties[mapCode].toString().toLowerCase(), [\"aut\", \"bel\", \"cyp\", \"deu\", \"esp\", \"est\", \"fin\", \"fra\", \"grc\", \"irl\", \"ita\", \"ltu\", \"lux\", \"lva\", \"mlt\", \"nld\", \"prt\", \"svk\", \"svn\"]) > -1) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: '#004996',\n        className: \"hasValue\"\n      };\n    } else if (feature && feature.properties && feature.properties[mapCode]) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: landmass,\n        className: \"hasValue\"\n      };\n    } else {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: landmassGroup,\n        className: \"hasValue\"\n      };\n    }\n\n  };\n\n}\n\n\nfunction bubblesSimpleGeneric (Data) {\n  return function (feature, latlng) {\n    //public\n    return L.circleMarker(latlng, getBubbleStyleGeneric(feature, Data));\n  };\n}\n\nfunction bubblesSimpleColorGeneric (colorData) {\n  return function (feature, latlng) {\n    //public\n    return L.circleMarker(latlng, getBubbleColorGeneric(feature,colorData));\n  };\n}\n\nfunction bubblesSizeColorGeneric (sizeData,colorData) {\n  return function (feature, latlng) {\n    //public\n    return L.circleMarker(latlng, getBubbleSizeColorGeneric(feature,sizeData,colorData));\n  };\n}\n\n\n\nfunction getBubbleStyleGeneric(feature, layerData) {\n  //private\n    var bubbleColor;\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1 && layerData['values'][feature.properties[mapCode]] != null) {\n        bubbleColor = bubbleDefaultColor;\n      if (layerData['values'][feature.properties[mapCode]] != null) {\n        var radius = getBubbleSize(layerData['values'][feature.properties[mapCode]][1], layerData['max'], feature);\n        if (radius != null) {\n          return {\n            radius: radius,\n            fillColor: bubbleColor,\n            color: bubbleDefaultBorder,\n            weight: 1,\n            opacity: 1,\n            fillOpacity: 1\n          };\n        }\n      }\n    }\n    return {\n      radius: 0,\n      opacity: 0\n    };\n}\n\n\nfunction getBubbleSizeColorGeneric(feature,sizeData,colorData) {\n  //private\n    var bubbleColor;\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1 && sizeData['values'][feature.properties[mapCode]] != null) {\n      radius = getBubbleSize(sizeData['values'][feature.properties[mapCode]][1], sizeData['max'], feature);\n      if (colorData != null) {\n        if (colorData['values'][feature.properties[mapCode]] != null) {\n          var bubbleColor = getIndicatorColorScale(colorData['values'][feature.properties[mapCode]][1], colorData['min'], colorData['max'],feature, colorData['colors']);\n          if (radius != null) {\n            return {\n              radius: radius,\n              fillColor: bubbleColor,\n              color: bubbleDefaultBorder,\n              weight: 1,\n              opacity: 1,\n              fillOpacity: 1\n            };\n          }\n        }\n      } else {\n        if (radius != null) {\n          return {\n            radius: radius,\n            fillColor: bubbleDefaultBorder,\n            color: bubbleDefaultBorder,\n            weight: 1,\n            opacity: 1,\n            fillOpacity: 1\n          };\n        }\n      }\n    }\n    return {\n      radius: 0,\n      opacity: 0\n    };\n}\n\nfunction getBubbleColorGeneric(feature,colorData) {\n  //private\n    var bubbleColor;\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n        radius = 5;\n      if (colorData['values'][feature.properties[mapCode]] != null) {\n        var bubbleColor = getIndicatorColorScale(colorData['values'][feature.properties[mapCode]][1], colorData['min'], colorData['max'],feature, colorData['colors']);\n        if (radius != null) {\n          return {\n            radius: radius,\n            fillColor: bubbleColor,\n            color: bubbleDefaultBorder,\n            weight: 1,\n            opacity: 1,\n            fillOpacity: 1\n          };\n        }\n      }\n    }\n    return {\n      radius: 0,\n      opacity: 0\n    };\n}\n\n\nfunction getBasicCountryShapesStyle(feature) {\n  //private\n  function getBasicGroupColor(feature) {\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n      return landmassGroup;\n    } else {\n      return landmass;\n    }\n  }\n  return {\n    weight: landmassBorderWidth,\n    opacity: 1,\n    color: landmassBorder,\n    fillOpacity: 1,\n    fillColor: getBasicGroupColor(feature)\n  };\n}\n\n\n\n\n\n","\n\nfunction highlightAndPopup(feature, layer) {\n  if (!(feature && feature.properties && feature.properties[mapCode])) return;\n  //public\n  var interaction;\n  if (window.flowStatus == 'flow') {\n//see module getFlows\n    interaction = clickFlow;\n  } else {\n    interaction = click;\n  }\n  var inEuroArea = feature && feature.properties && $.inArray(feature.properties[mapCode].toString().toLowerCase(), [\"aut\", \"bel\", \"cyp\", \"deu\", \"esp\", \"est\", \"fin\", \"fra\", \"grc\", \"irl\", \"ita\", \"ltu\", \"lux\", \"lva\", \"mlt\", \"nld\", \"prt\", \"svk\", \"svn\"]) > -1;\n  if((themeURL == 'ecb' && !inEuroArea) || $.inArray(layer.feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n    layer.on({\n\n      click: interaction,\n\n      mouseover: function() {\n        if (!layer.inFront) {\n          layer.inFront = true;\n          layer.setStyle({\n            fillOpacity:0.8,\n            weight: 2,\n            color: bubbleMap != null ? bubbleHighlightBorder : shapeHighlightBorder\n            })\n          .bringToFront();\n        }\n      },\n      mouseout: function() {\n        layer.inFront = false;\n        layer.setStyle({\n            fillOpacity: 1,\n            weight: landmassBorderWidth,\n            color: bubbleMap != null ? bubbleDefaultBorder : landmassBorder\n            });\n        if (typeof disputedLines !== 'undefined') {\n          disputedLines.bringToFront();\n        }\n        if (typeof flowGroup !== 'undefined') {\n          flowGroup.eachLayer(function(layer) {\n            if(layer.bringToFront) {\n              layer.bringToFront();\n            } else {\n              layer.eachLayer(function(sublayer){\n                sublayer.bringToFront();\n              });\n            }\n          });\n        }\n      }\n    });\n    // make layers clickable\n    if(layer.eachLayer) {\n      layer.eachLayer(function(sublayer) {\n        L.Util.setOptions(sublayer, {clickable: true});\n      })\n    } else {\n      L.Util.setOptions(layer, {clickable: true});\n    }\n\n  }\n}\n\n\nfunction notClickable(feature, layer) {\n-    //public\n-    // Funktioniert leider nicht zuverlaessig auf allen shapes\n    L.Util.setOptions(layer, {clickable: false});\n}\n\n\nfunction click(e) {\n  //private\n  var layer = e.target;\n  var specialTooltip = window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltip;\n  var specialTooltipLinks = window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltipLinks;\n  var teaserText;\n  if (specialTooltip == 'export-restrictions-main') {\n    teaserText = mapTeaserExportRestrictionsMain(layer.feature.properties[mapCode]);\n  } else if (specialTooltip == 'export-restrictions') {\n    teaserText = mapTeaserExportRestrictions(layer.feature.properties[mapCode]);\n  } else if (specialTooltip == 'ifi-country-data') {\n    teaserText = mapTeaserIfiCountryData(layer.feature.properties[mapCode], specialTooltipLinks);\n  } else if (window.bubbleMap == 'multiColored') {\n    teaserText = mapTeaserTextMulti(layer.feature.properties[mapCode]);\n  } else {\n    teaserText = mapTeaserText(layer.feature.properties[mapCode]);\n  }\n  if (themeURL == 'ecb' || $.inArray(layer.feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n    popup.setLatLng(e.latlng);\n    popup.setContent(teaserText);\n    if (!popup._map) popup.openOn(mapdataviz);\n  }\n}\n\n\nfunction popupLoop(countryISO) {\n  //public\n  var teaserText = mapTeaserText(countryISO);\n  popup.setLatLng([Centroides[countryISO]['Lat'], Centroides[countryISO]['Long']]);\n  mapdataviz.setView([Centroides[countryISO]['Lat'], Centroides[countryISO]['Long']], 2);\n  popup.setContent(teaserText);\n  if (!popup._map) popup.openOn(mapdataviz);\n\n}\n\n","var colorIdx = 0,\n    flowGroup = L.layerGroup(),\n    activeLayer = \"\";\nfunction clickFlow(e) {\n  //private\n  var layer = e.target;\n  var layerCode = layer.feature.properties[mapCode];\n  var color = ['blue', 'blue', 'blue'];\n\n  clearFlows();   \n\n  if (activeLayer != layerCode && $.inArray(layerCode.toLowerCase(), MapGroup) > -1) {\n    addLines(\n      {\n        center: layerCode,\n        stars: getFlows(layerCode)\n      },\n      color[colorIdx],\n      centroides,\n      mapdataviz\n    );\n    colorIdx = (colorIdx + 1) % 3;\n    activeLayer = layerCode;\n    updateFlowLegend (layerCode);\n\n  } else {\n    activeLayer = \"\";\n  }\n}\n\n\nfunction clearFlows () {\n  flowGroup.clearLayers().addTo(mapdataviz);  \n}\n\n\n\nfunction getFlows(country) {\n  var data = window.DataforFlow;\n  var idxCountry = data.keys[0].indexOf(country.toUpperCase());\n  var newData = {};\n  var max = 0;\n  $.each(data.keys[1], function (key, value) {\n    var crData = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n    if (max < crData) {\n      max = crData;\n    }\n  });\n  $.each(data.keys[1], function (key, value) {\n    var crData1 = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n    if (crData1 / max > 0.01) {\n      newData[value] = getLineSize(crData1, window.maxBubble);\n    } else {\n      newData[value] = 0;\n    }\n  });\n\n  function getLineSize(d, max) {\n  //private\n    if (d == null || d <= 0) return null;\n    var width = (Math.sqrt(d / max) * 25);\n    return width;\n  }\n\n  return newData;\n\n}\n\n\nfunction clearFlowLegend () {\n  $('#flowLayer .helptext').show();\n  $('#flowLayer #detailsTable').hide();\n  $('#flowLayer .countryPrefix').text('');\n  $('#flowLayer .country').html('');\n}\n\n\n\nfunction updateFlowLegend (layerCode) {\n\n  var flowLabels = {\n    'tableHead1' : {\n      'en':'Main export destinations',\n      'cn':'主要出口目的地'\n    },\n    'tableHead2' : {\n      'en':'USD Millions',\n      'cn':'百万美元'\n    },\n    'world' : {\n      'en':'World',\n      'cn':'世界'\n    },\n    'unspecified' : {\n      'en':'unspecified',\n      'cn':'未标明'\n    },\n    'asia' : {\n      'en':'Asia n.e.s.',\n      'cn':'亚洲n.e.s.'\n    },\n    'headlinePrefix' : {\n      'en':'Exports from ',\n      'cn':'从'\n    },\n    'headlineSuffix' : {\n      'en':'',\n      'cn':'的出口'\n    },\n  }\n\n  if (window.lang_countries[layerCode.toLowerCase()] != null) {\n    $('#flowLayer .country').html(window.lang_countries[layerCode.toLowerCase()]);\n  } else {\n    $('#flowLayer .country').html(layerCode);\n  }\n  $('#flowLayer #countryPrefix').text(flowLabels.headlinePrefix[lang]);\n  $('#flowLayer #countrySuffix').text(flowLabels.headlineSuffix[lang]);\n  $('#flowLayer .helptext').hide();\n  $('#flowLayer #detailsTable').show();\n  $('#flowLayer #detailsTable thead .countries').text(flowLabels.tableHead1[lang]);\n  $('#flowLayer #detailsTable thead .values').text(flowLabels.tableHead2[lang]);\n  $('#flowLayer #detailsTable tbody').remove();\n  $('#flowLayer #detailsTable').append('<tbody>');\n  var legendData = getFlowsLegend(layerCode);\n  $.each(legendData['rank'], function (key, value) {\n    if (window.lang_countries[legendData['values'][value].toLowerCase()] != null) {\n      country = window.lang_countries[legendData['values'][value].toLowerCase()];\n    } else if (legendData['values'][value] == 'WLD') {\n      country = flowLabels.world[lang];\n    } else if (legendData['values'][value] == 'UNSPE') {\n      country = flowLabels.unspecified[lang];\n    } else if (legendData['values'][value] == 'XCD') {\n      country = flowLabels.asia[lang];\n    } else {\n      country = legendData['values'][value];\n    }\n    $('#flowLayer #detailsTable tbody').append('<tr><td>'+country+'</td><td  class=\"tableValues\">'+Math.round(value/1000000)+'</td>');\n  });\n  \n  function getFlowsLegend(country) {\n    var data = window.DataforFlow;\n    var idxCountry = data.keys[0].indexOf(country.toUpperCase());\n    var newData = {};\n    newData['rank'] = [];\n    newData['values'] = {};\n    var max = 0;\n    $.each(data.keys[1], function (key, value) {\n      var crData = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n      if (max < crData) {\n        max = crData;\n      }\n    });\n    $.each(data.keys[1], function (key, value) {\n      var crData1 = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n      if (crData1 / max > 0.01) {\n        newData['values'][crData1]=value;\n        newData['rank'].push(crData1);\n      }\n    });\n    newData['rank'].sort(function(a, b){return b-a});\n    return newData;\n  }\n}\n\nfunction addLines(flow, color, centros, mapdataviz) {\n  var stars = {};\n  $.each(flow.stars, function (country, value) {\n    if (centros[country.toUpperCase()] != undefined) {\n      stars[country] = {};\n      stars[country]['latlong'] = [parseFloat(centros[country.toUpperCase()].Lat), parseFloat(centros[country.toUpperCase()].Long)];\n      stars[country]['value'] = value\n    }\n  });\n  var center = [parseFloat(centros[flow.center.toUpperCase()].Lat), parseFloat(centros[flow.center.toUpperCase()].Long)];\n  $.each(stars, function (country, values) {\n    var lines = L.polyline([center, values.latlong], {\n      color: color,\n      weight: values.value,\n      fill: 'blue'\n    });\n    flowGroup.addLayer(lines);\n    //flowGroup.addLayer(L.polylineDecorator(lines, {\n    //  patterns: [{\n    //    offset: '100%',\n    //    repeat: 0,\n    //    symbol: L.Symbol.arrowHead({\n    //      pixelSize: values.value*3,\n    //      polygon: false,\n    //      pathOptions: {stroke: true, weight: values.value}\n    //    })\n    //  }]\n    //}));\n  });\n}\n\n/*\n function addRectangle(flow,centros,mapdataviz) {\n var stars = {};\n $.each(flow.stars, function (country,value) {\n stars[country] = {};\n stars[country]['latlong'] = [parseFloat(centros[country.toUpperCase()].Lat),parseFloat(centros[country.toUpperCase()].Long)];\n stars[country]['value'] = value\n });\n $.each(stars, function (country, values) {\n L.rectangle([[values.latlong[0],values.latlong[1]],[values.latlong[0]+values.value,values.latlong[1]+0.75]], {\n fillOpacity : 1,\n color: \"blue\",\n weight: 1\n }).addTo(mapdataviz);\n L.rectangle([[values.latlong[0],values.latlong[1]-0.75],[values.latlong[0]+1,values.latlong[1]]], {\n fillOpacity : 1,\n color: \"red\",\n weight: 1\n }).addTo(mapdataviz);\n });\n }\n */\n\n","\nfunction updateFlowData (indicator) {\n  $.ajax({\n    dataType: \"json\",\n    url: baseURL+\"/api-data?project=\"+project+\"&id=\"+indicator,\n    success: ajaxSuccess,\n    error: function (xhr, ajaxOptions, thrownError) {\n      if (xhr.status == '404') {\n        alert ('No data available.')};\n    }\n  });\n  \n  function ajaxSuccess(data) {\n    if (data != null) {\n      window.DataforFlow=data;\n    } else {\n      alert('No data available.');\n    }\n  }\n\n}\n\n","function mapTeaserText(country) {\n  // private\n\n  var euGroup = [ 'aut', 'bel', 'bgr', 'cyp', 'deu', 'dnk', 'esp', 'fin',\n                  'fra', 'gbr', 'grc', 'hrv', 'irl', 'ita', 'lux', 'lva',\n                  'ltu', 'mlt', 'nld', 'prt', 'swe', 'cze', 'est', 'hun',\n                  'pol', 'svk', 'svn', 'rou'];\n\n  var teaser = $('<div>');\n  var teaserTitle = $('<h3 class=\"tooltipTitle\">');\n  var teaserTable = $('<table class=\"tooltipTable\">');\n  teaser.append(teaserTitle);\n\n  var countryProfile = $('<div class=\"countryProfilLink\">')\n    .append($('<span id=\"countryProfileMap\">')\n              .attr('value', country)\n              .html(lang_labels.countryProfile));\n  if (typeof wizardConfig !== 'undefined' && wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes == 'withEU' && $.inArray(country.toString().toLowerCase(), euGroup) > -1) {\n    countryProfile.append('<span value=\"eu\" id=\"euProfileMap\">view EU profile</span>');\n  }\n  teaser.append(countryProfile);\n\n  var countryName = lang_countries[country.toString().toLowerCase()] || ISO3toFlags[country] || country;\n  teaserTitle.text(countryName);\n\n  var tableLineCanvas;\n  var tooltipData;\n  var dataValue;\n  var hasData = false;\n\n  for (var i = 0; i < ChartsWithData; i++) {\n    if (DataforMap[i] != null) {\n      tableLineCanvas = $('<tr>')\n        .append($('<td>')\n                  .attr('title', $('<div>').html(DataforMap[i]['definition']).text())\n                  .html(DataforMap[i]['title']));\n\n      tooltipData = $('<td class=\"tooltipData\">');\n      tableLineCanvas.append(tooltipData);\n\n      if (DataforMap[i]['values'][country] != undefined && DataforMap[i]['values'][country][1] != null) {\n        hasData = true;\n        dataValue = getHumanReadData(DataforMap[i]['values'][country][1], DataforMap[i]['options']['tooltipDecimals']) + '&nbsp;' + DataforMap[i]['options']['tooltipUnit'];\n        if (DataforMap[i]['values'][country][0] != DataforMap[i]['latestYear']) {\n          dataValue += '&nbsp;(' + DataforMap[i]['values'][country][0] + ')';\n        }\n        tooltipData.html(dataValue);\n      } else {\n        tooltipData.text('\\u2014'); // EM DASH\n      }\n      teaserTable.append(tableLineCanvas);\n    }\n  }\n\n  if (hasData || themeURL != 'ecb') {\n    teaserTitle.after(teaserTable);\n  }\n\n  // return first DOM element in jQuery object\n  return teaser[0];\n}\n","\n\nfunction mapTeaserTextMulti(country) {\n  //private\n\n  var euGroup = [ 'aut', 'bel', 'bgr', 'cyp', 'deu', 'dnk', 'esp', 'fin',\n                  'fra', 'gbr', 'grc', 'hrv', 'irl', 'ita', 'lux', 'lva',\n                  'ltu', 'mlt', 'nld', 'prt', 'swe', 'cze', 'est', 'hun',\n                  'pol', 'svk', 'svn', 'rou'];\n\n  var teaserTitleStart = '<h3 class=\"tooltipTitle\">';\n  var teaserTitleEnd = '</h3>';\n  var teaserTableStart = '<table class=\"tooltipTable\">';\n  var teaserTableLineCenter = '</td><td  class=\"tooltipData\">';\n  var teaserTableEnd = '</td></tr></table>';\n\n  if (typeof wizardConfig !== 'undefined' && wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes == 'withEU' && $.inArray(country.toString().toLowerCase(), euGroup) > -1) {\n    var countryProfile = \"<div class='countryProfilLink'>\"+\n            \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n            \"\"+\n            \"<span value='eu' id='euProfileMap' >view EU profile</span>\"+\n            \"</div>\";\n  } else {\n    var countryProfile = \"<div class='countryProfilLink'>\"+\n            \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n            \"</div>\";\n  }\n\n\n  if (lang_countries[country.toString().toLowerCase()] != null) {\n    var countryName = lang_countries[country.toString().toLowerCase()]+' - '+DataforMap[mapLayerIndex]['title'];\n  } else {\n    var countryName = country+' - '+DataforMap[mapLayerIndex]['title'];\n  }\n\n  var tableLines;\n  var tableLine = [];\n\n  tableLine[0] =  \"<tr>\"+\n                    \"<td>\"+DataforMap[mapLayerIndex]['options']['tooltipUnit']+\"</td>\"+\n                    \"<td class='tooltipData'>\"+getHumanReadData(DataforMap[mapLayerIndex]['values'][country][1])+\"</td>\"+\n                  \"</tr>\";\n\n  if (DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]) {\n    tableLine[1] =  \"<tr>\"+\n                      \"<td>\"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['options']['tooltipUnit']+\"</td>\"+\n                      \"<td class='tooltipData'>\"+getHumanReadData(DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['values'][country][1])+\"</td>\"+\n                    \"</tr>\";\n  } else {\n    tableLine[1] = \"<tr><td></td><td></td></tr>\";\n  }\n\n  tableLines = tableLine[0]+tableLine[1];\n\n  return '' +\n    teaserTitleStart +\n    countryName +\n    teaserTitleEnd +\n    teaserTableStart +\n    tableLines +\n    teaserTableEnd +\n    countryProfile + '';\n}\n\n\n","\nfunction mapTeaserExportRestrictions(country) {\n\n//global vars\n//  lang_labels\n//  DataforMap\n//  lang\n\n  var labels2 = {};\n\n  labels2['en'] = {\n\t\t1:'export prohibition',\n\t\t2:'export quota',\n\t\t3:'export tax',\n\t\t4:'non-automatic licencing',\n\t\t5:'other measures',\n\t\t6:'no restrictions',\n    undefined:'not reseached'\n\t};\n\n  labels2['cn'] = {\n    1:'禁止出口',\n    2:'出口配额',\n    3:'出口税',\n    4:'非自动许可',\n    5:'其他措施',\n    6:'无限制',\n    undefined:'没有研究'\n  };\n\n  var teaserTitleStart = '<h3 class=\"tooltipTitle\">';\n  var teaserTitleEnd = '</h3>';\n  var teaserTableStart = '<table class=\"tooltipTable\">';\n  var teaserTableLineCenter = '</td><td  class=\"tooltipData\">';\n  var teaserTableEnd = '</td></tr></table>';\n\n  var countryProfile = \"<div class='countryProfilLink'>\"+\n          \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n          \"</div>\";\n\n  var countryName = lang_countries[country.toLowerCase()]+' - '+DataforMap[mapLayerIndex]['title'];\n\n  var tableLines;\n  var tableLine = [];\n\n  if (DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]) {\n    tableLine[0] =  \"<tr>\"+\n                      \"<td>\"+DataforMap[mapLayerIndex]['options']['tooltipUnit']+\":</td>\"+\n                      \"<td class='tooltipData'>\"+getHumanReadData(DataforMap[mapLayerIndex]['values'][country][1])+\" \"+DataforMap[mapLayerIndex]['unit']+\"</td>\"+\n                    \"</tr>\";\n    tableLine[1] =  \"<tr>\"+\n                      \"<td>\"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['options']['tooltipUnit']+\":</td>\"+\n                      \"<td class='tooltipData'>\"+labels2[lang][DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['values'][country][1]]+\"</td>\"+\n                    \"</tr>\";\n  } else {\n    tableLine[0] =  \"<tr>\"+\n                      \"<td>\"+DataforMap[mapLayerIndex]['options']['tooltipUnit']+\":</td>\"+\n                      \"<td class='tooltipData'>\"+labels2[lang][DataforMap[mapLayerIndex]['values'][country][1]]+\"</td>\"+\n                    \"</tr>\";\n    tableLine[1] = \"<tr><td></td><td></td></tr>\";\n  }\n\n  tableLines = tableLine[0]+tableLine[1];\n\n  return '' +\n    teaserTitleStart +\n    countryName +\n    teaserTitleEnd +\n    teaserTableStart +\n    tableLines +\n    teaserTableEnd +\n    countryProfile + '';\n}\n\n\n","\nfunction mapTeaserExportRestrictionsMain(country) {\n\n  var labels2 = {};\n\n  labels2['en'] = {\n\t\t1:'export prohibition',\n\t\t2:'export quota',\n\t\t3:'export tax',\n\t\t4:'non-automatic licencing',\n\t\t5:'other measures',\n\t\t6:'no restrictions',\n    undefined:'not reseached'\n\t};\n\n  labels2['cn'] = {\n    1:'禁止出口',\n    2:'出口配额',\n    3:'出口税',\n    4:'非自动许可',\n    5:'其他措施',\n    6:'无限制',\n    undefined:'没有研究'\n  };\n\n  var teaserTitleStart = '<h3 class=\"tooltipTitle\">';\n  var teaserTitleEnd = '</h3>';\n  var teaserTableStart = '<table class=\"tooltipTable\">';\n  var teaserTableLineCenter = '</td><td  class=\"tooltipData\">';\n  var teaserTableEnd = '</td></tr></table>';\n\n  var countryProfile = \"<div class='countryProfilLink'>\"+\n          \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n          \"</div>\";\n\n  var countryName = lang_countries[country.toLowerCase()];\n\n  var tableLineCanvas = [];\n  var tooltipData = [];\n  var tableLines;\n\n  tableLineCanvas[0] = \"<tr><td title='\" + DataforMap[0]['definition'] + \"'>\" + DataforMap[0]['title'] + \":</td><td class='tooltipData'>\";\n  tooltipData[0] = labels2[lang][DataforMap[0]['values'][country][1]];\n  tableLines = tableLineCanvas[0]+tooltipData[0];\n\n  return '' +\n    teaserTitleStart +\n    countryName +\n    teaserTitleEnd +\n    teaserTableStart +\n    tableLines +\n    teaserTableEnd +\n    countryProfile + '';\n}\n\n\n","function mapTeaserIfiCountryData(country, links) {\n  // private\n\n  var teaser = $('<div>');\n  var teaserTitle = $('<h3 class=\"tooltipTitle\">');\n  var teaserTable = $('<table class=\"tooltipTable\">');\n  teaser.append(teaserTitle);\n\n  var link = links[country.toString().toLowerCase()];\n  if (link != null) {\n    var countryProfile = $('<div style=\"text-align: center;\">')\n      .append($('<a target=\"_blank\">')\n                .attr('href', link)\n                .text(lang_labels.countryProfile));\n    teaser.append(countryProfile);\n  }\n\n  var countryName = lang_countries[country.toString().toLowerCase()] || country;\n  teaserTitle.text(countryName);\n\n  var tableLineCanvas;\n  var tooltipData;\n  var dataValue;\n  var hasData = false;\n  var unit;\n\n  for (var i = 0; i < ChartsWithData; i++) {\n    if (DataforMap[i] != null) {\n      tableLineCanvas = $('<tr>')\n        .append($('<td>')\n                  .attr('title', $('<div>').html(DataforMap[i]['definition']).text())\n                  .html(DataforMap[i]['title']));\n\n      tooltipData = $('<td class=\"tooltipData\">');\n      tableLineCanvas.append(tooltipData);\n\n      if (DataforMap[i]['values'][country] != undefined && DataforMap[i]['values'][country][1] != null) {\n        hasData = true;\n        dataValue = getHumanReadData(DataforMap[i]['values'][country][1], DataforMap[i]['options']['tooltipDecimals']);\n        unit = DataforMap[i]['options']['tooltipUnit'] || '';\n        if (unit !== '') {\n          dataValue += '&nbsp;' + unit;\n        }\n        if (DataforMap[i]['values'][country][0] != DataforMap[i]['latestYear']) {\n          dataValue += '&nbsp;(' + DataforMap[i]['values'][country][0] + ')';\n        }\n        tooltipData.html(dataValue);\n      } else {\n        tooltipData.text('\\u2014'); // EM DASH\n      }\n      teaserTable.append(tableLineCanvas);\n    }\n  }\n\n  teaserTitle.after(teaserTable);\n\n  // return first DOM element in jQuery object\n  return teaser[0];\n}\n","\nvar topLarge = 80;\nvar heightSmall = 85\n\nif ($(window).width() > 475){\n  topLarge = 92;\n  heightSmall = 85\n} if ($(window).width() > 650){\n  topLarge = 100;\n  heightSmall = 70\n}\n\nfunction largeContainer() {\n  $(\"#topContainer\").css({\"height\": \"auto\"});\n  $(\"#topContainer\").css({'top': topLarge+\"px\"});\n  $(\"#itemContainer\").fadeIn();\n  $(\"#item1Container\").fadeOut();\n  $(\"#item2Container\").fadeOut();\n  $(\"#mapLegendContainer\").fadeOut();\n  $(\".map-legend\").css({\"padding-top\": \"30px\"});\n  mapdataviz.closePopup();\n}\n\nfunction largeContainerPDF() {\n  $(\"#itemContainer\").fadeIn();\n}\n\n\nfunction smallContainer() {\n  $(\"#topContainer\").animate({height: heightSmall+\"px\"});\n  $(\"#topContainer\").css({\"top\": \"auto\"});\n  $(\"#itemContainer\").fadeOut();\n  $(\"#item1Container\").fadeIn();\n  $(\"#item2Container\").fadeOut();\n  $(\"#mapLegendContainer\").fadeIn();\n  $(\".map-legend\").css({\"padding-top\": \"0px\"});\n}\n\nfunction startContainer() {\n  $(\"#topContainer\").css({\"height\": \"auto\"});\n  $(\"#topContainer\").css({'top': topLarge+\"px\"});\n  $(\"#itemContainer\").fadeOut();\n  $(\"#item1Container\").fadeOut();\n  $(\"#item2Container\").fadeIn();\n  $(\"#mapLegendContainer\").fadeOut();\n  $(\".map-legend\").css({\"padding-top\": \"30px\"});\n  mapdataviz.closePopup();\n}\n\n\n","\n$(document).ready(function() {\n\n  var tab = wizardConfig.project.tabs[page];\n  var subTabsType = wizardConfig.tabs[tab].subTabsType;\n  if (wizardConfig.tabs[tab].teaserLayer && window.secondVisit == false) {\n    startContainer();\n  } else {\n    smallContainer();\n  }\n  $(\".countryProfilLink\").show();\n  $(\".teaserTitle2\").text(' - '+lang_labels.TabCountryNote);\n\n  $.each( subTabs, function(key,value) {\n    $('#panelNav').append('<a id=\"subTabButton'+key+'\" href=\"#subTab'+key+'\">')\n    $('#itemContainer').append('<div id=\"subTab'+key+'\" class=\"tab\">')\n    $('#subTabButton'+key+'').text(value.title[lang])\n  });\n\n  $(\"#subTabButton0\").addClass('active');\n  $(\"#subTab0\").addClass('active');\n\n//on select from map tooltip in map mode\n  $(document).on('click', '#countryProfileMap', function(){\n    if (subTabsType == 'simple') {\n      updateCountryProfileSimple($(this).attr('value').toLowerCase());\n    } else {\n      updateCountryProfile($(this).attr('value').toLowerCase());\n    }\n    mapdataviz.closePopup();\n  });\n\n//on select from map tooltip in map mode\n  $(document).on('click', '#euProfileMap', function(){\n    if (subTabsType == 'simple') {\n      updateCountryProfileSimple($(this).attr('value').toLowerCase());\n    } else {\n      updateCountryProfile($(this).attr('value').toLowerCase());\n    }\n    mapdataviz.closePopup();\n  });\n\n//close large layer and show small layer\n  $('.closeLayer').click(smallContainer);\n\n// switch between subnav tabs\n  $('#panelNav').on('click', 'a', function(){\n    $(this).addClass('active').siblings('a.active').removeClass('active');\n    $($(this).attr('href')).addClass('active').siblings('.tab.active').removeClass('active');\n    return false;\n  });\n\n// add PDF option (to be developed)\n//  if (pdfWizard != null) {\n//    $('#panelNav').append('<a id=\"subTabButtonPDF\" href=\"#subTabPDF\">')\n//    $('#itemContainer').append('<div id=\"subTabPDF\" class=\"tab\">')\n//    $('#subTabPDF').append(\n//        '<h4>Generate a PDF with your selection</h4>'+\n//\t\t'<p class=\"buttons\"><button id=\"pdfButton\">generate PDF</button>'\n//      )\n//    $('#subTabButtonPDF').text('Create PDF')\n//\n//    $('#pdfButton').click(function(){\n//    generatePDF(pdfWizard);\n//    });\n//  }\n\n});\n\n","\nfunction updateCountryProfile(profileCountry,mode) {\n// update country profile with tabs\n// tabs include different text sections\n// charts can be integrated as additional text sections\n\n  $(\".noteCountryName\").text(lang_countries_titles[profileCountry.toLowerCase()]|| '');\n  $.each( window.subTabs, function(key,value) {\n    $(\"#subTab\"+key).html('');\n  });\n\n  $.ajax({\n    dataType: \"json\",\n    url: baseURL+\"/api-notes?project=\"+project+\"&lg=\"+lang+\"&cr=\"+profileCountry.toLowerCase(),\n    success: ajaxSuccess,\n    error: function (xhr, ajaxOptions, thrownError) {\n      if (xhr.status == '404') {\n        alert ('Country profile not available.')};\n    }\n  });\n\n  function ajaxSuccess(data) {\n    if (data != null) {\n      $.each( window.subTabs, function(subTab,subTabVal) {\n        $.each(subTabVal.content[window.lang], function(section,val) {\n          $(\"#subTab\"+subTab).append('<div id=\"sec'+subTab+'-'+section+'\" class=\"section\"><div class=\"headingElement\"><h4><span class=\"subHeadingText\">');\n          $('#sec'+subTab+'-'+section+' .headingElement h4 .subHeadingText').html(val);\n          var subSection = 0;\n          if (data[val] != undefined) {\n            $.each( data[val], function(key,content) {\n              if (key == 'h1 text') {\n                $.each(content,function(element,parts){\n                  $('#sec'+subTab+'-'+section).append('<p id=\"textSec'+subTab+'-'+section+'-'+element+'\" class=\"textElement\">');\n                  $('#textSec'+subTab+'-'+section+'-'+element).html(parts);\n                });\n              }\n              if (subTabVal.charts != undefined){\n                addChartSections (subTabVal,subTab,section,profileCountry,val,'chartSectionMain');\n              }\n\n              if (key != 'h1 text') {\n                $('#sec'+subTab+'-'+section).append('<h5 id=\"headerSec'+subTab+'-'+section+'-'+subSection+'\" class=\"subSection\"><table><tr><td>');\n                $('#headerSec'+subTab+'-'+section+'-'+subSection+' table tr td').html(key);\n                var subSubSection = 0;\n                $.each( content, function(subkey,subcontent) {\n                  if (subkey == 'h2 text') {\n                    $.each(subcontent, function(key,content) {\n                      $('#sec'+subTab+'-'+section).append('<p id=\"textSec'+subTab+'-'+section+'-'+subSection+'-'+key+'\" class=\"textElement\">');\n                      if (subTabVal.display != null && subTabVal.display == 'expanded') {\n                        $('#textSec'+subTab+'-'+section+'-'+subSection+'-'+key).html(content);\n                      } else {\n                        $('#textSec'+subTab+'-'+section+'-'+subSection+'-'+key).html(content).hide();\n                      }\n                    });\n                    if (subTabVal.charts != undefined) {\n                      if (subTabVal.display != null && subTabVal.display == 'expanded') {\n                        addChartSections (subTabVal,subTab,section,profileCountry,key,'chartSectionMain');\n                      } else {\n                        addChartSections (subTabVal,subTab,section,profileCountry,key,'chartSection');\n                      }\n                    }\n                  } else {\n                    $.each(subcontent, function(key,content) {\n                      $('#sec'+subTab+'-'+section).append('<h6 id=\"headerSec'+subTab+'-'+section+'-'+subSection+'-'+subSubSection+'\" class=\"subSection\">');\n                      $('#headerSec'+subTab+'-'+section+'-'+subSection+'-'+subSubSection).text(subkey).hide();\n                      $('#sec'+subTab+'-'+section).append('<p id=\"textSec'+subTab+'-'+section+'-'+subSection+'-'+subSubSection+'-'+key+'\" class=\"textElement\">');\n                      $('#textSec'+subTab+'-'+section+'-'+subSection+'-'+subSubSection+'-'+key).html(content).hide();\n                    });\n                  }\n                  subSubSection++;\n                });\n              }\n              subSection++;\n            });\n        }\n        });\n        if (subTabVal.display == null) {\n          $(\"#subTab\"+subTab+\" .section h5 table tr\").append(expand);\n        }\n      });\n    } else {\n      alert('Country profile is not available.');\n    }\n    $(\".tab a\").attr('target','_blank');\n    $(\".expandCollaps\").append(expandElements);\n    $(\"h5\").click(function() {\n        var parent = this;\n        $(parent).nextUntil(\"h5\",\"p\").slideToggle(500, function(){} );\n        $(parent).nextUntil(\"h5\",\"h6\").slideToggle(500, function(){} );\n        $(parent).nextUntil(\"h5\",\".simpleTable\").toggle();\n        $(parent).nextUntil(\"h5\",\".chartSection\").toggle();\n        $(parent).find(\".expand\").toggle();\n        $(parent).find(\".collaps\").toggle();\n    });\n    if (mode == 'pdf') {\n      largeContainerPDF();\n    } else {\n      largeContainer();\n    }\n  };\n\n  var expand =  '<td class=\"expandCollaps\">'\n  var expandElements = '<span class=\"controls expand expandText\">[expand&nbsp;section]</span><span class=\"controls collaps expandText\">[collapse&nbsp;section]</span>'\n\n  function addChartSections (subTabVal,subTab,section,profileCountry,sectionName,sectionLevel) {\n    $.each(subTabVal.charts, function(chart,config) {\n      var chartHeader = '<div class=\"'+sectionLevel+'\"><div class=\"chartTitle\">'+subTabVal.ConfigSubCharts[chart].title+'</div>'+\n                        '<div class=\"chartSubTitle\">'+subTabVal.ConfigSubCharts[chart].definition+\n                        ', '+subTabVal.ConfigSubCharts[chart].options.tooltipUnit+'</div>'+\n                        '<div style=\"height:200px\" class=\"chartContainer\" id=\"container'+chart+'-'+subTab+'-'+section+'\">';\n      if (config.section[window.lang] == sectionName) {\n        if (config.chartType == 'simpleTable') {\n          $('#sec'+subTab+'-'+section).append(addSimpleTable(subTabVal.ConfigSubCharts[chart],profileCountry,config.legendType));\n        }\n        if (config.chartType == 'lineChart') {\n          values = filterLocation(subTabVal.ConfigSubCharts[chart],[profileCountry.toLowerCase()])\n          if (values.data.data[0] != undefined) {\n            $('#sec'+subTab+'-'+section).append(chartHeader);\n            addLineChart(values,'container'+chart+'-'+subTab+'-'+section);\n          }\n        }\n        if (config.chartType == 'columnChart') {\n          $('#sec'+subTab+'-'+section).append(chartHeader);\n          addColumnChart(filterYear(subTabVal.ConfigSubCharts[chart],[\"2012\"]),'container'+chart+'-'+subTab+'-'+section);\n          highlightDataPoint(profileCountry.toLowerCase(),'blue',0,'#container'+chart+'-'+subTab+'-'+section);\n        }\n      }\n    });\n  }\n\n}\n\n\n","\nfunction updateCountryProfileSimple(profileCountry) {\n// update country profile with tabs\n// tabs include charts or tables only\n\n  $(\".noteCountryName\").text(lang_countries_titles[profileCountry.toLowerCase()]|| '');\n  $.each( window.subTabs, function(key,value) {\n    $(\"#subTab\"+key).html('');\n  });\n\n  addCharts();\n\n  function addCharts() {\n    $.each( window.subTabs, function(subTab,subTabVal) {\n      $.each(subTabVal.content, function(section,val) {\n        $(\"#subTab\"+subTab).append('<div id=\"sec'+subTab+'-'+section+'\" class=\"section\"><div class=\"headingElement\"><h4><span class=\"subHeadingText\">');\n//        $('#sec'+subTab+'-'+section+' .headingElement h4 .subHeadingText').html(val);\n        if (subTabVal.charts != undefined){\n          addChartSections (subTabVal,subTab,section,profileCountry,val,'chartSectionMain');\n        }\n      });\n    });\n    largeContainer();\n  };\n\n  function addChartSections (subTabVal,subTab,section,profileCountry,sectionName,sectionLevel) {\n\n    var complexCharts=[];\n    var complexTable;\n\n    $.each(subTabVal.charts, function(chart,config) {\n      var chartHeader = '<div class=\"'+sectionLevel+'\"><div class=\"chartTitle\">'+subTabVal.ConfigSubCharts[chart].title+'</div>'+\n                        '<div class=\"chartSubTitle\">'+subTabVal.ConfigSubCharts[chart].definition+\n                        ', '+subTabVal.ConfigSubCharts[chart].options.tooltipUnit+'</div>'+\n                        '<div style=\"height:1000px\" class=\"chartContainer\" id=\"container'+chart+'-'+subTab+'-'+section+'\">';\n      if (config.chartType == 'simpleTable') {\n        $('#sec'+subTab+'-'+section).append(addSimpleTable(subTabVal.ConfigSubCharts[chart],profileCountry,config.legendType));\n      }\n      if (config.chartType == 'complexTable') {\n        complexCharts.push(subTabVal.ConfigSubCharts[chart]);\n        complexTable=true;\n      }\n      if (config.chartType == 'sortedBarChart') {\n        values = filterLocation(subTabVal.ConfigSubCharts[chart],[profileCountry.toLowerCase()]);\n        values.data = flipData(values.data);\n        if (values.data.data[0] != undefined) {\n          $('#sec'+subTab+'-'+section).append(chartHeader);\n          addBarChart(values,'container'+chart+'-'+subTab+'-'+section);\n        }\n      }\n    });\n    if (complexTable == true) {\n\n      var complexTableLabel = {\n        'en' : 'Click on column headers to change table sorting. Pass cursor over commodity names and export restriction symbols for detailed definitions and explanations.',\n        'cn' : '点击列标题改变表格排序。在商品名称和出口限制的符号上点击光标查询详细定义和解释。',\n      }\n\n      $('#sec'+subTab+'-'+section).append('<div class=\"helpTextComplexTable\">'+complexTableLabel[lang]+'</div>');\n      $('#sec'+subTab+'-'+section).append(addComplexTable(complexCharts,profileCountry));\n\n      $.tablesorter.formatInt = function(s) {\n        var i = parseInt(s);\n        return (isNaN(i)) ? null : i;\n      };\n      $.tablesorter.formatFloat = function(s) {\n        var i = parseFloat(s);\n        return (isNaN(i)) ? null : i;\n      };\n\n      $(\".complexTable\").tablesorter({\n        sortList: [[0,0]],\n        headers:{\n          1:{sorter:false}\n        },\n        textExtraction: function (node) {\n          var txt = $(node).text();\n          txt = txt.replace('--', ''); // EM DASH\n          txt = txt.replace('*', '');\n          return txt;\n        }\n      });\n\n    }\n  }\n\n}\n\n\n","\n\n//returns a table with title for a map wizard layer\n\n//Dependencies\n//dataHandler/getTableData.js\n\nfunction addSimpleTable (values,country,labels) {\n\tvar tableLabels = {};\n\ttableLabels['fishery-innovation'] = {\n\t\t0:'<span style=\"color:red\">No</span>',\n\t\t1:'<span style=\"color:green\">Yes</span>',\n\t\t2:'<span style=\"color:orange\">at EU level</span>',\n\t\t3:'<span style=\"color:green\">EU & national level</span>',\n\t};\n\ttableLabels['export-restrictions'] = {\n\t\t1:'<span style=\"color:#a80606\">Export prohibition</span>',\n\t\t2:'<span style=\"color:#e70a0d\">Export quota</span>',\n\t\t3:'<span style=\"color:#e78b20\">Export tax</span>',\n\t\t4:'<span style=\"color:#d3e729\">Non-automatic licencing</span>',\n\t\t5:'<span style=\"color:#ca29e7\">Other measures</span>',\n\t\t6:'<span style=\"color:#1ee723\">No restrictions</span>',\n\t};\n\tvar labels1 = {\n\t\t0:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" fill=\"red\" /></svg>',\n\t\t1:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" fill=\"green\" /></svg>',\n\t};\n\tif (labels) {\n\t\tvar selectedLabels = tableLabels[labels];\n\t}\n\n\tvar title = '<h5 class=\"simpleTableTitle\"><table><tr><td>'+values.title+'</table></tr></td></h5>';\n\tvar head = '<table class=\"simpleTable\">';\n\tvar foot = '</table>';\n\tvar rows = '';\n\tvar data = getTableData (values.data)\n\t$.each(data, function(indicator,v){\n\t\tif (v[country.toUpperCase()] != null) {\n\t\t\tif (labels) {\n\t\t\t\trows = rows.concat('<tr><td>'+indicator+'</td><td>'+selectedLabels[v[country.toUpperCase()]]+'</td></tr>')\n\t\t\t} else {\n\t\t\t\trows = rows.concat('<tr><td>'+indicator+'</td><td>'+v[country.toUpperCase()]+values.options.tooltipUnit+'</td></tr>')\n\t\t\t}\n\t\t}\n\t});\n\treturn title+head+rows+foot\n}\n","\n\n//returns a table with title for a map wizard layer\n\n//Dependencies\n//dataHandler/getTableData.js\n\nfunction addComplexTable (values,country) {\n\n  var tab = window.wizardConfig.project.tabs[window.page];\n  var commodityLabels = window.wizardConfig.tabs[tab].labels;\n\n  var purposeCodes = window.wizardConfig.tabs[tab].purposeCodes[country.toUpperCase()];\n\n\tvar labels1 = {\n\t\t1:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle fill=\"#a80606\" cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" /></svg>',\n\t\t2:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle fill=\"#e70a0d\" cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" /></svg>',\n\t\t3:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle fill=\"#e78b20\" cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" /></svg>',\n\t\t4:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle fill=\"#d3e729\" cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" /></svg>',\n\t\t5:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle fill=\"#ca29e7\" cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" /></svg>',\n\t\t6:'<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"12\" height=\"12\"><circle fill=\"#1ee723\" cx=\"6\" cy=\"6\" r=\"6\" stroke=\"white\" stroke-width=\"0\" /></svg>',\n\t};\n\n  var labels2 = {};\n\n  labels2['en'] = {\n\t\t1:'Export prohibition',\n\t\t2:'Export quota',\n\t\t3:'Export tax',\n\t\t4:'Non-automatic licencing',\n\t\t5:'Other measures',\n\t\t6:'No restrictions',\n\t};\n\n  labels2['cn'] = {\n      1:'禁止出口',\n      2:'出口配额',\n      3:'出口税',\n      4:'非自动许可',\n      5:'其他措施',\n      6:'无限制',\n  };\n\n  var labels3 = {};\n\n  labels3['en'] = {\n    'A':\t'conservation of natural resources',\n    'B':\t'control of foreign exchange',\n    'C':\t'generate revenue',\n    'D':\t'health or environmental protection',\n    'E':\t'monitor or control export activity',\n    'F':\t'promote further processing/value added',\n    'G':\t'protect local downstream industry',\n    'H':\t'safeguard domestic supply',\n    'I':\t'other',\n    'J':\t'no purpose found/indicated',\n  };\n\n  labels3['cn'] = {\n      'A':\t'自然资源保护',\n      'B':\t'外汇管制',\n      'C':\t'创收',\n      'D':\t'健康或环境保护',\n      'E':\t'出口活动监管',\n      'F':\t'推动进一步处理/增值',\n      'G':\t'保护本地下游产业',\n      'H':\t'保障国内供应',\n      'I':\t'其他',\n      'J':\t'未发现/说明目的',\n  };\n\n  var labels4 = {\n    'en' : 'Commodity',\n    'cn' : '商品',\n  }\n\n  var labels5 = {\n    'en' : 'purpose',\n    'cn' : '目的',\n  }\n\n\n\tvar head = '<table class=\"complexTable tablesorter\"><thead><tr>'+\n              '<th><span>'+labels4[lang]+'<span></th>'+\n              '<th><span>'+values[0].title+'<span></th>'+\n              '<th><span>'+values[1].title+'<span></th>'+\n              '<th><span>'+values[2].title+'<span></th></tr></thead><tbody>';\n\tvar foot = '</tbody></table>';\n\tvar rows = '';\n  var data = [];\n\n  $.each(values, function(chart,content){\n    data[chart]=getTableData (content.data)\n  });\n\t$.each(data[0], function(indicator,v){\n    var comLabel = [];\n    if (commodityLabels.labels[indicator]) {\n      comLabel[0] = commodityLabels.labels[indicator].name;\n      comLabel[1] = commodityLabels.labels[indicator].definition;\n    } else {\n      comLabel[0] = indicator;\n      comLabel[1] = '--';\n    }\n\n    var restrictExplain = labels2[lang][v[country.toUpperCase()]];\n\n    var purpCode;\n    var purpCodeExplain = [];\n    if (purposeCodes[indicator]) {\n      var purpCodeList = purposeCodes[indicator].split(\"\");\n      purpCode = ' ('+purpCodeList+')';\n      $.each(purpCodeList, function(keys,codeValue){\n        purpCodeExplain.push(labels3[lang][codeValue]);\n      });\n      restrictExplain = restrictExplain+' - '+labels5[lang]+': '+purpCodeExplain;\n    } else {\n      purpCode = '';\n    }\n\n    var valRow1;\n    var valRow2;\n    var labelRow1;\n    var labelRow2;\n    if (data[1][indicator]&& data[1][indicator][country.toUpperCase()]) {\n      valRow1 = data[1][indicator][country.toUpperCase()];\n      labelRow1 = valRow1;\n    } else {\n      valRow1 = 0;\n      labelRow1 = '--';\n    }\n    if (data[2][indicator] && data[2][indicator][country.toUpperCase()] ) {\n      valRow2 = data[2][indicator][country.toUpperCase()];\n      labelRow2 = valRow2;\n    } else {\n      valRow2 = 0;\n      labelRow2 = '--';\n    }\n\n\t\tif (v[country.toUpperCase()] != null) {\n\t\t\t\trows = rows.concat('<tr><td title=\"'+comLabel[1]+'\">'+comLabel[0]+'</td>'+\n                            '<td title=\"'+restrictExplain+'\">'+labels1[v[country.toUpperCase()]]+purpCode+'</td>'+\n                            '<td>'+\n                              '<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"'+(valRow1+40)+'\" height=\"13\">'+\n                                 '<rect width=\"'+valRow1+'\" height=\"13\" fill=\"#a2b9f0\" y=\"0\" x=\"0\" stroke=\"white\" stroke-width=\"0\" />'+\n                                 '<text text-anchor=\"start\" x=\"'+(valRow1+4)+'\" y=\"11\"  font-family=\"Verdana\" font-size=\"11\" color=\"#636363\">'+labelRow1+'</text>'+\n                               '</svg>'+\n                            '</td>'+\n                            '<td>'+\n                              '<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"'+(valRow2+40)+'\" height=\"13\">'+\n                                 '<rect width=\"'+valRow2+'\" height=\"13\" fill=\"#a2b9f0\" y=\"0\" x=\"0\" stroke=\"white\" stroke-width=\"0\" />'+\n                                 '<text text-anchor=\"start\" x=\"'+(valRow2+4)+'\" y=\"11\"  font-family=\"Verdana\" font-size=\"11\" color=\"#636363\">'+labelRow2+'</text>'+\n                               '</svg>'+\n                            '</td>'+\n                           '</tr>'\n                           )\n\t\t}\n\t});\n\treturn head+rows+foot\n}\n","\n\n// class for simple chart\n\n//dependencies\n//highcharts.js\n\n// class for a collection of charts\nfunction ChartElement() {\n    var self = this;\n    var chart ;\n// configure, load and add chart to collection\n    self.loadChart = function(data, options) {\n        var newChart = new chartBasis(data, options);\n        newChart.loadData();\n        chart = newChart;\n    };\n    self.displayCharts = function(container) {\n        chart.displayChart(container)\n    };\n}\n\n\n\nfunction chartBasis(data, options) {\n    var self = this;\n    var loadedData = {};\n    var defaults = {\n        highcharts : {\n            chart : {\n                backgroundColor:'transparent'\n            },\n            plotOptions: {\n                series: {\n                    marker: {\n                        enabled: false,\n                        states: { hover: { enabled: true } }\n                    },\n                    pointPadding: 0,\n                    borderWidth: 0,\n                    connectNulls: true,\n                }\n            },\n            exporting: { enabled: false },\n            legend: { enabled: false },\n            credits: { enabled: false },\n            title : {text: null},\n            xAxis:{\n                labels: {\n                    step: 1,\n                    style : {fontSize: '1em'}\n                    },\n            },\n            yAxis : {\n                title: {text: null },\n            },\n        },\n        CYCoptions : {\n            typeOfFirstSeries: null,\n        }\n    };\n// custom CYC options\n    options = $.extend(true, defaults, options);\n\n    self.loadData = function() {\n        var Data=[];\n        var categories = data.keys[1];\n        $.each(data.keys[0], function(index, name) {\n            var dataPoints =  data.data[index].map(function(y, i) {\n                if (y != null) {\n                    return {y: parseFloat(y.toFixed(options.CYCoptions.decimals)), id: categories[i], name: categories[i]};\n                } else {\n                    return {y: null, id: categories[i]};\n                }\n\n            });\n            Data.push({name: name, data: dataPoints});\n        });\n        if (options.CYCoptions.typeOfFirstSeries != null) {\n            Data[0].type = options.CYCoptions.typeOfFirstSeries;\n        }\n\n        loadedData = {cats: categories, series: Data};\n    };\n\n    self.displayChart = function(container) {\n        var data = loadedData;\n        if (data == null) return false;\n        var seriesOptions = {\n            chart:{ renderTo:container},\n            xAxis:{categories:data.cats},\n            series:data.series\n        };\n        options.highcharts = $.extend(true, options.highcharts, seriesOptions);\n        new Highcharts.Chart(options.highcharts);\n        return true;\n    };\n}\n\n\n","\n\nfunction labelFormat (translatedLables) {\n    return function () {\n//        add flags with ISO codes as short form for countries\n      if (this.value.toUpperCase() in window.ISO3toFlags) {\n        var flag = '<img  style=\"margin-bottom:4px\" height=18px src=\"'+baseURL+'/flags.png?cr='+this.value.toUpperCase()+'\">'\n        return     '<span style=\"margin-right:5px\" >'+translatedLables[this.value.toLowerCase()]+'</span>'+flag;\n      } else {\n        if (translatedLables[this.value.toLowerCase()] != undefined) {\n            return     '<span style=\"margin-right:5px\" >'+translatedLables[this.value.toLowerCase()]+'</span>';\n        } else {\n            return     '<span style=\"margin-right:5px\" >'+this.value.toLowerCase()+'</span>';\n        }\n      }\n    }\n}\n\n\nfunction tooltipFormat (values,translatedLables) {\n    return function () {\n        if (translatedLables[this.x.toLowerCase()] != undefined) {\n            var s = '<b>' + translatedLables[this.x.toLowerCase()] + '</b>';\n        } else {\n            var s = '<b>' + this.x + '</b>';\n        }\n        $.each(this.points, function () {\n            s += '<br/>' + this.series.name + ': ' +\n            this.y+' '+values.options.tooltipUnit;\n        });\n        return s;\n    }\n}\n\n//config functions for simple chart templates\n\n//dependencies\n//simpleChartsCore.js\n\n\nfunction addLineChart(values,container) {\n  Highcharts.setOptions({lang: { numericSymbols: null}});\n  if (values.data.data[0] != undefined) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n  }\n    function loadAndDisplayData() {\n    sbars.loadChart(values.data,{\n      highcharts :{\n        chart: {\n          type: 'line',\n          //marginBottom: 20\n        },\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 10,\n        },\n        plotOptions: {\n          series: {\n          markers: {\n            enabled: false,\n            states: { hover: { enabled: true } }\n          },\n            lineWidth: 2,\n          },\n        },\n        yAxis : {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        xAxis : {\n          reversed: true,\n          tickmarkPlacement: 'on',\n          labels: {\n                    style : {\"font-size\":\"11px\"},\n                    step: null,\n                  },\n        },\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n        colors: [ \"#de3a07\", \"#408000\", \"#dca2bf\", \"#fdd14e\", \"#730000\", \"#ffa640\", \"#234010\", \"#6cc3d9\", \"#4400ff\", \"#f200a2\", \"#750039\", \"#33260d\", \"#00e61f\", \"#0099e6\", \"#1f0073\", \"#962c0b\", \"#734939\", \"#735c00\", \"#00f2a2\", \"#004996\"],\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\nfunction addLineStackedBarChart(values,container) {\n  if (values.data.data[0] != undefined) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n  }\n    function loadAndDisplayData() {\n    sbars.loadChart(values.data,{\n      highcharts :{\n        chart: {\n          type: 'column',\n          //marginBottom: 20\n        },\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n          area:   {stacking: 'normal'},\n          bar:   {stacking: 'normal'},\n          column:   {stacking: 'normal'},\n          series: {\n            markers: {\n              enabled: false,\n              states: { hover: { enabled: true } }\n            },\n            lineWidth: 2,\n          },\n        },\n        yAxis : {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        xAxis : {\n          tickmarkPlacement: 'on',\n          labels: {\n                    style : {\"font-size\":\"11px\"},\n                    step: null,\n                  },\n        },\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n//      colors: ['#bbbbbb','#232323'],\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n        typeOfFirstSeries: values.options.typeOfFirstSeries || 'line',\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\nfunction addStackedAreaChart(values,container) {\n  if (values.data.data[0] != undefined) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n  }\n    function loadAndDisplayData() {\n    sbars.loadChart(values.data,{\n      highcharts :{\n        chart: {\n          type: 'area',\n          //marginBottom: 20\n        },\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n          area:   {stacking: 'normal'},\n          series: {\n            markers: {\n              enabled: false,\n              states: { hover: { enabled: true } }\n            },\n            lineWidth: 2,\n          },\n        },\n        yAxis : {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        xAxis : {\n          tickmarkPlacement: 'on',\n          labels: {\n                    style : {\"font-size\":\"11px\"},\n                    step: null,\n                  },\n        },\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n//      colors: ['#bbbbbb','#232323'],\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\nfunction addBarChart(values,container) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    values.data = sortDimension0(values.data,0,desc=true);\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        chart: {\n          type: 'bar',\n          marginBottom: 10\n        },\n//        legend: { enabled: false },\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n          series: {\n            dataLabels: {\n              enabled: true,\n              overflow: 'none',\n              crop: false,\n              allowOverlap: true,\n            },\n          },\n        },\n        yAxis: {\n          labels: {enabled: false},\n          gridLineWidth: 0,\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        //xAxis: {\n        //  labels: {useHTML: true}\n        //},\n//        colors: ['#88b60f','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\n\nfunction addBarChartFlag(values,container,translatedLabels) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    values.data = sortDimension0(values.data,0,desc=true);\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        chart: {\n          type: 'bar',\n          marginBottom: 10,\n          marginLeft: 150\n        },\n//        legend: { enabled: false },\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n          series: {\n            dataLabels: {\n              enabled: true,\n              overflow: 'none',\n              crop: false,\n              allowOverlap: true,\n            },\n          },\n        },\n        yAxis: {\n          labels: {enabled: false},\n          gridLineWidth: 0,\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        xAxis: {\n          labels: {\n            useHTML: true,\n            formatter: labelFormat(translatedLabels)\n          }\n        },\n//        colors: ['#88b60f','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          formatter: tooltipFormat(values,translatedLabels)\n        },\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\n\nfunction addColumnChart(values,container) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    values.data = sortDimension0(values.data,0,desc=true);\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        chart: { type: 'column'},\n//        legend: { enabled: false },\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n          series: {\n            dataLabels: {\n              enabled: false,\n              overflow: 'none',\n              crop: false,\n              allowOverlap: true,\n            },\n          },\n        },\n        yAxis: {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        colors: ['#88b60f','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\n\nfunction addBarsDiamondsChart(values,container) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    values.data = sortDimension0(values.data,0,desc=true);\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        chart: { type: 'line',marginBottom: 20},\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n          series: {\n            marker: {\n              enabled: true,\n            },\n          lineWidth: 0,\n          states: { hover: {\n                  lineWidth: 0,\n                  lineWidthPlus: 0,\n                }\n          }\n          },\n        },\n        yAxis: {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n//        colors: ['#bbbbbb','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n      },\n      CYCoptions : {\n        typeOfFirstSeries: 'bar',\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\n\n\nfunction addStackedColumnChart(values,container) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        chart: {\n          type: 'column',\n//          marginBottom: 20\n        },\n        legend: {\n          enabled: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n                    bar:   {stacking: 'normal'},\n                    column:   {stacking: 'normal'},\n        },\n        yAxis: {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        xAxis: {\n                labels: {\n                    step: null,\n                    },\n        },\n//        colors: ['#bbbbbb','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\nfunction addStackedBarChart(values,container) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    values.data = sortDimension0sum(values.data,desc=true);\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        chart: {\n          type: 'bar',\n          marginBottom: 20\n        },\n        legend: {\n          enabled: true,\n          reversed: true,\n          verticalAlign: 'top',\n          padding: 0,\n          margin: 5,\n        },\n        plotOptions: {\n                    bar:   {stacking: 'normal'},\n                    column:   {stacking: 'normal'},\n        },\n        yAxis: {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        xAxis: {\n//          opposite: true,\n//          labels : {enabled: false}\n        },\n//        colors: ['#bbbbbb','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\nfunction addPyramidRight(values,container) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        title: {text:'Men'},\n        chart: {\n          type: 'bar',\n//          marginBottom: 10\n        },\n        legend: {\n          enabled: true,\n          reversed: true,\n          verticalAlign: 'bottom',\n          padding: 5,\n          margin: 5,\n        },\n        plotOptions: {\n          bar:   {stacking: 'normal'},\n          column:   {stacking: 'normal'},\n          series: {\n              animation: false\n          }\n        },\n        yAxis: {\n          min: values.options.minimum,\n          max: values.options.maximum,\n        },\n        xAxis: {\n          opposite: true,\n//          labels : {enabled: false}\n        },\n//        colors: ['#bbbbbb','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n\n\nfunction addPyramidLeft(values,container) {\n    var sbars = new ChartElement();\n    loadAndDisplayData();\n    function loadAndDisplayData() {\n    sbars.loadChart(flipData(values.data),{\n      highcharts :{\n        title: {text:'Women'},\n        chart: {\n          type: 'bar',\n        },\n        legend: {\n          enabled: true,\n          reversed: true,\n          verticalAlign: 'bottom',\n          padding: 5,\n          margin: 5,\n        },\n        plotOptions: {\n          bar:   {stacking: 'normal'},\n          column:   {stacking: 'normal'},\n          series: {\n              animation: false\n          }\n        },\n        xAxis: {\n//          reversed: true,\n        },\n        yAxis: {\n          min: values.options.minimum,\n          max: values.options.maximum,\n          reversed: true,\n        },\n//        colors: ['#bbbbbb','#232323'],\n        tooltip: {\n          shared: true,\n          useHTML: true,\n          headerFormat: '<small>{point.key}</small><table>',\n          pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: </td>' +\n          '<td style=\"text-align: right\"><b>{point.y}'+values.options.tooltipUnit+'</b></td></tr>',\n          footerFormat: '</table>',\n        },\n      },\n      CYCoptions : {\n        decimals: values.options.tooltipDecimals,\n      }\n    });\n        sbars.displayCharts(container);\n    }\n}\n"]}