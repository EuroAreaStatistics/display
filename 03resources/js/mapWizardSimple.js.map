{"version":3,"sources":["../../03/JScomponents/modules/dataHandler/getHumanReadData.js","../../03/JScomponents/modules/dataHandler/getLatestYearData.js","../../03/JScomponents/modules/dataHandler/filterYear.js","../../03/JScomponents/modules/maps/getMapData.js","../../03/JScomponents/modules/maps/getIndicatorColorScale.js","../../03/JScomponents/modules/maps/getBubbleSize.js","../../03/JScomponents/modules/maps/getDisputedLines.js","../../03/JScomponents/modules/maps/getMapSubPoints.js","../../03/JScomponents/modules/maps/addMapLayers.js","../../03/JScomponents/modules/maps/updateLegend.js","../../03/JScomponents/modules/maps/mapStandardPlotting.js","../../03/JScomponents/modules/maps/getFlows.js","../../03/JScomponents/modules/maps/updateFlowData.js","../../03/JScomponents/modules/maps/leaflet.polylineDecorator.min.js","../../03/JScomponents/modules/maps/highlightAndPopup.js","../../03/JScomponents/modules/mapTeaser/mapTeaserExportRestrictions.js","../../03/JScomponents/modules/mapTeaser/mapTeaserExportRestrictionsMain.js","../../03/JScomponents/modules/mapTeaser/mapTeaserIfiCountryData.js","../../03/JScomponents/modules/mapTeaser/mapTeaserText.js","../../03/JScomponents/modules/mapTeaser/mapTeaserTextMulti.js"],"names":["getHumanReadData","number","decimals","trimZeros","undefined","parseFloat","abs","Math","decimalAdjust","type","value","exp","isNaN","NaN","toString","split","toFixed","s","replace","spaceSeparateNumber","val","test","commaSeparateNumber","window","lang_labels","getLatestYearData","data","newData","latestYear","keys","length","$","each","key","indexOf","filterYear","d","filter","title","definition","options","dimensions","idxYear","push","cr","yKey","getMapData","wizardConfig","page","countrylist","Chart","tab","project","tabs","mapType","flowStatus","ConfigProject","getPageCharts","DataforMap","DataforMap1","max","charts","labels","order","inArray","name","unit","getCountryData","minimum","minValueLatest","maximum","maxValueLatest","i","chart","values","MapColors","lang","dMax","dMin","minColor","quantize","map","x","idx","maxColor","slice","pageCharts","k","v","minValue","series","min","maxValue","arrayValue","getStandardDeviationWizard","devVal","average","getAverageFromNumArr","deviation","getStandardDeviation","group","getIndicatorColorScale","feature","colors","properties","mapCode","toLowerCase","MapGroup","landmass","range","scaleToInteger","scaleMin","scaleMax","floor","getBubbleSize","radius","sqrt","getDisputedLines","lines","disputedLinesNew","features","SOVEREIGNT","getMapSubPoints","mapCentroides","themeURL","mapSubPoints","smallIslands","this","addMapLayers","bubbleMap","mapdataviz","bubbles","layers","layerName","L","geoJson","mapShapes","style","getBasicCountryShapesStyle","clickable","addTo","matchIndex","key1","value1","colorIndicator","pointToLayer","bubblesSizeColorGeneric","onEachFeature","highlightAndPopup","html","text","updateMultiLegend","mapLayerIndex","mapLayerMatchIndex","width","control","collapsed","click","index","parent","closePopup","updateLegend","bubblesSimpleGeneric","updateFlowData","maxBubble","clearFlows","clearFlowLegend","shapes","layerGroup","getColorCountryShapesStyleGeneric","bubblesSimpleColorGeneric","stamp","DataforMapAll","defaultLayer","embed","textColor","hex","match","rgb","parseInt","apply","Data","mode","empty","append","color","el","addClass","css","subtext","lang_countries","show","hide","relatedDataControl","updateColors","id","setLegend","chartType","loopMapIndicator","setInterval","changeColor","changeBubble","currentLayer","removeLayer","layer","random","landmassBorder","landmassBorderWidth","landmassGroup","bubbleDefaultBorder","bubbleDefaultColor","bubbleHighlightBorder","shapeHighlightBorder","landmassNA","layerData","weight","opacity","fillOpacity","fillColor","className","latlng","circleMarker","getBubbleStyleGeneric","colorData","getBubbleColorGeneric","sizeData","getBubbleSizeColorGeneric","bubbleColor","getBasicGroupColor","colorIdx","flowGroup","activeLayer","clickFlow","e","target","layerCode","addLines","center","stars","getFlows","centroides","updateFlowLegend","clearLayers","country","DataforFlow","idxCountry","toUpperCase","crData","crData1","getLineSize","flowLabels","tableHead1","en","cn","tableHead2","world","unspecified","asia","headlinePrefix","headlineSuffix","remove","legendData","getFlowsLegend","round","sort","a","b","flow","centros","Lat","Long","polyline","latlong","fill","addLayer","indicator","ajax","dataType","url","baseURL","success","ajaxSuccess","error","xhr","ajaxOptions","thrownError","status","alert","LineUtil","PolylineDecorator","computeAngle","atan2","y","PI","getPointPathPixelLength","c","distanceTo","getPixelLength","Polyline","getLatLngs","f","g","projectPatternOnPath","l","projectPatternOnPointPath","latLng","unproject","pt","interpolateOnPointPath","predecessor","heading","interpolateBetweenPoints","h","j","Point","RotatedMarker","Marker","extend","angle","_setPos","prototype","call","DomUtil","TRANSFORM","_icon","Browser","ie","LatLng","DEG_TO_RAD","cos","sin","rotatedMarker","Symbol","Dash","Class","isZoomDependant","pixelSize","pathOptions","initialize","Util","setOptions","buildSymbol","add","subtract","dash","ArrowHead","polygon","headAngle","stroke","Polygon","_buildArrowPath","arrowHead","markerOptions","rotate","draggable","marker","LayerGroup","patterns","_map","_initPaths","_initPatterns","_paths","MultiPolyline","MultiPolygon","_initPath","isArray","_isCoordArray","_isZoomDependant","_patterns","_parsePatternDef","isOffsetInPixels","isRepeatInPixels","symbolFactory","setPatterns","_softRedraw","setPaths","redraw","cache","symbol","offset","repeat","onAdd","_draw","on","onRemove","off","_buildSymbols","_getCache","_getDirectionPoints","getZoom","_redraw","_drawPattern","polylineDecorator","interaction","inEuroArea","mouseover","inFront","setStyle","bringToFront","mouseout","disputedLines","eachLayer","sublayer","notClickable","specialTooltip","specialTooltipLinks","teaserText","mapTeaserExportRestrictionsMain","mapTeaserExportRestrictions","mapTeaserIfiCountryData","mapTeaserTextMulti","mapTeaserText","popup","setLatLng","setContent","openOn","popupLoop","countryISO","Centroides","setView","labels2","1","2","3","4","5","6","teaserTitleStart","teaserTitleEnd","teaserTableStart","teaserTableLineCenter","teaserTableEnd","countryProfile","countryName","tableLines","tableLine","tableLineCanvas","tooltipData","links","teaser","teaserTitle","teaserTable","link","attr","dataValue","hasData","ChartsWithData","after","euGroup","countrynotes","ISO3toFlags"],"mappings":"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","file":"mapWizardSimple.min.js","sourcesContent":["// function to convert large numbers in human readable numbers\n// passing a negative number for decimals returns the unmodified number\nfunction getHumanReadData(number, decimals, trimZeros) {\n  if (decimals === undefined) {\n    decimals = 0;\n  }\n\n  if (decimals < 0) {\n    return number;\n  }\n\n  number = parseFloat(number);\n  var abs = Math.abs(number);\n\n  /* code from MDN (public domain)\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round$revision/981487#Decimal_rounding\n  */\n  /**\n   * Decimal adjustment of a number.\n   *\n   * @param {String}  type  The type of adjustment.\n   * @param {Number}  value The number.\n   * @param {Integer} exp   The exponent (the 10 logarithm of the adjustment base).\n   * @returns {Number} The adjusted value.\n   */\n  function decimalAdjust(type, value, exp) {\n    // If the exp is undefined or zero...\n    if (typeof exp === 'undefined' || +exp === 0) {\n      return Math[type](value);\n    }\n    value = +value;\n    exp = +exp;\n    // If the value is not a number or the exp is not an integer...\n    if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0)) {\n      return NaN;\n    }\n    // Shift\n    value = value.toString().split('e');\n    value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));\n    // Shift back\n    value = value.toString().split('e');\n    return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));\n  }\n\n  function toFixed(number, decimals) {\n    var s = decimalAdjust('round', number, -decimals).toFixed(decimals);\n    return trimZeros ? s.replace(/\\.0+$|(\\..*?)0+$/,'$1') : s;\n  }\n\n  // this function prints larger number in OECD format 10 000.23 usw.\n  function spaceSeparateNumber(val){\n    while (/(\\d+)(\\d{3})/.test(val.toString())){\n      val = val.toString().replace(/(\\d+)(\\d{3})/, '$1' + ' ' + '$2');\n    }\n    return val;\n  }\n\n  // this function prints larger number in US format 10,000.23 usw.\n  function commaSeparateNumber(val){\n    while (/(\\d+)(\\d{3})/.test(val.toString())){\n      val = val.toString().replace(/(\\d+)(\\d{3})/, '$1' + ',' + '$2');\n    }\n    return val;\n  }\n\n  if(abs > 1e12) {\n    return toFixed(number / 1e12, decimals) + '&nbsp;' + window.lang_labels['trillion'];\n  } else if(abs > 1e9) {\n    return toFixed(number / 1e9, decimals) + '&nbsp;' + window.lang_labels['billion'];\n  } else if(abs > 1e6) {\n    return toFixed(number / 1e6, decimals) + '&nbsp;' + window.lang_labels['million'];\n  } else if(abs > 1e5) {\n    return toFixed(number / 1e3, decimals) + '&nbsp;' + window.lang_labels['thousand'];\n  } else {\n    return spaceSeparateNumber(toFixed(number, decimals));\n  }\n}\n","\n\n\n// returns the latest available year for a two dimensional JSON data set\n\nfunction getLatestYearData (data) {\n  var newData = {};\n  var latestYear = data.keys[1].length-1;\n  $.each(data.keys[0], function (key,value) {\n      newData[value]=[];\n      while (data.data[data.keys[0].indexOf(value)][latestYear] == null && latestYear>=0) {\n          latestYear = latestYear-1;\n      };\n      newData[value][0]=data.keys[1][latestYear];\n      newData[value][1]=data.data[data.keys[0].indexOf(value)][latestYear];\n      latestYear = data.keys[1].length-1;\n  });\n  return newData;\n}\n","\n\n\nfunction filterYear(d,filter) {\n\tvar newData = {}\n\tnewData['title'] = d.title\n\tnewData['definition'] = d.definition\n\tnewData['options'] = d.options\n\tnewData['data'] = {}\n\tnewData.data['dimensions'] = d.data.dimensions;\n\tnewData.data['keys'] = [];\n\tnewData.data['keys'][0] = d.data.keys[0];\n\tnewData.data['keys'][1] = [];\n\tnewData.data['data'] = [];\n\tvar idxYear = []\n\t$.each(filter, function (key,value) {\n\t\tidxYear.push(d.data.keys[1].indexOf(value))\n\t\tnewData.data.keys[1].push(value);\n\t});\n\t$.each(newData.data.keys[0], function(key,cr){\n\t\tnewData.data.data[key] = [];\n\t\t$.each(idxYear, function (yKey,value) {\n\t\t\tnewData.data.data[key].push(d.data.data[key][value])\n\t\t});\n\t});\n\treturn newData;\n}\n","\nfunction getMapData (wizardConfig,page,countrylist,Chart) {\n\n  var tab = wizardConfig.project.tabs[page];\n  var mapType = wizardConfig.tabs[tab].mapType;\n  var flowStatus = wizardConfig.tabs[tab].type;\n\n  var ConfigProject = getPageCharts(wizardConfig,page);\n\n  var DataforMap = [];\n  var DataforMap1 = [];\n  \n  var data = {};\n\n  data['defaultLayer'] = 0;\n  if (Chart != null) {\n// set default layer to index of first element of Chart or 0\n    data['defaultLayer'] = Math.max(0, wizardConfig.tabs[tab].charts.indexOf(Chart[0]));\n  }\n\n  if (mapType == 'TwoIndicatorsSplitOnYears') {\n//returns data of the first chart as separate maps - split on the YEARS dimension (data.keys[1])\n//returns data of the second chart as separate maps - split on the YEARS dimension (data.keys[1])\n\n    var labels = wizardConfig.tabs[tab].labels;\n    var key=0;\n    $.each(labels.order, function (order,value) {\n      if($.inArray(value, ConfigProject[0].data.keys[1]) > -1) {\n        DataforMap[key]               = filterYear(ConfigProject[0],[value]);\n        if (labels.labels[value]) {\n          DataforMap[key]['title']      = labels.labels[value].name;\n          DataforMap[key]['unit']      = labels.labels[value].unit;\n        } else {\n          DataforMap[key]['title']      = value;\n          DataforMap[key]['unit']      = '';\n        }\n        DataforMap[key]['code']       = value;\n        DataforMap[key]['definition'] = value;\n        DataforMap[key]['values']     = getCountryData(getLatestYearData(DataforMap[key]['data']),countrylist);\n  \n        if (ConfigProject[0].options.minimum && ConfigProject[0].options.minimum != null) {\n          DataforMap[key]['min']      = ConfigProject[0].options.minimum;\n        } else {\n          DataforMap[key]['min']      = minValueLatest(DataforMap[key]['values']);\n        }\n        if (ConfigProject[0].options.maximum && ConfigProject[0].options.maximum != null) {\n          DataforMap[key]['max']      = ConfigProject[0].options.maximum;\n        } else {\n          DataforMap[key]['max']      = maxValueLatest(DataforMap[key]['values'],1);\n        }\n        DataforMap[key]['latestYear'] = maxValueLatest(DataforMap[key]['values'],0);\n        key++;\n      }\n    });\n\n    if (ConfigProject[1] != null) {\n      $.each(ConfigProject[1].data.keys[1], function (key, value) {\n        DataforMap1[key] = filterYear(ConfigProject[1],[value]);\n        if (labels.labels[value]) {\n          DataforMap1[key]['title']      = labels.labels[value].name;\n        } else {\n          DataforMap1[key]['title']      = value;\n        }\n        DataforMap1[key]['code']        = value;\n        DataforMap1[key]['definition']  = value;\n        DataforMap1[key]['values']      = getCountryData(getLatestYearData(DataforMap1[key]['data']),countrylist);\n  \n        if (ConfigProject[1].options.minimum && ConfigProject[1].options.minimum != null) {\n          DataforMap1[key]['min']       = ConfigProject[1].options.minimum;\n        } else {\n          DataforMap1[key]['min']       = minValueLatest(DataforMap1[key]['values']);\n        }\n        if (ConfigProject[1].options.maximum && ConfigProject[1].options.maximum != null) {\n          DataforMap1[key]['max']       = ConfigProject[1].options.maximum;\n        } else {\n          DataforMap1[key]['max']       = maxValueLatest(DataforMap1[key]['values'],1);\n        }\n        DataforMap1[key]['latestYear']  = maxValueLatest(DataforMap1[key]['values'],0);\n      });\n    }\n\n\n  } else {\n\n    var i=0;\n    $.each(ConfigProject, function (chart, values) {\n      if (values.type != 'flow') {\n        DataforMap[i] = {};\n        DataforMap[i]['colors']     = MapColors;\n        DataforMap[i]['title']      = values['title'][lang];\n        DataforMap[i]['definition'] = values['definition'][lang];\n        DataforMap[i]['options']    = values['options'];\n        DataforMap[i]['values']     = getCountryData(getLatestYearData(values['data']),countrylist);\n        if (DataforMap[i]['options']['minimum'] && DataforMap[i]['options']['minimum'] != null) {\n          DataforMap[i]['min']    = DataforMap[i]['options']['minimum'];\n        } else {\n          DataforMap[i]['min']    = minValueLatest(DataforMap[i]['values']);\n      //    DataforMap[i]['min'] = getStandardDeviationWizard(DataforMap[i]['values'],'min');\n        }\n        if (DataforMap[i]['options']['maximum'] && DataforMap[i]['options']['maximum'] != null) {\n          DataforMap[i]['max']    = DataforMap[i]['options']['maximum'];\n        } else {\n          DataforMap[i]['max']    = maxValueLatest(DataforMap[i]['values'],1);\n      //    DataforMap[i]['max'] = getStandardDeviationWizard(DataforMap[i]['values'],'max');\n        }\n        if (DataforMap[i]['options']['mapDivergent']) {\n          var dMax = Math.max(Math.abs(DataforMap[i]['min']), Math.abs(DataforMap[i]['max']));\n          var dMin = -dMax;\n          // adjust color scale if min/max is assymetric\n          var minColor = quantize(DataforMap[i]['min'], dMin, dMax, DataforMap[i]['colors'].map(function (x,idx) { return idx; }));\n          var maxColor = quantize(DataforMap[i]['max'], dMin, dMax, DataforMap[i]['colors'].map(function (x,idx) { return idx; }));\n          if (minColor > 0) {\n            dMin += minColor * (dMax - dMin) / DataforMap[i]['colors'].length;\n            DataforMap[i]['colors'] = DataforMap[i]['colors'].slice(minColor);\n          } else if (maxColor+1 < DataforMap[i]['colors'].length) {\n            dMax -= (DataforMap[i]['colors'].length - (maxColor+1)) * (dMax - dMin) / DataforMap[i]['colors'].length;\n            DataforMap[i]['colors'] = DataforMap[i]['colors'].slice(0, maxColor+1);\n          }\n          DataforMap[i]['max'] = dMax;\n          DataforMap[i]['min'] = dMin;\n        }\n        DataforMap[i]['latestYear'] = maxValueLatest(DataforMap[i]['values'],0);\n        if ('mapRegion' in DataforMap[i]['options']) {\n          DataforMap[i]['values'][DataforMap[i]['options']['mapRegion']] = getLatestYearData(values['data'])[DataforMap[i]['options']['mapRegion']];\n        }\n        i = i+1;\n      }\n    });\n\n  }\n  \n  data['map'] = DataforMap;\n  data['map1'] = DataforMap1;\n  data['flow'] = flowStatus;\n\n  function getPageCharts (wizardConfig,page) {\n    var tab = wizardConfig.project.tabs[page];\n    var charts = wizardConfig.tabs[tab].charts;\n\n    var pageCharts = [];\n    $.each(charts, function (k,v){\n      pageCharts.push(wizardConfig.charts[v]);\n    });\n    return pageCharts;\n  };\n\n  function minValue(series) {\n    //private\n    var min = null;\n    $.each(series, function (k, v) {\n      if (v == null) return;\n      if (min == null) min = v;\n      else if (min > v) min = v;\n    });\n    return min;\n  }\n\n  function maxValue(series) {\n    //private\n    var max = null;\n    $.each(series, function (k, v) {\n      if (v == null) return;\n      if (max == null) max = v;\n      else if (max < v) max = v;\n    });\n    return max;\n  }\n\n  function minValueLatest(series) {\n    //public\n    var min = null;\n    $.each(series, function (k, v) {\n      v = v[1];\n      if (v == null) return;\n      if (min == null) min = v;\n      else if (min > v) min = v;\n    });\n    return min;\n  }\n\n  function maxValueLatest(series, arrayValue) {\n    //public\n    var max = null;\n    $.each(series, function (k, v) {\n      v = v[arrayValue];\n      if (v == null) return;\n      if (max == null) max = v;\n      else if (max < v) max = v;\n    });\n    return max;\n  }\n\n  function getStandardDeviationWizard (series,value) {\n    //public\n    var devVal = [];\n    $.each(series, function (k, v) {\n        devVal.push(v[1])\n    });\n    var average = getAverageFromNumArr(devVal, 2 );\n    var deviation = getStandardDeviation(devVal, 2 );\n\n    if (value == 'max') {\n      return (average + deviation);\n    } if (value == 'min') {\n      return (average - deviation);\n    } else {return null;}\n\n  }\n\n  function getCountryData(series, group) {\n    //public\n    var data = {};\n    $.each(series, function (k, v) {\n      if ($.inArray(k, group) > -1) {\n        data[k] = v;\n      }\n    });\n    return data;\n  }\n\n  return data;\n  \n};\n\n\n","function getIndicatorColorScale(d, dMin, dMax, feature, colors) {\n  if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n    return quantize(d, dMin, dMax, colors)\n  } else {\n    return landmass;\n  }\n\n}\n\nfunction quantize(d, dMin, dMax, range) {\n  function scaleToInteger(d, dMin, dMax, scaleMin, scaleMax) {\n    var i = Math.floor((d - dMin) / (dMax - dMin) * (scaleMax - scaleMin + 1)) + scaleMin;\n    if (i < scaleMin) return scaleMin;\n    if (i > scaleMax) return scaleMax;\n    return i;\n  }\n\n  return range[scaleToInteger(d, dMin, dMax, 0, range.length - 1)];\n}\n","\n\nfunction getBubbleSize(d, dMax, feature) {\n  //private\n  if (d == null || d <= 0) return null;\n  var radius = Math.sqrt(d / dMax) * 25;\n  if (radius < 3) radius = 3;\n  return radius;\n}\n","\n\n//returns lines for disputed territories for a given country group\n\nfunction getDisputedLines (lines,group) {\n  var disputedLinesNew = {\n        \"type\": \"FeatureCollection\",\n        \"features\": []\n        }\n  if ($.inArray('ind', group)>-1 || $.inArray('chn', group)>-1 || $.inArray('pak', group)>-1) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'IndiaChinaPakistan' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('ind', group)>-1 || $.inArray('chn', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'IndiaChina' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('egy', group)>-1 || $.inArray('sdn', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'EgyptSudan' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('sdn', group)>-1 || $.inArray('ssd', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'Sudan' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  } if ($.inArray('ken', group)>-1 || $.inArray('som', group)>-1 ) {\n    $.each(lines.features, function (k, feature) {\n      if (feature.properties.SOVEREIGNT == 'KenyaSom' ) {\n        disputedLinesNew['features'].push(feature);\n      }\n    });\n  }\n  return disputedLinesNew;\n\n}\n","\n\n\n//adds small islands as dots on color coded maps\n\nfunction getMapSubPoints(mapCentroides) {\n  if (themeURL == 'ecb') return;\n  var mapSubPoints = {\n        \"type\": \"FeatureCollection\",\n        \"features\": []\n        }\n  var smallIslands = ['AND','ATG','AIA','ASM','ABW','ALA','BRB','BLM','BMU','BVT','CCK','COK','CPV','CUW','CXR','DMA','FLK','FSM','GRD','GGY','GIB','GLP','SGS','GUM','HKG','IMN','JEY','KIR','COM','KNA','CYM','LCA','LIE','MCO','MAF','MHL','MAC','MNP','MTQ','MSR','MLT','MUS','MDV','NFK','NRU','NIU','PYF','SPM','PCN','PRI','PLW','REU','SYC','SHN','SJM','SMR','STP','SXM','TCA','ATF','TKL','TON','TTO','TUV','VAT','VCT','VGB','VIR','WLF','WSM','MYT','ANT'];\n  $(mapCentroides.features).each(function(feature){\n    if ($.inArray(this.properties[mapCode], smallIslands) > -1) {\n      mapSubPoints['features'].push(this);\n    }\n  });\n  return mapSubPoints;\n}\n","\n//add mapLayers for the different display types (bubbles, colored bublbes (simple and complex), colored shapes)\n\nfunction addMapLayers (bubbleMap,mapdataviz,flowStatus) {\n  var bubbles=[];\n  var layers={};\n  var layerName=[];\n  \n  if (bubbleMap == 'multiColored') {\n// used on template 'multipleColoredBubbles'\n// A colored bubble map. The first chart sets the bubble size, the second the bubble color. The second dimension (YEARS) is represented as a separate indicator\n\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    var i=0;\n    var matchIndex = [];\n    $.each(DataforMap, function (key, value) {\n      $.each(DataforMap1, function (key1, value1) {\n        if (value1.title == value.title) {\n          matchIndex[key] = key1+1;\n        }\n      });\n\n      if (matchIndex[key]) {\n        var colorIndicator = DataforMap1[matchIndex[key]-1]\n      } else {\n        var colorIndicator = null;\n      }\n\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSizeColorGeneric(value,colorIndicator),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i]['title']).text()] = bubbles[i];\n      i++;\n    });\n\n    bubbles[0].addTo(mapdataviz);\n    updateMultiLegend(DataforMap[0],'size');\n    updateMultiLegend(DataforMap1[matchIndex[0]-1],'color');\n//global variables to define map layer (used for popup window)\n    window.mapLayerIndex = 0;\n    window.mapLayerMatchIndex = matchIndex;\n    if (DataforMap.length > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateMultiLegend(DataforMap[index],'size');\n      updateMultiLegend(DataforMap1[matchIndex[index]-1],'color');\n      mapdataviz.closePopup();\n      window.mapLayerIndex = index;\n    });\n\n  } else if (bubbleMap == 'colored') {\n// first indicator bubble size, all other indicators bubble color\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    for (i=0;i<DataforMap.length-1;i++) {\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSizeColorGeneric(DataforMap[0],DataforMap[i+1]),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i+1]['title']).text()] = bubbles[i]\n    }\n    bubbles[0].addTo(mapdataviz);\n    updateLegend(DataforMap[0],'size');\n    updateLegend(DataforMap[1],'color');\n    if (DataforMap.length-1 > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateLegend(DataforMap[index+1],'color');\n    });\n\n  } else if (bubbleMap == 'coloredPairUnpair') {\n// pair indicators bubble size, unpair indicators bubble color\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    for (i=0;i<DataforMap.length/2;i++) {\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSizeColorGeneric(DataforMap[i*2],DataforMap[(i*2)+1]),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i*2]['title']).text()] = bubbles[i]\n    }\n    bubbles[0].addTo(mapdataviz);\n    updateLegend(DataforMap[0],'size');\n    updateLegend(DataforMap[1],'color');\n    if (DataforMap.length-1 > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateLegend(DataforMap[index*2],'size');\n      updateLegend(DataforMap[(index*2)+1],'color');\n    });\n\n\n  } else if (bubbleMap == 'simple') {\n\n    L.geoJson(\n      mapShapes, {\n        style: getBasicCountryShapesStyle,\n        clickable: false\n      }).addTo(mapdataviz);\n    for (i=0;i<DataforMap.length;i++) {\n      bubbles[i] = L.geoJson(\n        mapCentroides, {\n          pointToLayer: bubblesSimpleGeneric(DataforMap[i]),\n          onEachFeature: highlightAndPopup\n        });\n      layerName[$('<div>').html(DataforMap[i]['title']).text()] = bubbles[i]\n    }\n    bubbles[0].addTo(mapdataviz);\n//add flows\n    if (flowStatus=='flow') {\n      updateLegend(DataforMap[0],'flows');\n      updateFlowData(DataforMap[0]['code']);\n//add global variable for value behind bubble size as a scaling reference for flow lines\n      window.maxBubble = DataforMap[0]['max'];\n    } else {\n      updateLegend(DataforMap[0],'size');\n    }\n    \n    if (DataforMap.length > 1) {\n      if ($(window).width() < 750) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n//add flows\n      if (flowStatus=='flow') {\n        updateFlowData(DataforMap[index]['code']);\n        clearFlows();\n        clearFlowLegend();\n        updateLegend(DataforMap[index],'flows');\n//add global variable for value behind bubble size as a scaling reference for flow lines\n        window.maxBubble = DataforMap[index]['max'];\n      } else {\n        updateLegend(DataforMap[index],'size');\n      }\n    });\n\n  } else {\n\n    var shapes=[];\n    var layerGroup=[];\n    var mapSubPoints = getMapSubPoints(mapCentroides);\n\n    for (i=0;i<DataforMap.length;i++) {\n      shapes[i] = L.geoJson(\n        mapShapes, {\n          style: getColorCountryShapesStyleGeneric(DataforMap[i]),\n          onEachFeature: highlightAndPopup,\n          clickable: false\n        });\n      if (mapSubPoints != undefined) {\n        bubbles[i] = L.geoJson(\n          mapSubPoints, {\n            pointToLayer: bubblesSimpleColorGeneric(DataforMap[i]),\n            onEachFeature: highlightAndPopup\n          });\n        layerGroup[i] = L.layerGroup([shapes[i],bubbles[i]])\n      } else {\n        layerGroup[i] = L.layerGroup([shapes[i]])\n      }\n      // force the layer control to display the indicators in the correct order\n      L.stamp(layerGroup[i]);\n      layerName[$('<div>').html(DataforMap[i]['title']).text()] = layerGroup[i];\n    }\n    layerGroup[DataforMapAll.defaultLayer].addTo(mapdataviz);\n    updateLegend(DataforMap[DataforMapAll.defaultLayer],'color');\n    if (DataforMap.length > 1) {\n      if ($(window).width() < 750 || embed == 2) {\n        L.control.layers(layerName,null,{collapsed: true}).addTo(mapdataviz);\n      } else {\n        L.control.layers(layerName,null,{collapsed: false}).addTo(mapdataviz);\n      }\n    }\n    $(\".leaflet-control-layers-selector\").click(function(){\n      var index = $(this).parent().index();\n      updateLegend(DataforMap[index],'color');\n    });\n\n  }\n\n}\n","function textColor(hex) {\n  var match = hex.match(/^#(..)(..)(..)$/);\n  if (match) {\n    var rgb = match.slice(1).map(function (s) { return parseInt(s, 16) / 255; });\n    // calculate L from HSL\n    var L = (Math.min.apply(null, rgb) + Math.max.apply(null, rgb)) / 2;\n    return L < 0.5 ? '#fff' : '#000';\n  } else {\n    return '#000';\n  }\n}\n\nfunction updateLegend(Data,mode) {\n  if (mode == 'color') {\n    if (Data) {\n      var colors = Data['colors'];\n      $('#legendMinColor').parent().parent()\n        .empty()\n        .append(colors.map(function (color, idx, colors) {\n          var el = $('<li>');\n          if (idx === 0) {\n            el.addClass('firstLegendElement');\n            el.append($('<span id=\"legendMinColor\" class=\"firstLegendElement\">').css('background', color).css('color', textColor(color)));\n          } else if (idx+1 === colors.length) {\n            el.addClass('lastLegendElement');\n            el.append($('<span id=\"legendMaxColor\" class=\"lastLegendElement\">').css('background', color).css('color',  textColor(color)));\n          } else {\n            el.append($('<span>').css('background', color));\n          }\n          return el;\n        }));\n      $('#legendMaxColor').html(getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendMinColor').html(getHumanReadData(Data['min'],Data['options']['tooltipDecimals']));\n      $('#legendTitleColor').text($('<div>').html(Data['title']).text());\n\n      if ('mapRegion' in Data['options'] && Data['options']['mapRegion'] != '' && Data['values'][Data['options']['mapRegion']]) {\n        var subtext = lang_countries[Data['options']['mapRegion'].toLowerCase()]+': '+getHumanReadData(Data['values'][Data['options']['mapRegion']][1],Data['options']['tooltipDecimals']);\n        if (Data['options']['tooltipUnit']!= '') {\n          subtext += ' '+Data['options']['tooltipUnit'];\n        }\n        if (Data['values'][Data['options']['mapRegion']][0] != Data['latestYear']) {\n          subtext += ' ('+Data['values'][Data['options']['mapRegion']][0]+')';\n        }\n        $('#legendSubtextColor').html(subtext);\n        $('#legendSubtextColor').show();\n        if ('mapSource' in lang_labels) {\n          $('#topContainer').css('height', '66px');\n        } else {\n          $('#topContainer').css('height', '58px');\n        }\n      } else {\n        if ('mapSource' in lang_labels) {\n          $('#topContainer').css('height', '58px');\n        }\n        $('#legendSubtextColor').hide();\n      }\n\n      if (window.relatedDataControl) {\n        window.relatedDataControl.updateColors(function (id) {\n          return Data.values[id] && quantize(Data.values[id][1], Data.min, Data.max, Data.colors);\n        });\n      }\n\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitColor').text(', '+Data['options']['tooltipUnit']);\n      } else {\n        $('#legendUnitColor').text('');\n      }\n      $('#legendYearColor').text(Data['latestYear']);\n    } else {\n      $('#legendMaxColor').html('');\n      $('#legendMinColor').html('');\n      $('#legendTitleColor').text('No data available');\n      $('#legendUnitColor').text('');\n      $('#legendYearColor').text('');\n    }\n  } else if (mode == 'flows') {\n    if (Data) {\n      $('#legendBubble').html(window.lang_labels['min']+': '+getHumanReadData(Data['min'],Data['options']['tooltipDecimals']) +' - '+window.lang_labels['max']+': '+getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendTitleSize').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitSize').text(', '+Data['options']['tooltipUnit']);\n      } else {\n        $('#legendUnitSize').text('');\n      }\n      $('#legendYearSize').text('');\n    } else {\n      $('#legendBubble').html('');\n      $('#legendTitleSize').text('No data available');\n      $('#legendUnitSize').text('');\n      $('#legendYearSize').text('');\n    }\n  } else {\n    if (Data) {\n      $('#legendBubble').html(window.lang_labels['min']+': '+getHumanReadData(Data['min'],Data['options']['tooltipDecimals']) +' - '+window.lang_labels['max']+': '+getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendTitleSize').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitSize').text(', '+Data['options']['tooltipUnit']);\n      } else {\n        $('#legendUnitSize').text('');\n      }\n      $('#legendYearSize').text(Data['latestYear']);\n    } else {\n      $('#legendBubble').html('');\n      $('#legendTitleSize').text('No data available');\n      $('#legendUnitSize').text('');\n      $('#legendYearSize').text('');\n    }\n  }\n  $('#flowLayer .commodity').text(Data['title']);\n\n}\n\n\nfunction updateMultiLegend(Data,mode) {\n  if (mode == 'color') {\n    if (Data) {\n      $('#legendMaxColor').html(getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendMinColor').html(getHumanReadData(Data['min'],Data['options']['tooltipDecimals']));\n      $('#legendTitleColor').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitColor').text(', '+Data['unit']);\n      } else {\n        $('#legendUnitColor').text('');\n      }\n      $('#legendYearColor').text('');\n    } else {\n      $('#legendMaxColor').html('');\n      $('#legendMinColor').html('');\n      $('#legendTitleColor').text('No data available');\n      $('#legendUnitColor').text('');\n      $('#legendYearColor').text('');\n    }\n  } else {\n    if (Data) {\n      $('#legendBubble').html(window.lang_labels['min']+': '+getHumanReadData(Data['min'],Data['options']['tooltipDecimals']) +' - '+window.lang_labels['max']+': '+getHumanReadData(Data['max'],Data['options']['tooltipDecimals']));\n      $('#legendTitleSize').text($('<div>').html(Data['title']).text());\n      if (Data['options']['tooltipUnit']!= '') {\n        $('#legendUnitSize').text(', '+Data['unit']);\n      } else {\n        $('#legendUnitSize').text('');\n      }\n      $('#legendYearColor').text('');\n    } else {\n      $('#legendBubble').html('');\n      $('#legendTitleSize').text('No data available');\n      $('#legendUnitSize').text('');\n      $('#legendYearSize').text('');\n    }\n  }\n}\n\n\n\nfunction setLegend(chartType,bubbleMap) {\n\n  if (bubbleMap == 'colored' || bubbleMap == 'multiColored' || bubbleMap == 'coloredPairUnpair') {\n    $('#textLegend').hide();\n  } else if (bubbleMap == 'simple') {\n    $('#colorLegend').hide();\n    if (chartType == 'mapWizard') {\n      $('#textLegend').hide();\n      $('#sizeLegend').css({\"width\": \"100%\"});\n    }\n  } else {\n    $('#sizeLegend').hide();\n    if (chartType == 'mapWizard') {\n      $('#textLegend').hide();\n      $('#colorLegend').css({\"width\": \"100%\"});\n    }\n  }\n}\n\n\nfunction loopMapIndicator (mode) {\n\n  if (mode == 'color') {\n    setInterval(changeColor,2000);\n  } else if (mode == 'bubble') {\n    setInterval(changeBubble,2000);\n  }\n\n  var currentLayer = 0;\n\n  function changeBubble() {\n    mapdataviz.removeLayer(bubbles[currentLayer]);\n    layer = Math.floor((Math.random() * bubbles.length) + 1);\n    currentLayer = layer-1\n    bubbles[currentLayer].addTo(mapdataviz);\n    updateLegend(DataforMap[currentLayer],'size');\n  }\n\n  function changeColor() {\n    mapdataviz.removeLayer(shapes[currentLayer]);\n    layer = Math.floor((Math.random() * shapes.length) + 1);\n    currentLayer = layer-1\n    shapes[currentLayer].addTo(mapdataviz);\n    updateLegend(DataforMap[currentLayer],'color');\n  }\n\n}\n","var landmass;\nvar landmassBorder;\nvar landmassBorderWidth;\nvar landmassGroup;\nvar bubbleDefaultBorder;\nvar bubbleDefaultColor;\nvar bubbleHighlightBorder;\nvar shapeHighlightBorder;\nif (themeURL=='ecb') {\n  landmass = '#f0f0f0';\n  landmassNA = '#fff';\n  landmassBorder = '#000';\n  landmassBorderWidth = 0.5;\n  landmassGroup = '#f0f0f0';\n  bubbleDefaultBorder = \"#494444\";\n  bubbleDefaultColor = \"#d56620\";\n  bubbleHighlightBorder = \"#fff\";\n  shapeHighlightBorder = '#fff';\n} else {\n  landmass = '#939393';\n  landmassNA = '#939393';\n  landmassBorder = '#939393';\n  landmassBorderWidth = 1;\n  landmassGroup = '#BBBBBB';\n  bubbleDefaultBorder = \"#494444\";\n  bubbleDefaultColor = \"#d56620\";\n  bubbleHighlightBorder = \"#fff\";\n  shapeHighlightBorder = '#fff';\n}\n\nif (project == 'trade-in-raw-materials') {\n  landmass = '#BBBBBB';\n  landmassNA = '#BBBBBB';\n}\n\nif (project == 'itf-test') {\n  landmass = '#BBBBBB';\n  landmassNA = '#BBBBBB';\n}\n\nfunction getColorCountryShapesStyleGeneric(layerData) {\n  //public\n  return function (feature) {\n\n    if (feature && feature.properties && layerData['values'][feature.properties[mapCode]] != null) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: getIndicatorColorScale(layerData['values'][feature.properties[mapCode]][1], layerData['min'], layerData['max'], feature, layerData['colors']) || landmassNA,\n        className: \"hasValue\"\n      };\n    } else if (feature && feature.properties && $.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: landmassNA,\n        className: \"hasValue\"\n      };\n    } else if (feature && feature.properties && $.inArray(feature.properties[mapCode].toString().toLowerCase(), [\"aut\", \"bel\", \"cyp\", \"deu\", \"esp\", \"est\", \"fin\", \"fra\", \"grc\", \"irl\", \"ita\", \"ltu\", \"lux\", \"lva\", \"mlt\", \"nld\", \"prt\", \"svk\", \"svn\"]) > -1) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: '#004996',\n        className: \"hasValue\"\n      };\n    } else if (feature && feature.properties && feature.properties[mapCode]) {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: landmass,\n        className: \"hasValue\"\n      };\n    } else {\n      return {\n        weight: landmassBorderWidth,\n        opacity: 1,\n        color: landmassBorder,\n        fillOpacity: 1,\n        fillColor: landmassGroup,\n        className: \"hasValue\"\n      };\n    }\n\n  };\n\n}\n\n\nfunction bubblesSimpleGeneric (Data) {\n  return function (feature, latlng) {\n    //public\n    return L.circleMarker(latlng, getBubbleStyleGeneric(feature, Data));\n  };\n}\n\nfunction bubblesSimpleColorGeneric (colorData) {\n  return function (feature, latlng) {\n    //public\n    return L.circleMarker(latlng, getBubbleColorGeneric(feature,colorData));\n  };\n}\n\nfunction bubblesSizeColorGeneric (sizeData,colorData) {\n  return function (feature, latlng) {\n    //public\n    return L.circleMarker(latlng, getBubbleSizeColorGeneric(feature,sizeData,colorData));\n  };\n}\n\n\n\nfunction getBubbleStyleGeneric(feature, layerData) {\n  //private\n    var bubbleColor;\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1 && layerData['values'][feature.properties[mapCode]] != null) {\n        bubbleColor = bubbleDefaultColor;\n      if (layerData['values'][feature.properties[mapCode]] != null) {\n        var radius = getBubbleSize(layerData['values'][feature.properties[mapCode]][1], layerData['max'], feature);\n        if (radius != null) {\n          return {\n            radius: radius,\n            fillColor: bubbleColor,\n            color: bubbleDefaultBorder,\n            weight: 1,\n            opacity: 1,\n            fillOpacity: 1\n          };\n        }\n      }\n    }\n    return {\n      radius: 0,\n      opacity: 0\n    };\n}\n\n\nfunction getBubbleSizeColorGeneric(feature,sizeData,colorData) {\n  //private\n    var bubbleColor;\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1 && sizeData['values'][feature.properties[mapCode]] != null) {\n      radius = getBubbleSize(sizeData['values'][feature.properties[mapCode]][1], sizeData['max'], feature);\n      if (colorData != null) {\n        if (colorData['values'][feature.properties[mapCode]] != null) {\n          var bubbleColor = getIndicatorColorScale(colorData['values'][feature.properties[mapCode]][1], colorData['min'], colorData['max'],feature, colorData['colors']);\n          if (radius != null) {\n            return {\n              radius: radius,\n              fillColor: bubbleColor,\n              color: bubbleDefaultBorder,\n              weight: 1,\n              opacity: 1,\n              fillOpacity: 1\n            };\n          }\n        }\n      } else {\n        if (radius != null) {\n          return {\n            radius: radius,\n            fillColor: bubbleDefaultBorder,\n            color: bubbleDefaultBorder,\n            weight: 1,\n            opacity: 1,\n            fillOpacity: 1\n          };\n        }\n      }\n    }\n    return {\n      radius: 0,\n      opacity: 0\n    };\n}\n\nfunction getBubbleColorGeneric(feature,colorData) {\n  //private\n    var bubbleColor;\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n        radius = 5;\n      if (colorData['values'][feature.properties[mapCode]] != null) {\n        var bubbleColor = getIndicatorColorScale(colorData['values'][feature.properties[mapCode]][1], colorData['min'], colorData['max'],feature, colorData['colors']);\n        if (radius != null) {\n          return {\n            radius: radius,\n            fillColor: bubbleColor,\n            color: bubbleDefaultBorder,\n            weight: 1,\n            opacity: 1,\n            fillOpacity: 1\n          };\n        }\n      }\n    }\n    return {\n      radius: 0,\n      opacity: 0\n    };\n}\n\n\nfunction getBasicCountryShapesStyle(feature) {\n  //private\n  function getBasicGroupColor(feature) {\n    if ($.inArray(feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n      return landmassGroup;\n    } else {\n      return landmass;\n    }\n  }\n  return {\n    weight: landmassBorderWidth,\n    opacity: 1,\n    color: landmassBorder,\n    fillOpacity: 1,\n    fillColor: getBasicGroupColor(feature)\n  };\n}\n\n\n\n\n\n","var colorIdx = 0,\n    flowGroup = L.layerGroup(),\n    activeLayer = \"\";\nfunction clickFlow(e) {\n  //private\n  var layer = e.target;\n  var layerCode = layer.feature.properties[mapCode];\n  var color = ['blue', 'blue', 'blue'];\n\n  clearFlows();   \n\n  if (activeLayer != layerCode && $.inArray(layerCode.toLowerCase(), MapGroup) > -1) {\n    addLines(\n      {\n        center: layerCode,\n        stars: getFlows(layerCode)\n      },\n      color[colorIdx],\n      centroides,\n      mapdataviz\n    );\n    colorIdx = (colorIdx + 1) % 3;\n    activeLayer = layerCode;\n    updateFlowLegend (layerCode);\n\n  } else {\n    activeLayer = \"\";\n  }\n}\n\n\nfunction clearFlows () {\n  flowGroup.clearLayers().addTo(mapdataviz);  \n}\n\n\n\nfunction getFlows(country) {\n  var data = window.DataforFlow;\n  var idxCountry = data.keys[0].indexOf(country.toUpperCase());\n  var newData = {};\n  var max = 0;\n  $.each(data.keys[1], function (key, value) {\n    var crData = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n    if (max < crData) {\n      max = crData;\n    }\n  });\n  $.each(data.keys[1], function (key, value) {\n    var crData1 = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n    if (crData1 / max > 0.01) {\n      newData[value] = getLineSize(crData1, window.maxBubble);\n    } else {\n      newData[value] = 0;\n    }\n  });\n\n  function getLineSize(d, max) {\n  //private\n    if (d == null || d <= 0) return null;\n    var width = (Math.sqrt(d / max) * 25);\n    return width;\n  }\n\n  return newData;\n\n}\n\n\nfunction clearFlowLegend () {\n  $('#flowLayer .helptext').show();\n  $('#flowLayer #detailsTable').hide();\n  $('#flowLayer .countryPrefix').text('');\n  $('#flowLayer .country').html('');\n}\n\n\n\nfunction updateFlowLegend (layerCode) {\n\n  var flowLabels = {\n    'tableHead1' : {\n      'en':'Main export destinations',\n      'cn':''\n    },\n    'tableHead2' : {\n      'en':'USD Millions',\n      'cn':''\n    },\n    'world' : {\n      'en':'World',\n      'cn':''\n    },\n    'unspecified' : {\n      'en':'unspecified',\n      'cn':''\n    },\n    'asia' : {\n      'en':'Asia n.e.s.',\n      'cn':'n.e.s.'\n    },\n    'headlinePrefix' : {\n      'en':'Exports from ',\n      'cn':''\n    },\n    'headlineSuffix' : {\n      'en':'',\n      'cn':''\n    },\n  }\n\n  if (window.lang_countries[layerCode.toLowerCase()] != null) {\n    $('#flowLayer .country').html(window.lang_countries[layerCode.toLowerCase()]);\n  } else {\n    $('#flowLayer .country').html(layerCode);\n  }\n  $('#flowLayer #countryPrefix').text(flowLabels.headlinePrefix[lang]);\n  $('#flowLayer #countrySuffix').text(flowLabels.headlineSuffix[lang]);\n  $('#flowLayer .helptext').hide();\n  $('#flowLayer #detailsTable').show();\n  $('#flowLayer #detailsTable thead .countries').text(flowLabels.tableHead1[lang]);\n  $('#flowLayer #detailsTable thead .values').text(flowLabels.tableHead2[lang]);\n  $('#flowLayer #detailsTable tbody').remove();\n  $('#flowLayer #detailsTable').append('<tbody>');\n  var legendData = getFlowsLegend(layerCode);\n  $.each(legendData['rank'], function (key, value) {\n    if (window.lang_countries[legendData['values'][value].toLowerCase()] != null) {\n      country = window.lang_countries[legendData['values'][value].toLowerCase()];\n    } else if (legendData['values'][value] == 'WLD') {\n      country = flowLabels.world[lang];\n    } else if (legendData['values'][value] == 'UNSPE') {\n      country = flowLabels.unspecified[lang];\n    } else if (legendData['values'][value] == 'XCD') {\n      country = flowLabels.asia[lang];\n    } else {\n      country = legendData['values'][value];\n    }\n    $('#flowLayer #detailsTable tbody').append('<tr><td>'+country+'</td><td  class=\"tableValues\">'+Math.round(value/1000000)+'</td>');\n  });\n  \n  function getFlowsLegend(country) {\n    var data = window.DataforFlow;\n    var idxCountry = data.keys[0].indexOf(country.toUpperCase());\n    var newData = {};\n    newData['rank'] = [];\n    newData['values'] = {};\n    var max = 0;\n    $.each(data.keys[1], function (key, value) {\n      var crData = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n      if (max < crData) {\n        max = crData;\n      }\n    });\n    $.each(data.keys[1], function (key, value) {\n      var crData1 = data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];\n      if (crData1 / max > 0.01) {\n        newData['values'][crData1]=value;\n        newData['rank'].push(crData1);\n      }\n    });\n    newData['rank'].sort(function(a, b){return b-a});\n    return newData;\n  }\n}\n\nfunction addLines(flow, color, centros, mapdataviz) {\n  var stars = {};\n  $.each(flow.stars, function (country, value) {\n    if (centros[country.toUpperCase()] != undefined) {\n      stars[country] = {};\n      stars[country]['latlong'] = [parseFloat(centros[country.toUpperCase()].Lat), parseFloat(centros[country.toUpperCase()].Long)];\n      stars[country]['value'] = value\n    }\n  });\n  var center = [parseFloat(centros[flow.center.toUpperCase()].Lat), parseFloat(centros[flow.center.toUpperCase()].Long)];\n  $.each(stars, function (country, values) {\n    var lines = L.polyline([center, values.latlong], {\n      color: color,\n      weight: values.value,\n      fill: 'blue'\n    });\n    flowGroup.addLayer(lines);\n    //flowGroup.addLayer(L.polylineDecorator(lines, {\n    //  patterns: [{\n    //    offset: '100%',\n    //    repeat: 0,\n    //    symbol: L.Symbol.arrowHead({\n    //      pixelSize: values.value*3,\n    //      polygon: false,\n    //      pathOptions: {stroke: true, weight: values.value}\n    //    })\n    //  }]\n    //}));\n  });\n}\n\n/*\n function addRectangle(flow,centros,mapdataviz) {\n var stars = {};\n $.each(flow.stars, function (country,value) {\n stars[country] = {};\n stars[country]['latlong'] = [parseFloat(centros[country.toUpperCase()].Lat),parseFloat(centros[country.toUpperCase()].Long)];\n stars[country]['value'] = value\n });\n $.each(stars, function (country, values) {\n L.rectangle([[values.latlong[0],values.latlong[1]],[values.latlong[0]+values.value,values.latlong[1]+0.75]], {\n fillOpacity : 1,\n color: \"blue\",\n weight: 1\n }).addTo(mapdataviz);\n L.rectangle([[values.latlong[0],values.latlong[1]-0.75],[values.latlong[0]+1,values.latlong[1]]], {\n fillOpacity : 1,\n color: \"red\",\n weight: 1\n }).addTo(mapdataviz);\n });\n }\n */\n\n","\nfunction updateFlowData (indicator) {\n  $.ajax({\n    dataType: \"json\",\n    url: baseURL+\"/api-data?project=\"+project+\"&id=\"+indicator,\n    success: ajaxSuccess,\n    error: function (xhr, ajaxOptions, thrownError) {\n      if (xhr.status == '404') {\n        alert ('No data available.')};\n    }\n  });\n  \n  function ajaxSuccess(data) {\n    if (data != null) {\n      window.DataforFlow=data;\n    } else {\n      alert('No data available.');\n    }\n  }\n\n}\n\n","L.LineUtil.PolylineDecorator={computeAngle:function(a,b){return 180*Math.atan2(b.y-a.y,b.x-a.x)/Math.PI+90},getPointPathPixelLength:function(a){var b=a.length;if(2>b)return 0;for(var c=0,d=a[0],e=1;e<b;e++)c+=d.distanceTo(d=a[e]);return c},getPixelLength:function(a,b){var c=a instanceof L.Polyline?a.getLatLngs():a,d=c.length;if(2>d)return 0;for(var e=0,f=b.project(c[0]),g=1;g<d;g++)e+=f.distanceTo(f=b.project(c[g]));return e},projectPatternOnPath:function(a,b,c,d){var e=[],f;f=0;for(l=a.length;f<\nl;f++)e[f]=d.project(a[f]);a=this.projectPatternOnPointPath(e,b,c);f=0;for(l=a.length;f<l;f++)a[f].latLng=d.unproject(a[f].pt);return a},projectPatternOnPointPath:function(a,b,c){var d=[],e=this.getPointPathPixelLength(a)*c;b=this.interpolateOnPointPath(a,b);d.push(b);if(0<c){a=a.slice(b.predecessor);a[0]=b.pt;for(c=this.getPointPathPixelLength(a);e<=c;)b=this.interpolateOnPointPath(a,e/c),d.push(b),a=a.slice(b.predecessor),a[0]=b.pt,c=this.getPointPathPixelLength(a)}return d},interpolateOnPointPath:function(a,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  b){var c=a.length;if(2>c)return null;if(0>=b)return{pt:a[0],predecessor:0,heading:this.computeAngle(a[0],a[1])};if(1<=b)return{pt:a[c-1],predecessor:c-1,heading:this.computeAngle(a[c-2],a[c-1])};if(2==c)return{pt:this.interpolateBetweenPoints(a[0],a[1],b),predecessor:0,heading:this.computeAngle(a[0],a[1])};for(var d=this.getPointPathPixelLength(a),e=a[0],f=e,g=0,h=0,k=0,j=1;j<c&&h<b;j++)e=f,g=h,f=a[j],k+=e.distanceTo(f),h=k/d;return{pt:this.interpolateBetweenPoints(e,f,(b-g)/(h-g)),predecessor:j-\n2,heading:this.computeAngle(e,f)}},interpolateBetweenPoints:function(a,b,c){return b.x!=a.x?new L.Point(a.x*(1-c)+c*b.x,a.y*(1-c)+c*b.y):new L.Point(a.x,a.y+(b.y-a.y)*c)}};L.RotatedMarker=L.Marker.extend({options:{angle:0},_setPos:function(a){L.Marker.prototype._setPos.call(this,a);if(L.DomUtil.TRANSFORM)this._icon.style[L.DomUtil.TRANSFORM]+=\" rotate(\"+this.options.angle+\"deg)\";else if(L.Browser.ie){var b=this.options.angle*L.LatLng.DEG_TO_RAD;a=Math.cos(b);b=Math.sin(b);this._icon.style.filter+=\" progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11=\"+a+\", M12=\"+-b+\", M21=\"+b+\", M22=\"+a+\")\"}}});\nL.rotatedMarker=function(a,b){return new L.RotatedMarker(a,b)};L.Symbol=L.Symbol||{};\nL.Symbol.Dash=L.Class.extend({isZoomDependant:!0,options:{pixelSize:10,pathOptions:{}},initialize:function(a){L.Util.setOptions(this,a);this.options.pathOptions.clickable=!1},buildSymbol:function(a,b,c){b=this.options;if(1>=b.pixelSize)return new L.Polyline([a.latLng,a.latLng],b.pathOptions);var d=c.project(a.latLng);a=-(a.heading-90)*L.LatLng.DEG_TO_RAD;a=new L.Point(d.x+b.pixelSize*Math.cos(a+Math.PI)/2,d.y+b.pixelSize*Math.sin(a)/2);d=d.add(d.subtract(a));return new L.Polyline([c.unproject(a),c.unproject(d)],\n  b.pathOptions)}});L.Symbol.dash=function(a){return new L.Symbol.Dash(a)};\nL.Symbol.ArrowHead=L.Class.extend({isZoomDependant:!0,options:{polygon:!0,pixelSize:10,headAngle:60,pathOptions:{stroke:!1,weight:2}},initialize:function(a){L.Util.setOptions(this,a);this.options.pathOptions.clickable=!1},buildSymbol:function(a,b,c){b=this.options;return b.polygon?new L.Polygon(this._buildArrowPath(a,c),b.pathOptions):new L.Polyline(this._buildArrowPath(a,c),b.pathOptions)},_buildArrowPath:function(a,b){var c=b.project(a.latLng),d=-(a.heading-90)*L.LatLng.DEG_TO_RAD,e=this.options.headAngle/\n  2*L.LatLng.DEG_TO_RAD,f=d+e,d=d-e,f=new L.Point(c.x-this.options.pixelSize*Math.cos(f),c.y+this.options.pixelSize*Math.sin(f)),c=new L.Point(c.x-this.options.pixelSize*Math.cos(d),c.y+this.options.pixelSize*Math.sin(d));return[b.unproject(f),a.latLng,b.unproject(c)]}});L.Symbol.arrowHead=function(a){return new L.Symbol.ArrowHead(a)};\nL.Symbol.Marker=L.Class.extend({isZoomDependant:!1,options:{markerOptions:{},rotate:!1},initialize:function(a){L.Util.setOptions(this,a);this.options.markerOptions.clickable=!1;this.options.markerOptions.draggable=!1;this.isZoomDependant=L.Browser.ie&&this.options.rotate},buildSymbol:function(a){return this.options.rotate?(this.options.markerOptions.angle=a.heading,new L.RotatedMarker(a.latLng,this.options.markerOptions)):new L.Marker(a.latLng,this.options.markerOptions)}});L.Symbol.marker=function(a){return new L.Symbol.Marker(a)};L.PolylineDecorator=L.LayerGroup.extend({options:{patterns:[]},initialize:function(a,b){L.LayerGroup.prototype.initialize.call(this);L.Util.setOptions(this,b);this._map=null;this._initPaths(a);this._initPatterns()},_initPaths:function(a){this._paths=[];var b=!1;if(a instanceof L.MultiPolyline||(b=a instanceof L.MultiPolygon)){a=a.getLatLngs();for(var c=0;c<a.length;c++)this._initPath(a[c],b)}else if(a instanceof L.Polyline)this._initPath(a.getLatLngs(),a instanceof L.Polygon);else if(L.Util.isArray(a)&&\n  0<a.length)if(a[0]instanceof L.Polyline)for(c=0;c<a.length;c++)this._initPath(a[c].getLatLngs(),a[c]instanceof L.Polygon);else this._initPath(a)},_isCoordArray:function(a){return L.Util.isArray(a)&&0<a.length&&(a[0]instanceof L.LatLng||L.Util.isArray(a[0])&&2==a[0].length&&\"number\"===typeof a[0][0])},_initPath:function(a,b){var c;c=this._isCoordArray(a)?[a]:a;for(var d=0;d<c.length;d++)b&&c[d].push(c[d][0]),this._paths.push(c[d])},_initPatterns:function(){this._isZoomDependant=!1;this._patterns=[];\n  for(var a,b=0;b<this.options.patterns.length;b++)a=this._parsePatternDef(this.options.patterns[b]),this._patterns.push(a),this._isZoomDependant=this._isZoomDependant||a.isOffsetInPixels||a.isRepeatInPixels||a.symbolFactory.isZoomDependant},setPatterns:function(a){this.options.patterns=a;this._initPatterns();this._softRedraw()},setPaths:function(a){this._initPaths(a);this.redraw()},_parsePatternDef:function(a){var b={cache:[],symbolFactory:a.symbol,isOffsetInPixels:!1,isRepeatInPixels:!1};\"string\"===\ntypeof a.offset&&-1!=a.offset.indexOf(\"%\")?b.offset=parseFloat(a.offset)/100:(b.offset=parseFloat(a.offset),b.isOffsetInPixels=0<b.offset);\"string\"===typeof a.repeat&&-1!=a.repeat.indexOf(\"%\")?b.repeat=parseFloat(a.repeat)/100:(b.repeat=parseFloat(a.repeat),b.isRepeatInPixels=0<b.repeat);return b},onAdd:function(a){this._map=a;this._draw();if(this._isZoomDependant)this._map.on(\"zoomend\",this._softRedraw,this)},onRemove:function(a){this._map.off(\"zoomend\",this._softRedraw,this);this._map=null;L.LayerGroup.prototype.onRemove.call(this,\n  a)},_buildSymbols:function(a,b,c){for(var d=[],e=0,f=c.length;e<f;e++)d.push(b.buildSymbol(c[e],a,this._map,e,f));return d},_getCache:function(a,b,c){var d=a.cache[b];return\"undefined\"===typeof d?(a.cache[b]=[],null):d[c]},_getDirectionPoints:function(a,b){var c=this._map.getZoom(),d=this._getCache(b,c,a);if(d)return d;var e;e=null;var f=this._paths[a];b.isOffsetInPixels?(e=L.LineUtil.PolylineDecorator.getPixelLength(f,this._map),d=b.offset/e):d=b.offset;b.isRepeatInPixels?(e=null!==e?e:L.LineUtil.PolylineDecorator.getPixelLength(f,\n  this._map),e=b.repeat/e):e=b.repeat;d=L.LineUtil.PolylineDecorator.projectPatternOnPath(f,d,e,this._map);return b.cache[c][a]=d},redraw:function(){this._redraw(!0)},_softRedraw:function(){this._redraw(!1)},_redraw:function(a){if(null!==this._map){this.clearLayers();if(a)for(a=0;a<this._patterns.length;a++)this._patterns[a].cache=[];this._draw()}},_drawPattern:function(a){for(var b,c=0;c<this._paths.length;c++){b=this._getDirectionPoints(c,a);b=this._buildSymbols(this._paths[c],a.symbolFactory,b);\n  for(var d=0;d<b.length;d++)this.addLayer(b[d])}},_draw:function(){for(var a=0;a<this._patterns.length;a++)this._drawPattern(this._patterns[a])}});L.polylineDecorator=function(a,b){return new L.PolylineDecorator(a,b)};","\n\nfunction highlightAndPopup(feature, layer) {\n  if (!(feature && feature.properties && feature.properties[mapCode])) return;\n  //public\n  var interaction;\n  if (window.flowStatus == 'flow') {\n//see module getFlows\n    interaction = clickFlow;\n  } else {\n    interaction = click;\n  }\n  var inEuroArea = feature && feature.properties && $.inArray(feature.properties[mapCode].toString().toLowerCase(), [\"aut\", \"bel\", \"cyp\", \"deu\", \"esp\", \"est\", \"fin\", \"fra\", \"grc\", \"irl\", \"ita\", \"ltu\", \"lux\", \"lva\", \"mlt\", \"nld\", \"prt\", \"svk\", \"svn\"]) > -1;\n  if((themeURL == 'ecb' && !inEuroArea) || $.inArray(layer.feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n    layer.on({\n\n      click: interaction,\n\n      mouseover: function() {\n        if (!layer.inFront) {\n          layer.inFront = true;\n          layer.setStyle({\n            fillOpacity:0.8,\n            weight: 2,\n            color: bubbleMap != null ? bubbleHighlightBorder : shapeHighlightBorder\n            })\n          .bringToFront();\n        }\n      },\n      mouseout: function() {\n        layer.inFront = false;\n        layer.setStyle({\n            fillOpacity: 1,\n            weight: landmassBorderWidth,\n            color: bubbleMap != null ? bubbleDefaultBorder : landmassBorder\n            });\n        if (typeof disputedLines !== 'undefined') {\n          disputedLines.bringToFront();\n        }\n        if (typeof flowGroup !== 'undefined') {\n          flowGroup.eachLayer(function(layer) {\n            if(layer.bringToFront) {\n              layer.bringToFront();\n            } else {\n              layer.eachLayer(function(sublayer){\n                sublayer.bringToFront();\n              });\n            }\n          });\n        }\n      }\n    });\n    // make layers clickable\n    if(layer.eachLayer) {\n      layer.eachLayer(function(sublayer) {\n        L.Util.setOptions(sublayer, {clickable: true});\n      })\n    } else {\n      L.Util.setOptions(layer, {clickable: true});\n    }\n\n  }\n}\n\n\nfunction notClickable(feature, layer) {\n-    //public\n-    // Funktioniert leider nicht zuverlaessig auf allen shapes\n    L.Util.setOptions(layer, {clickable: false});\n}\n\n\nfunction click(e) {\n  //private\n  var layer = e.target;\n  var specialTooltip = window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltip;\n  var specialTooltipLinks = window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltipLinks;\n  var teaserText;\n  if (specialTooltip == 'export-restrictions-main') {\n    teaserText = mapTeaserExportRestrictionsMain(layer.feature.properties[mapCode]);\n  } else if (specialTooltip == 'export-restrictions') {\n    teaserText = mapTeaserExportRestrictions(layer.feature.properties[mapCode]);\n  } else if (specialTooltip == 'ifi-country-data') {\n    teaserText = mapTeaserIfiCountryData(layer.feature.properties[mapCode], specialTooltipLinks);\n  } else if (window.bubbleMap == 'multiColored') {\n    teaserText = mapTeaserTextMulti(layer.feature.properties[mapCode]);\n  } else {\n    teaserText = mapTeaserText(layer.feature.properties[mapCode]);\n  }\n  if (themeURL == 'ecb' || $.inArray(layer.feature.properties[mapCode].toString().toLowerCase(), MapGroup) > -1) {\n    popup.setLatLng(e.latlng);\n    popup.setContent(teaserText);\n    if (!popup._map) popup.openOn(mapdataviz);\n  }\n}\n\n\nfunction popupLoop(countryISO) {\n  //public\n  var teaserText = mapTeaserText(countryISO);\n  popup.setLatLng([Centroides[countryISO]['Lat'], Centroides[countryISO]['Long']]);\n  mapdataviz.setView([Centroides[countryISO]['Lat'], Centroides[countryISO]['Long']], 2);\n  popup.setContent(teaserText);\n  if (!popup._map) popup.openOn(mapdataviz);\n\n}\n\n","\nfunction mapTeaserExportRestrictions(country) {\n\n//global vars\n//  lang_labels\n//  DataforMap\n//  lang\n\n  var labels2 = {};\n\n  labels2['en'] = {\n\t\t1:'export prohibition',\n\t\t2:'export quota',\n\t\t3:'export tax',\n\t\t4:'non-automatic licencing',\n\t\t5:'other measures',\n\t\t6:'no restrictions',\n    undefined:'not reseached'\n\t};\n\n  labels2['cn'] = {\n    1:'',\n    2:'',\n    3:'',\n    4:'',\n    5:'',\n    6:'',\n    undefined:''\n  };\n\n  var teaserTitleStart = '<h3 class=\"tooltipTitle\">';\n  var teaserTitleEnd = '</h3>';\n  var teaserTableStart = '<table class=\"tooltipTable\">';\n  var teaserTableLineCenter = '</td><td  class=\"tooltipData\">';\n  var teaserTableEnd = '</td></tr></table>';\n\n  var countryProfile = \"<div class='countryProfilLink'>\"+\n          \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n          \"</div>\";\n\n  var countryName = lang_countries[country.toLowerCase()]+' - '+DataforMap[mapLayerIndex]['title'];\n\n  var tableLines;\n  var tableLine = [];\n\n  if (DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]) {\n    tableLine[0] =  \"<tr>\"+\n                      \"<td>\"+DataforMap[mapLayerIndex]['options']['tooltipUnit']+\":</td>\"+\n                      \"<td class='tooltipData'>\"+getHumanReadData(DataforMap[mapLayerIndex]['values'][country][1])+\" \"+DataforMap[mapLayerIndex]['unit']+\"</td>\"+\n                    \"</tr>\";\n    tableLine[1] =  \"<tr>\"+\n                      \"<td>\"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['options']['tooltipUnit']+\":</td>\"+\n                      \"<td class='tooltipData'>\"+labels2[lang][DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['values'][country][1]]+\"</td>\"+\n                    \"</tr>\";\n  } else {\n    tableLine[0] =  \"<tr>\"+\n                      \"<td>\"+DataforMap[mapLayerIndex]['options']['tooltipUnit']+\":</td>\"+\n                      \"<td class='tooltipData'>\"+labels2[lang][DataforMap[mapLayerIndex]['values'][country][1]]+\"</td>\"+\n                    \"</tr>\";\n    tableLine[1] = \"<tr><td></td><td></td></tr>\";\n  }\n\n  tableLines = tableLine[0]+tableLine[1];\n\n  return '' +\n    teaserTitleStart +\n    countryName +\n    teaserTitleEnd +\n    teaserTableStart +\n    tableLines +\n    teaserTableEnd +\n    countryProfile + '';\n}\n\n\n","\nfunction mapTeaserExportRestrictionsMain(country) {\n\n  var labels2 = {};\n\n  labels2['en'] = {\n\t\t1:'export prohibition',\n\t\t2:'export quota',\n\t\t3:'export tax',\n\t\t4:'non-automatic licencing',\n\t\t5:'other measures',\n\t\t6:'no restrictions',\n    undefined:'not reseached'\n\t};\n\n  labels2['cn'] = {\n    1:'',\n    2:'',\n    3:'',\n    4:'',\n    5:'',\n    6:'',\n    undefined:''\n  };\n\n  var teaserTitleStart = '<h3 class=\"tooltipTitle\">';\n  var teaserTitleEnd = '</h3>';\n  var teaserTableStart = '<table class=\"tooltipTable\">';\n  var teaserTableLineCenter = '</td><td  class=\"tooltipData\">';\n  var teaserTableEnd = '</td></tr></table>';\n\n  var countryProfile = \"<div class='countryProfilLink'>\"+\n          \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n          \"</div>\";\n\n  var countryName = lang_countries[country.toLowerCase()];\n\n  var tableLineCanvas = [];\n  var tooltipData = [];\n  var tableLines;\n\n  tableLineCanvas[0] = \"<tr><td title='\" + DataforMap[0]['definition'] + \"'>\" + DataforMap[0]['title'] + \":</td><td class='tooltipData'>\";\n  tooltipData[0] = labels2[lang][DataforMap[0]['values'][country][1]];\n  tableLines = tableLineCanvas[0]+tooltipData[0];\n\n  return '' +\n    teaserTitleStart +\n    countryName +\n    teaserTitleEnd +\n    teaserTableStart +\n    tableLines +\n    teaserTableEnd +\n    countryProfile + '';\n}\n\n\n","function mapTeaserIfiCountryData(country, links) {\n  // private\n\n  var teaser = $('<div>');\n  var teaserTitle = $('<h3 class=\"tooltipTitle\">');\n  var teaserTable = $('<table class=\"tooltipTable\">');\n  teaser.append(teaserTitle);\n\n  var link = links[country.toString().toLowerCase()];\n  if (link != null) {\n    var countryProfile = $('<div style=\"text-align: center;\">')\n      .append($('<a target=\"_blank\">')\n                .attr('href', link)\n                .text(lang_labels.countryProfile));\n    teaser.append(countryProfile);\n  }\n\n  var countryName = lang_countries[country.toString().toLowerCase()] || country;\n  teaserTitle.text(countryName);\n\n  var tableLineCanvas;\n  var tooltipData;\n  var dataValue;\n  var hasData = false;\n  var unit;\n\n  for (var i = 0; i < ChartsWithData; i++) {\n    if (DataforMap[i] != null) {\n      tableLineCanvas = $('<tr>')\n        .append($('<td>')\n                  .attr('title', $('<div>').html(DataforMap[i]['definition']).text())\n                  .html(DataforMap[i]['title']));\n\n      tooltipData = $('<td class=\"tooltipData\">');\n      tableLineCanvas.append(tooltipData);\n\n      if (DataforMap[i]['values'][country] != undefined && DataforMap[i]['values'][country][1] != null) {\n        hasData = true;\n        dataValue = getHumanReadData(DataforMap[i]['values'][country][1], DataforMap[i]['options']['tooltipDecimals']);\n        unit = DataforMap[i]['options']['tooltipUnit'] || '';\n        if (unit !== '') {\n          dataValue += '&nbsp;' + unit;\n        }\n        if (DataforMap[i]['values'][country][0] != DataforMap[i]['latestYear']) {\n          dataValue += '&nbsp;(' + DataforMap[i]['values'][country][0] + ')';\n        }\n        tooltipData.html(dataValue);\n      } else {\n        tooltipData.text('\\u2014'); // EM DASH\n      }\n      teaserTable.append(tableLineCanvas);\n    }\n  }\n\n  teaserTitle.after(teaserTable);\n\n  // return first DOM element in jQuery object\n  return teaser[0];\n}\n","function mapTeaserText(country) {\n  // private\n\n  var euGroup = [ 'aut', 'bel', 'bgr', 'cyp', 'deu', 'dnk', 'esp', 'fin',\n                  'fra', 'gbr', 'grc', 'hrv', 'irl', 'ita', 'lux', 'lva',\n                  'ltu', 'mlt', 'nld', 'prt', 'swe', 'cze', 'est', 'hun',\n                  'pol', 'svk', 'svn', 'rou'];\n\n  var teaser = $('<div>');\n  var teaserTitle = $('<h3 class=\"tooltipTitle\">');\n  var teaserTable = $('<table class=\"tooltipTable\">');\n  teaser.append(teaserTitle);\n\n  var countryProfile = $('<div class=\"countryProfilLink\">')\n    .append($('<span id=\"countryProfileMap\">')\n              .attr('value', country)\n              .html(lang_labels.countryProfile));\n  if (typeof wizardConfig !== 'undefined' && wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes == 'withEU' && $.inArray(country.toString().toLowerCase(), euGroup) > -1) {\n    countryProfile.append('<span value=\"eu\" id=\"euProfileMap\">view EU profile</span>');\n  }\n  teaser.append(countryProfile);\n\n  var countryName = lang_countries[country.toString().toLowerCase()] || ISO3toFlags[country] || country;\n  teaserTitle.text(countryName);\n\n  var tableLineCanvas;\n  var tooltipData;\n  var dataValue;\n  var hasData = false;\n\n  for (var i = 0; i < ChartsWithData; i++) {\n    if (DataforMap[i] != null) {\n      tableLineCanvas = $('<tr>')\n        .append($('<td>')\n                  .attr('title', $('<div>').html(DataforMap[i]['definition']).text())\n                  .html(DataforMap[i]['title']));\n\n      tooltipData = $('<td class=\"tooltipData\">');\n      tableLineCanvas.append(tooltipData);\n\n      if (DataforMap[i]['values'][country] != undefined && DataforMap[i]['values'][country][1] != null) {\n        hasData = true;\n        dataValue = getHumanReadData(DataforMap[i]['values'][country][1], DataforMap[i]['options']['tooltipDecimals']) + '&nbsp;' + DataforMap[i]['options']['tooltipUnit'];\n        if (DataforMap[i]['values'][country][0] != DataforMap[i]['latestYear']) {\n          dataValue += '&nbsp;(' + DataforMap[i]['values'][country][0] + ')';\n        }\n        tooltipData.html(dataValue);\n      } else {\n        tooltipData.text('\\u2014'); // EM DASH\n      }\n      teaserTable.append(tableLineCanvas);\n    }\n  }\n\n  if (hasData || themeURL != 'ecb') {\n    teaserTitle.after(teaserTable);\n  }\n\n  // return first DOM element in jQuery object\n  return teaser[0];\n}\n","\n\nfunction mapTeaserTextMulti(country) {\n  //private\n\n  var euGroup = [ 'aut', 'bel', 'bgr', 'cyp', 'deu', 'dnk', 'esp', 'fin',\n                  'fra', 'gbr', 'grc', 'hrv', 'irl', 'ita', 'lux', 'lva',\n                  'ltu', 'mlt', 'nld', 'prt', 'swe', 'cze', 'est', 'hun',\n                  'pol', 'svk', 'svn', 'rou'];\n\n  var teaserTitleStart = '<h3 class=\"tooltipTitle\">';\n  var teaserTitleEnd = '</h3>';\n  var teaserTableStart = '<table class=\"tooltipTable\">';\n  var teaserTableLineCenter = '</td><td  class=\"tooltipData\">';\n  var teaserTableEnd = '</td></tr></table>';\n\n  if (typeof wizardConfig !== 'undefined' && wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes == 'withEU' && $.inArray(country.toString().toLowerCase(), euGroup) > -1) {\n    var countryProfile = \"<div class='countryProfilLink'>\"+\n            \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n            \"\"+\n            \"<span value='eu' id='euProfileMap' >view EU profile</span>\"+\n            \"</div>\";\n  } else {\n    var countryProfile = \"<div class='countryProfilLink'>\"+\n            \"<span value='\"+country+\"' id='countryProfileMap'>\"+lang_labels.countryProfile+\"</span>\"+\n            \"</div>\";\n  }\n\n\n  if (lang_countries[country.toString().toLowerCase()] != null) {\n    var countryName = lang_countries[country.toString().toLowerCase()]+' - '+DataforMap[mapLayerIndex]['title'];\n  } else {\n    var countryName = country+' - '+DataforMap[mapLayerIndex]['title'];\n  }\n\n  var tableLines;\n  var tableLine = [];\n\n  tableLine[0] =  \"<tr>\"+\n                    \"<td>\"+DataforMap[mapLayerIndex]['options']['tooltipUnit']+\"</td>\"+\n                    \"<td class='tooltipData'>\"+getHumanReadData(DataforMap[mapLayerIndex]['values'][country][1])+\"</td>\"+\n                  \"</tr>\";\n\n  if (DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]) {\n    tableLine[1] =  \"<tr>\"+\n                      \"<td>\"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['options']['tooltipUnit']+\"</td>\"+\n                      \"<td class='tooltipData'>\"+getHumanReadData(DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]['values'][country][1])+\"</td>\"+\n                    \"</tr>\";\n  } else {\n    tableLine[1] = \"<tr><td></td><td></td></tr>\";\n  }\n\n  tableLines = tableLine[0]+tableLine[1];\n\n  return '' +\n    teaserTitleStart +\n    countryName +\n    teaserTitleEnd +\n    teaserTableStart +\n    tableLines +\n    teaserTableEnd +\n    countryProfile + '';\n}\n\n\n"]}