function filterLocation(d,filter){var parseFilter=[];$.each(filter,function(k,v){parseFilter.push(v.toUpperCase())});var newData={};return newData.title=d.title,newData.definition=d.definition,newData.options=d.options,newData.data={},newData.data.dimensions=d.data.dimensions,newData.data.keys=[],newData.data.keys[0]=[],newData.data.keys[1]=d.data.keys[1],newData.data.data=[],$.each(d.data.keys[0],function(key,value){if($.inArray(value.toUpperCase(),parseFilter)>-1){newData.data.keys[0].push(value.toUpperCase());var a=d.data.keys[0].indexOf(value);newData.data.data.push(d.data.data[a])}}),newData}function filterYear(d,filter){var newData={};newData.title=d.title,newData.definition=d.definition,newData.options=d.options,newData.data={},newData.data.dimensions=d.data.dimensions,newData.data.keys=[],newData.data.keys[0]=d.data.keys[0],newData.data.keys[1]=[],newData.data.data=[];var idxYear=[];return $.each(filter,function(key,value){idxYear.push(d.data.keys[1].indexOf(value)),newData.data.keys[1].push(value)}),$.each(newData.data.keys[0],function(key,cr){newData.data.data[key]=[],$.each(idxYear,function(yKey,value){newData.data.data[key].push(d.data.data[key][value])})}),newData}function flipData(d){var r={keys:d.keys.slice(0),dimensions:d.dimensions.slice(0)};return r.keys.reverse(),r.dimensions.reverse(),r.data=r.keys[0].map(function(k,i0){return r.keys[1].map(function(k,i1){return d.data[i1][i0]})}),r}function getHumanReadData(number,decimals,trimZeros){function decimalAdjust(type,value,exp){return void 0===exp||0==+exp?Math[type](value):(value=+value,exp=+exp,isNaN(value)||"number"!=typeof exp||exp%1!=0?NaN:(value=value.toString().split("e"),value=Math[type](+(value[0]+"e"+(value[1]?+value[1]-exp:-exp))),value=value.toString().split("e"),+(value[0]+"e"+(value[1]?+value[1]+exp:exp))))}function toFixed(number,decimals){var s=decimalAdjust("round",number,-decimals).toFixed(decimals);return trimZeros?s.replace(/\.0+$|(\..*?)0+$/,"$1"):s}if(void 0===decimals&&(decimals=0),decimals<0)return number;number=parseFloat(number);var abs=Math.abs(number);return abs>1e12?toFixed(number/1e12,decimals)+"&nbsp;"+window.lang_labels.trillion:abs>1e9?toFixed(number/1e9,decimals)+"&nbsp;"+window.lang_labels.billion:abs>1e6?toFixed(number/1e6,decimals)+"&nbsp;"+window.lang_labels.million:abs>1e5?toFixed(number/1e3,decimals)+"&nbsp;"+window.lang_labels.thousand:function(val){for(;/(\d+)(\d{3})/.test(val.toString());)val=val.toString().replace(/(\d+)(\d{3})/,"$1 $2");return val}(toFixed(number,decimals))}function sortDimension0(d,key1,desc){desc=desc||!0;var r={dimensions:d.dimensions,keys:d.keys.slice(0)},sorted=d.data.map(function(v,i){return{v:v,i:i}});return sorted.sort(function(a,b){return a.v[key1]==b.v[key1]?0:null==a.v[key1]?1:null==b.v[key1]?-1:a.v[key1]<b.v[key1]!=desc?-1:1}),r.data=sorted.map(function(v){return v.v}),r.keys[0]=sorted.map(function(v){return d.keys[0][v.i]}),r}function sortDimension0sum(d,desc){function add(a,b){return null==a?b:null==b?a:a+b}desc=desc||!0;var r={dimensions:d.dimensions,keys:d.keys.slice(0)},sorted=d.data.map(function(v,i){return{v:v,i:i}});return sorted.sort(function(a,b){return a.v.reduce(add,0)==b.v.reduce(add,0)?0:a.v.reduce(add,0)<b.v.reduce(add,0)!=desc?-1:1}),r.data=sorted.map(function(v){return v.v}),r.keys[0]=sorted.map(function(v){return d.keys[0][v.i]}),r}function sortDimension1(d,key0,desc){desc=desc||!0;var r={dimensions:d.dimensions,keys:d.keys.slice(0)},sorted=d.data[key0].map(function(v,i){return{v:v,i:i}});return sorted.sort(function(a,b){return a.v==b.v?0:null==a.v?1:null==b.v?-1:a.v<b.v!=desc?-1:1}),r.data=d.data.map(function(l){return sorted.map(function(v){return l[v.i]})}),r.keys[1]=sorted.map(function(v){return d.keys[1][v.i]}),r}function getChartWithLabels(d,lang_countries){var newData={};return newData.options=d.options,newData.title=d.title,newData.definition=d.definition,newData.data={},newData.data.dimensions=d.data.dimensions,newData.data.data=d.data.data,newData.data.keys=[],newData.data.keys[0]=[],newData.data.keys[1]=[],$.each(d.data.keys[0],function(key,val){val.toLowerCase()in lang_countries?newData.data.keys[0][key]=lang_countries[val.toLowerCase()]:newData.data.keys[0][key]=val}),$.each(d.data.keys[1],function(key,val){val.toLowerCase()in lang_countries?newData.data.keys[1][key]=lang_countries[val.toLowerCase()]:newData.data.keys[1][key]=val}),newData}function getMaxCountries(height,chart,urlQuery,lang){var countryPreSelect={en:["OECD","USA","JPN","DEU","FRA","GBR","ITA","CAN","CHN","AUS","AUT","BEL","BRA","CHE","CHL","CZE","DNK","ESP","EST","FIN","GRC","HUN","IDN","IND","IRL","ISL","ISR","KOR","LUX","MEX","NLD","NOR","NZL","POL","PRT","RUS","SVK","SVN","SWE","TUR","ZAF"],fr:["OECD","USA","JPN","DEU","FRA","BEL","CAN","GBR","ITA","CHN","AUS","AUT","BRA","CHE","CHL","CZE","DNK","ESP","EST","FIN","GRC","HUN","IDN","IND","IRL","ISL","ISR","KOR","LUX","MEX","NLD","NOR","NZL","POL","PRT","RUS","SVK","SVN","SWE","TUR","ZAF"],de:["OECD","DEU","AUT","CHE","USA","JPN","FRA","GBR","ITA","CAN","CHN","AUS","BEL","BRA","CHL","CZE","DNK","ESP","EST","FIN","GRC","HUN","IDN","IND","IRL","ISL","ISR","KOR","LUX","MEX","NLD","NOR","NZL","POL","PRT","RUS","SVK","SVN","SWE","TUR","ZAF"],es:["OECD","MEX","ESP","CHL","USA","JPN","DEU","FRA","GBR","ITA","CAN","CHN","AUS","AUT","BEL","BRA","CHE","CZE","DNK","EST","FIN","GRC","HUN","IDN","IND","IRL","ISL","ISR","KOR","LUX","NLD","NOR","NZL","POL","PRT","RUS","SVK","SVN","SWE","TUR","ZAF"],jp:["OECD","USA","JPN","DEU","FRA","GBR","ITA","CAN","CHN","AUS","AUT","BEL","BRA","CHE","CHL","CZE","DNK","ESP","EST","FIN","GRC","HUN","IDN","IND","IRL","ISL","ISR","KOR","LUX","MEX","NLD","NOR","NZL","POL","PRT","RUS","SVK","SVN","SWE","TUR","ZAF"]},countriesOnChart=Math.round(height/30),dataKeys=[];maxCountriesOnChart=0,$.each(chart.data.keys[0],function(k,v){dataKeys.push(v.toUpperCase())});var selectedCountries=[];if(lang in countryPreSelect||(countryPreSelect[lang]=[]),void 0!=urlQuery.lc&&"undefined"!=urlQuery.lc){var newCountries=urlQuery.lc.split("+");$.each(newCountries,function(k,v){$.inArray(v.toUpperCase(),dataKeys)>-1&&(countryPreSelect[lang].unshift(v.toUpperCase()),maxCountriesOnChart+=1)})}if(maxCountriesOnChart>0&&maxCountriesOnChart<countriesOnChart&&(countriesOnChart=maxCountriesOnChart),$.each(countryPreSelect[lang],function(k,v){$.inArray(v,dataKeys)>-1&&selectedCountries.push(v)}),$.each(dataKeys,function(k,v){-1==$.inArray(v,countryPreSelect[lang])&&selectedCountries.push(v.toUpperCase())}),selectedCountries=selectedCountries.slice(0,countriesOnChart),1==function(dataKeys){var allLabelsCountries=!0;return $.each(dataKeys,function(k,v){v.toLowerCase()in window.lang_countries||(allLabelsCountries=!1)}),allLabelsCountries}(dataKeys))var values=filterLocation(chart,selectedCountries);else var values=chart;return values}function ChartElement(){var chart,self=this;self.loadChart=function(data,options){var newChart=new chartBasis(data,options);newChart.loadData(),chart=newChart},self.displayCharts=function(container){chart.displayChart(container)}}function chartBasis(data,options){var self=this,loadedData={},defaults={highcharts:{chart:{backgroundColor:"transparent"},plotOptions:{series:{marker:{enabled:!1,states:{hover:{enabled:!0}}},pointPadding:0,borderWidth:0,connectNulls:!0}},exporting:{enabled:!1},legend:{enabled:!1},credits:{enabled:!1},title:{text:null},xAxis:{labels:{step:1,style:{fontSize:"1em"}}},yAxis:{title:{text:null}}},CYCoptions:{typeOfFirstSeries:null}};options=$.extend(!0,defaults,options),self.loadData=function(){var Data=[],categories=data.keys[1];$.each(data.keys[0],function(index,name){var dataPoints=data.data[index].map(function(y,i){return null!=y?{y:parseFloat(y.toFixed(options.CYCoptions.decimals)),id:categories[i],name:categories[i]}:{y:null,id:categories[i]}});Data.push({name:name,data:dataPoints})}),null!=options.CYCoptions.typeOfFirstSeries&&(Data[0].type=options.CYCoptions.typeOfFirstSeries),loadedData={cats:categories,series:Data}},self.displayChart=function(container){var data=loadedData;if(null==data)return!1;var seriesOptions={chart:{renderTo:container},xAxis:{categories:data.cats},series:data.series};return options.highcharts=$.extend(!0,options.highcharts,seriesOptions),new Highcharts.Chart(options.highcharts),!0}}function labelFormat(translatedLables){return function(){if(this.value.toUpperCase()in window.ISO3toFlags){var flag='<img  style="margin-bottom:4px" height=18px src="'+baseURL+"/flags.png?cr="+this.value.toUpperCase()+'">';return'<span style="margin-right:5px" >'+translatedLables[this.value.toLowerCase()]+"</span>"+flag}return void 0!=translatedLables[this.value.toLowerCase()]?'<span style="margin-right:5px" >'+translatedLables[this.value.toLowerCase()]+"</span>":'<span style="margin-right:5px" >'+this.value.toLowerCase()+"</span>"}}function tooltipFormat(values,translatedLables){return function(){if(void 0!=translatedLables[this.x.toLowerCase()])var s="<b>"+translatedLables[this.x.toLowerCase()]+"</b>";else var s="<b>"+this.x+"</b>";return $.each(this.points,function(){s+="<br/>"+this.series.name+": "+this.y+" "+values.options.tooltipUnit}),s}}function addLineChart(values,container){if(Highcharts.setOptions({lang:{numericSymbols:null}}),void 0!=values.data.data[0]){var sbars=new ChartElement;!function(){sbars.loadChart(values.data,{highcharts:{chart:{type:"line"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:10},plotOptions:{series:{markers:{enabled:!1,states:{hover:{enabled:!0}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{reversed:!0,tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"},colors:["#de3a07","#408000","#dca2bf","#fdd14e","#730000","#ffa640","#234010","#6cc3d9","#4400ff","#f200a2","#750039","#33260d","#00e61f","#0099e6","#1f0073","#962c0b","#734939","#735c00","#00f2a2","#004996"]},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}}function addLineStackedBarChart(values,container){if(void 0!=values.data.data[0]){var sbars=new ChartElement;!function(){sbars.loadChart(values.data,{highcharts:{chart:{type:"column"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{area:{stacking:"normal"},bar:{stacking:"normal"},column:{stacking:"normal"},series:{markers:{enabled:!1,states:{hover:{enabled:!0}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals,typeOfFirstSeries:values.options.typeOfFirstSeries||"line"}}),sbars.displayCharts(container)}()}}function addStackedAreaChart(values,container){if(void 0!=values.data.data[0]){var sbars=new ChartElement;!function(){sbars.loadChart(values.data,{highcharts:{chart:{type:"area"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{area:{stacking:"normal"},series:{markers:{enabled:!1,states:{hover:{enabled:!0}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}}function addBarChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:10},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:!0,overflow:"none",crop:!1,allowOverlap:!0}}},yAxis:{labels:{enabled:!1},gridLineWidth:0,min:values.options.minimum,max:values.options.maximum},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addBarChartFlag(values,container,translatedLabels){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:10,marginLeft:150},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:!0,overflow:"none",crop:!1,allowOverlap:!0}}},yAxis:{labels:{enabled:!1},gridLineWidth:0,min:values.options.minimum,max:values.options.maximum},xAxis:{labels:{useHTML:!0,formatter:labelFormat(translatedLabels)}},tooltip:{shared:!0,useHTML:!0,formatter:tooltipFormat(values,translatedLabels)}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addColumnChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"column"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:!1,overflow:"none",crop:!1,allowOverlap:!0}}},yAxis:{min:values.options.minimum,max:values.options.maximum},colors:["#88b60f","#232323"],tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addBarsDiamondsChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"line",marginBottom:20},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{marker:{enabled:!0},lineWidth:0,states:{hover:{lineWidth:0,lineWidthPlus:0}}}},yAxis:{min:values.options.minimum,max:values.options.maximum},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{typeOfFirstSeries:"bar",decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addStackedColumnChart(values,container){var sbars=new ChartElement;!function(){sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"column"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{labels:{step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addStackedBarChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0sum(values.data,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:20},legend:{enabled:!0,reversed:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addPyramidRight(values,container){var sbars=new ChartElement;!function(){sbars.loadChart(flipData(values.data),{highcharts:{title:{text:"Men"},chart:{type:"bar"},legend:{enabled:!0,reversed:!0,verticalAlign:"bottom",padding:5,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"},series:{animation:!1}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{opposite:!0},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addPyramidLeft(values,container){var sbars=new ChartElement;!function(){sbars.loadChart(flipData(values.data),{highcharts:{title:{text:"Women"},chart:{type:"bar"},legend:{enabled:!0,reversed:!0,verticalAlign:"bottom",padding:5,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"},series:{animation:!1}},xAxis:{},yAxis:{min:values.options.minimum,max:values.options.maximum,reversed:!0},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}var height="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,width="innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth;$(document).ready(function(){var config=wizardConfig;$(".simpleChartHeight").css({height:height-2});var tab=config.project.tabs[0],displayChart=config.tabs[config.project.tabs[0]].charts[0];void 0!=urlQuery.chart&&"undefined"!=urlQuery.chart&&"null"!=urlQuery.chart&&(displayChart=urlQuery.chart);var values=config.charts[displayChart],color="#852780";if(void 0!=urlQuery.color&&"undefined"!=urlQuery.color&&("blue"==urlQuery.color?color="#04629a":"green"==urlQuery.color?color="#8cc841":"red"==urlQuery.color&&(color="#CD351c")),$("header").css({"background-color":color}),$("body").css({"border-color":color}),void 0!=urlQuery.yr&&"undefined"!=urlQuery.yr){values=filterYear(values,urlQuery.yr.split("+"))}var tabLabels=config.tabs[tab].labels,translatedLabels=window.lang_countries;tabLabels&&$.each(tabLabels,function(key,value){translatedLabels[key.toLowerCase()]=value[lang]});var labelValues=getChartWithLabels(values,translatedLabels);"sbardiamond"==urlQuery.template?addBarsDiamondsChart(labelValues,"container"):"sstackedcolumn"==urlQuery.template?addStackedColumnChart(labelValues,"container"):"sstackedbar"==urlQuery.template?addStackedBarChart(labelValues,"container"):"slines"==urlQuery.template?(labelValues.data.keys[1]=labelValues.data.keys[1].map(function(y){return y.substring(5,7)+" "+y.substring(0,4)}),addLineChart(labelValues,"container"),Highcharts.charts[0].series.forEach(function(s){translatedLabels.eur!==s.name&&s.setVisible(!1,!1)}),Highcharts.charts[0].redraw()):"sbarflags"==urlQuery.template?addBarChartFlag(values,"container",translatedLabels):addBarChart(labelValues,"container")});var urlQuery=function(){for(var query_string={},query=window.location.search.substring(1),vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(void 0===query_string[pair[0]])query_string[pair[0]]=decodeURIComponent(pair[1]);else if("string"==typeof query_string[pair[0]]){var arr=[query_string[pair[0]],decodeURIComponent(pair[1])];query_string[pair[0]]=arr}else query_string[pair[0]].push(decodeURIComponent(pair[1]))}return query_string}();
//# sourceMappingURL=simple.js.map