function filterLocation(d,filter){var parseFilter=[];$.each(filter,function(k,v){parseFilter.push(v.toUpperCase())});var newData={};newData["title"]=d.title;newData["definition"]=d.definition;newData["options"]=d.options;newData["data"]={};newData.data["dimensions"]=d.data.dimensions;newData.data["keys"]=[];newData.data["keys"][0]=[];newData.data["keys"][1]=d.data.keys[1];newData.data["data"]=[];$.each(d.data.keys[0],function(key,value){if($.inArray(value.toUpperCase(),parseFilter)>-1){newData.data.keys[0].push(value.toUpperCase());var a=d.data.keys[0].indexOf(value);newData.data.data.push(d.data.data[a])}});return newData}function filterYear(d,filter){var newData={};newData["title"]=d.title;newData["definition"]=d.definition;newData["options"]=d.options;newData["data"]={};newData.data["dimensions"]=d.data.dimensions;newData.data["keys"]=[];newData.data["keys"][0]=d.data.keys[0];newData.data["keys"][1]=[];newData.data["data"]=[];var idxYear=[];$.each(filter,function(key,value){idxYear.push(d.data.keys[1].indexOf(value));newData.data.keys[1].push(value)});$.each(newData.data.keys[0],function(key,cr){newData.data.data[key]=[];$.each(idxYear,function(yKey,value){newData.data.data[key].push(d.data.data[key][value])})});return newData}function flipData(d){var r={keys:d.keys.slice(0),dimensions:d.dimensions.slice(0)};r.keys.reverse();r.dimensions.reverse();r.data=r.keys[0].map(function(k,i0){return r.keys[1].map(function(k,i1){return d.data[i1][i0]})});return r}function getHumanReadData(number,decimals,trimZeros){if(decimals===undefined){decimals=0}if(decimals<0){return number}number=parseFloat(number);var abs=Math.abs(number);function decimalAdjust(type,value,exp){if(typeof exp==="undefined"||+exp===0){return Math[type](value)}value=+value;exp=+exp;if(isNaN(value)||!(typeof exp==="number"&&exp%1===0)){return NaN}value=value.toString().split("e");value=Math[type](+(value[0]+"e"+(value[1]?+value[1]-exp:-exp)));value=value.toString().split("e");return+(value[0]+"e"+(value[1]?+value[1]+exp:exp))}function toFixed(number,decimals){var s=decimalAdjust("round",number,-decimals).toFixed(decimals);return trimZeros?s.replace(/\.0+$|(\..*?)0+$/,"$1"):s}function spaceSeparateNumber(val){while(/(\d+)(\d{3})/.test(val.toString())){val=val.toString().replace(/(\d+)(\d{3})/,"$1"+" "+"$2")}return val}function commaSeparateNumber(val){while(/(\d+)(\d{3})/.test(val.toString())){val=val.toString().replace(/(\d+)(\d{3})/,"$1"+","+"$2")}return val}if(abs>1e12){return toFixed(number/1e12,decimals)+"&nbsp;"+window.lang_labels["trillion"]}else if(abs>1e9){return toFixed(number/1e9,decimals)+"&nbsp;"+window.lang_labels["billion"]}else if(abs>1e6){return toFixed(number/1e6,decimals)+"&nbsp;"+window.lang_labels["million"]}else if(abs>1e5){return toFixed(number/1e3,decimals)+"&nbsp;"+window.lang_labels["thousand"]}else{return spaceSeparateNumber(toFixed(number,decimals))}}function sortDimension0(d,key1,desc){desc=desc||true;var r={dimensions:d.dimensions,keys:d.keys.slice(0)};var sorted=d.data.map(function(v,i){return{v:v,i:i}});sorted.sort(function(a,b){return a.v[key1]==b.v[key1]?0:a.v[key1]==null?1:b.v[key1]==null?-1:a.v[key1]<b.v[key1]!=desc?-1:1});r.data=sorted.map(function(v){return v.v});r.keys[0]=sorted.map(function(v){return d.keys[0][v.i]});return r}function sortDimension0sum(d,desc){function add(a,b){return a==null?b:b==null?a:a+b}desc=desc||true;var r={dimensions:d.dimensions,keys:d.keys.slice(0)};var sorted=d.data.map(function(v,i){return{v:v,i:i}});sorted.sort(function(a,b){return a.v.reduce(add,0)==b.v.reduce(add,0)?0:a.v.reduce(add,0)<b.v.reduce(add,0)!=desc?-1:1});r.data=sorted.map(function(v){return v.v});r.keys[0]=sorted.map(function(v){return d.keys[0][v.i]});return r}function sortDimension1(d,key0,desc){desc=desc||true;var r={dimensions:d.dimensions,keys:d.keys.slice(0)};var sorted=d.data[key0].map(function(v,i){return{v:v,i:i}});sorted.sort(function(a,b){return a.v==b.v?0:a.v==null?1:b.v==null?-1:a.v<b.v!=desc?-1:1});r.data=d.data.map(function(l){return sorted.map(function(v){return l[v.i]})});r.keys[1]=sorted.map(function(v){return d.keys[1][v.i]});return r}function getLatestYearData(data){var newData={};var latestYear=data.keys[1].length-1;$.each(data.keys[0],function(key,value){newData[value]=[];while(data.data[data.keys[0].indexOf(value)][latestYear]==null&&latestYear>=0){latestYear=latestYear-1}newData[value][0]=data.keys[1][latestYear];newData[value][1]=data.data[data.keys[0].indexOf(value)][latestYear];latestYear=data.keys[1].length-1});return newData}function getTableData(data){var newData={};$.each(data.keys[1],function(key,value){newData[value]={};$.each(data.keys[0],function(k,v){newData[value][v]=data.data[data.keys[0].indexOf(v)][data.keys[1].indexOf(value)]})});return newData}function getMapData(wizardConfig,page,countrylist,Chart){var tab=wizardConfig.project.tabs[page];var mapType=wizardConfig.tabs[tab].mapType;var flowStatus=wizardConfig.tabs[tab].type;var ConfigProject=getPageCharts(wizardConfig,page);var DataforMap=[];var DataforMap1=[];var data={};data["defaultLayer"]=0;if(Chart!=null){data["defaultLayer"]=Math.max(0,wizardConfig.tabs[tab].charts.indexOf(Chart[0]))}if(mapType=="TwoIndicatorsSplitOnYears"){var labels=wizardConfig.tabs[tab].labels;var key=0;$.each(labels.order,function(order,value){if($.inArray(value,ConfigProject[0].data.keys[1])>-1){DataforMap[key]=filterYear(ConfigProject[0],[value]);if(labels.labels[value]){DataforMap[key]["title"]=labels.labels[value].name;DataforMap[key]["unit"]=labels.labels[value].unit}else{DataforMap[key]["title"]=value;DataforMap[key]["unit"]=""}DataforMap[key]["code"]=value;DataforMap[key]["definition"]=value;DataforMap[key]["values"]=getCountryData(getLatestYearData(DataforMap[key]["data"]),countrylist);if(ConfigProject[0].options.minimum&&ConfigProject[0].options.minimum!=null){DataforMap[key]["min"]=ConfigProject[0].options.minimum}else{DataforMap[key]["min"]=minValueLatest(DataforMap[key]["values"])}if(ConfigProject[0].options.maximum&&ConfigProject[0].options.maximum!=null){DataforMap[key]["max"]=ConfigProject[0].options.maximum}else{DataforMap[key]["max"]=maxValueLatest(DataforMap[key]["values"],1)}DataforMap[key]["latestYear"]=maxValueLatest(DataforMap[key]["values"],0);key++}});if(ConfigProject[1]!=null){$.each(ConfigProject[1].data.keys[1],function(key,value){DataforMap1[key]=filterYear(ConfigProject[1],[value]);if(labels.labels[value]){DataforMap1[key]["title"]=labels.labels[value].name}else{DataforMap1[key]["title"]=value}DataforMap1[key]["code"]=value;DataforMap1[key]["definition"]=value;DataforMap1[key]["values"]=getCountryData(getLatestYearData(DataforMap1[key]["data"]),countrylist);if(ConfigProject[1].options.minimum&&ConfigProject[1].options.minimum!=null){DataforMap1[key]["min"]=ConfigProject[1].options.minimum}else{DataforMap1[key]["min"]=minValueLatest(DataforMap1[key]["values"])}if(ConfigProject[1].options.maximum&&ConfigProject[1].options.maximum!=null){DataforMap1[key]["max"]=ConfigProject[1].options.maximum}else{DataforMap1[key]["max"]=maxValueLatest(DataforMap1[key]["values"],1)}DataforMap1[key]["latestYear"]=maxValueLatest(DataforMap1[key]["values"],0)})}}else{var i=0;$.each(ConfigProject,function(chart,values){if(values.type!="flow"){DataforMap[i]={};DataforMap[i]["colors"]=MapColors;DataforMap[i]["title"]=values["title"][lang];DataforMap[i]["definition"]=values["definition"][lang];DataforMap[i]["options"]=values["options"];DataforMap[i]["values"]=getCountryData(getLatestYearData(values["data"]),countrylist);if(DataforMap[i]["options"]["minimum"]&&DataforMap[i]["options"]["minimum"]!=null){DataforMap[i]["min"]=DataforMap[i]["options"]["minimum"]}else{DataforMap[i]["min"]=minValueLatest(DataforMap[i]["values"])}if(DataforMap[i]["options"]["maximum"]&&DataforMap[i]["options"]["maximum"]!=null){DataforMap[i]["max"]=DataforMap[i]["options"]["maximum"]}else{DataforMap[i]["max"]=maxValueLatest(DataforMap[i]["values"],1)}if(DataforMap[i]["options"]["mapDivergent"]){var dMax=Math.max(Math.abs(DataforMap[i]["min"]),Math.abs(DataforMap[i]["max"]));var dMin=-dMax;var minColor=quantize(DataforMap[i]["min"],dMin,dMax,DataforMap[i]["colors"].map(function(x,idx){return idx}));var maxColor=quantize(DataforMap[i]["max"],dMin,dMax,DataforMap[i]["colors"].map(function(x,idx){return idx}));if(minColor>0){dMin+=minColor*(dMax-dMin)/DataforMap[i]["colors"].length;DataforMap[i]["colors"]=DataforMap[i]["colors"].slice(minColor)}else if(maxColor+1<DataforMap[i]["colors"].length){dMax-=(DataforMap[i]["colors"].length-(maxColor+1))*(dMax-dMin)/DataforMap[i]["colors"].length;DataforMap[i]["colors"]=DataforMap[i]["colors"].slice(0,maxColor+1)}DataforMap[i]["max"]=dMax;DataforMap[i]["min"]=dMin}DataforMap[i]["latestYear"]=maxValueLatest(DataforMap[i]["values"],0);if("mapRegion"in DataforMap[i]["options"]){DataforMap[i]["values"][DataforMap[i]["options"]["mapRegion"]]=getLatestYearData(values["data"])[DataforMap[i]["options"]["mapRegion"]]}i=i+1}})}data["map"]=DataforMap;data["map1"]=DataforMap1;data["flow"]=flowStatus;function getPageCharts(wizardConfig,page){var tab=wizardConfig.project.tabs[page];var charts=wizardConfig.tabs[tab].charts;var pageCharts=[];$.each(charts,function(k,v){pageCharts.push(wizardConfig.charts[v])});return pageCharts}function minValue(series){var min=null;$.each(series,function(k,v){if(v==null)return;if(min==null)min=v;else if(min>v)min=v});return min}function maxValue(series){var max=null;$.each(series,function(k,v){if(v==null)return;if(max==null)max=v;else if(max<v)max=v});return max}function minValueLatest(series){var min=null;$.each(series,function(k,v){v=v[1];if(v==null)return;if(min==null)min=v;else if(min>v)min=v});return min}function maxValueLatest(series,arrayValue){var max=null;$.each(series,function(k,v){v=v[arrayValue];if(v==null)return;if(max==null)max=v;else if(max<v)max=v});return max}function getStandardDeviationWizard(series,value){var devVal=[];$.each(series,function(k,v){devVal.push(v[1])});var average=getAverageFromNumArr(devVal,2);var deviation=getStandardDeviation(devVal,2);if(value=="max"){return average+deviation}if(value=="min"){return average-deviation}else{return null}}function getCountryData(series,group){var data={};$.each(series,function(k,v){if($.inArray(k,group)>-1){data[k]=v}});return data}return data}function getIndicatorColorScale(d,dMin,dMax,feature,colors){if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1){return quantize(d,dMin,dMax,colors)}else{return landmass}}function quantize(d,dMin,dMax,range){function scaleToInteger(d,dMin,dMax,scaleMin,scaleMax){var i=Math.floor((d-dMin)/(dMax-dMin)*(scaleMax-scaleMin+1))+scaleMin;if(i<scaleMin)return scaleMin;if(i>scaleMax)return scaleMax;return i}return range[scaleToInteger(d,dMin,dMax,0,range.length-1)]}function getBubbleSize(d,dMax,feature){if(d==null||d<=0)return null;var radius=Math.sqrt(d/dMax)*25;if(radius<3)radius=3;return radius}function getDisputedLines(lines,group){var disputedLinesNew={type:"FeatureCollection",features:[]};if($.inArray("ind",group)>-1||$.inArray("chn",group)>-1||$.inArray("pak",group)>-1){$.each(lines.features,function(k,feature){if(feature.properties.SOVEREIGNT=="IndiaChinaPakistan"){disputedLinesNew["features"].push(feature)}})}if($.inArray("ind",group)>-1||$.inArray("chn",group)>-1){$.each(lines.features,function(k,feature){if(feature.properties.SOVEREIGNT=="IndiaChina"){disputedLinesNew["features"].push(feature)}})}if($.inArray("egy",group)>-1||$.inArray("sdn",group)>-1){$.each(lines.features,function(k,feature){if(feature.properties.SOVEREIGNT=="EgyptSudan"){disputedLinesNew["features"].push(feature)}})}if($.inArray("sdn",group)>-1||$.inArray("ssd",group)>-1){$.each(lines.features,function(k,feature){if(feature.properties.SOVEREIGNT=="Sudan"){disputedLinesNew["features"].push(feature)}})}if($.inArray("ken",group)>-1||$.inArray("som",group)>-1){$.each(lines.features,function(k,feature){if(feature.properties.SOVEREIGNT=="KenyaSom"){disputedLinesNew["features"].push(feature)}})}return disputedLinesNew}function getMapSubPoints(mapCentroides){if(themeURL=="ecb")return;var mapSubPoints={type:"FeatureCollection",features:[]};var smallIslands=["AND","ATG","AIA","ASM","ABW","ALA","BRB","BLM","BMU","BVT","CCK","COK","CPV","CUW","CXR","DMA","FLK","FSM","GRD","GGY","GIB","GLP","SGS","GUM","HKG","IMN","JEY","KIR","COM","KNA","CYM","LCA","LIE","MCO","MAF","MHL","MAC","MNP","MTQ","MSR","MLT","MUS","MDV","NFK","NRU","NIU","PYF","SPM","PCN","PRI","PLW","REU","SYC","SHN","SJM","SMR","STP","SXM","TCA","ATF","TKL","TON","TTO","TUV","VAT","VCT","VGB","VIR","WLF","WSM","MYT","ANT"];$(mapCentroides.features).each(function(feature){if($.inArray(this.properties[mapCode],smallIslands)>-1){mapSubPoints["features"].push(this)}});return mapSubPoints}function addMapLayers(bubbleMap,mapdataviz,flowStatus){var bubbles=[];var layers={};var layerName=[];if(bubbleMap=="multiColored"){L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:false}).addTo(mapdataviz);var i=0;var matchIndex=[];$.each(DataforMap,function(key,value){$.each(DataforMap1,function(key1,value1){if(value1.title==value.title){matchIndex[key]=key1+1}});if(matchIndex[key]){var colorIndicator=DataforMap1[matchIndex[key]-1]}else{var colorIndicator=null}bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSizeColorGeneric(value,colorIndicator),onEachFeature:highlightAndPopup});layerName[$("<div>").html(DataforMap[i]["title"]).text()]=bubbles[i];i++});bubbles[0].addTo(mapdataviz);updateMultiLegend(DataforMap[0],"size");updateMultiLegend(DataforMap1[matchIndex[0]-1],"color");window.mapLayerIndex=0;window.mapLayerMatchIndex=matchIndex;if(DataforMap.length>1){if($(window).width()<750){L.control.layers(layerName,null,{collapsed:true}).addTo(mapdataviz)}else{L.control.layers(layerName,null,{collapsed:false}).addTo(mapdataviz)}}$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();updateMultiLegend(DataforMap[index],"size");updateMultiLegend(DataforMap1[matchIndex[index]-1],"color");mapdataviz.closePopup();window.mapLayerIndex=index})}else if(bubbleMap=="colored"){L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:false}).addTo(mapdataviz);for(i=0;i<DataforMap.length-1;i++){bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSizeColorGeneric(DataforMap[0],DataforMap[i+1]),onEachFeature:highlightAndPopup});layerName[$("<div>").html(DataforMap[i+1]["title"]).text()]=bubbles[i]}bubbles[0].addTo(mapdataviz);updateLegend(DataforMap[0],"size");updateLegend(DataforMap[1],"color");if(DataforMap.length-1>1){if($(window).width()<750){L.control.layers(layerName,null,{collapsed:true}).addTo(mapdataviz)}else{L.control.layers(layerName,null,{collapsed:false}).addTo(mapdataviz)}}$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();updateLegend(DataforMap[index+1],"color")})}else if(bubbleMap=="coloredPairUnpair"){L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:false}).addTo(mapdataviz);for(i=0;i<DataforMap.length/2;i++){bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSizeColorGeneric(DataforMap[i*2],DataforMap[i*2+1]),onEachFeature:highlightAndPopup});layerName[$("<div>").html(DataforMap[i*2]["title"]).text()]=bubbles[i]}bubbles[0].addTo(mapdataviz);updateLegend(DataforMap[0],"size");updateLegend(DataforMap[1],"color");if(DataforMap.length-1>1){if($(window).width()<750){L.control.layers(layerName,null,{collapsed:true}).addTo(mapdataviz)}else{L.control.layers(layerName,null,{collapsed:false}).addTo(mapdataviz)}}$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();updateLegend(DataforMap[index*2],"size");updateLegend(DataforMap[index*2+1],"color")})}else if(bubbleMap=="simple"){L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:false}).addTo(mapdataviz);for(i=0;i<DataforMap.length;i++){bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSimpleGeneric(DataforMap[i]),onEachFeature:highlightAndPopup});layerName[$("<div>").html(DataforMap[i]["title"]).text()]=bubbles[i]}bubbles[0].addTo(mapdataviz);if(flowStatus=="flow"){updateLegend(DataforMap[0],"flows");updateFlowData(DataforMap[0]["code"]);window.maxBubble=DataforMap[0]["max"]}else{updateLegend(DataforMap[0],"size")}if(DataforMap.length>1){if($(window).width()<750){L.control.layers(layerName,null,{collapsed:true}).addTo(mapdataviz)}else{L.control.layers(layerName,null,{collapsed:false}).addTo(mapdataviz)}}$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();if(flowStatus=="flow"){updateFlowData(DataforMap[index]["code"]);clearFlows();clearFlowLegend();updateLegend(DataforMap[index],"flows");window.maxBubble=DataforMap[index]["max"]}else{updateLegend(DataforMap[index],"size")}})}else{var shapes=[];var layerGroup=[];var mapSubPoints=getMapSubPoints(mapCentroides);for(i=0;i<DataforMap.length;i++){shapes[i]=L.geoJson(mapShapes,{style:getColorCountryShapesStyleGeneric(DataforMap[i]),onEachFeature:highlightAndPopup,clickable:false});if(mapSubPoints!=undefined){bubbles[i]=L.geoJson(mapSubPoints,{pointToLayer:bubblesSimpleColorGeneric(DataforMap[i]),onEachFeature:highlightAndPopup});layerGroup[i]=L.layerGroup([shapes[i],bubbles[i]])}else{layerGroup[i]=L.layerGroup([shapes[i]])}L.stamp(layerGroup[i]);layerName[$("<div>").html(DataforMap[i]["title"]).text()]=layerGroup[i]}layerGroup[DataforMapAll.defaultLayer].addTo(mapdataviz);updateLegend(DataforMap[DataforMapAll.defaultLayer],"color");if(DataforMap.length>1){if($(window).width()<750||embed==2){L.control.layers(layerName,null,{collapsed:true}).addTo(mapdataviz)}else{L.control.layers(layerName,null,{collapsed:false}).addTo(mapdataviz)}}$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();updateLegend(DataforMap[index],"color")})}}function textColor(hex){var match=hex.match(/^#(..)(..)(..)$/);if(match){var rgb=match.slice(1).map(function(s){return parseInt(s,16)/255});var L=(Math.min.apply(null,rgb)+Math.max.apply(null,rgb))/2;return L<.5?"#fff":"#000"}else{return"#000"}}function updateLegend(Data,mode){if(mode=="color"){if(Data){var colors=Data["colors"];$("#legendMinColor").parent().parent().empty().append(colors.map(function(color,idx,colors){var el=$("<li>");if(idx===0){el.addClass("firstLegendElement");el.append($('<span id="legendMinColor" class="firstLegendElement">').css("background",color).css("color",textColor(color)))}else if(idx+1===colors.length){el.addClass("lastLegendElement");el.append($('<span id="legendMaxColor" class="lastLegendElement">').css("background",color).css("color",textColor(color)))}else{el.append($("<span>").css("background",color))}return el}));$("#legendMaxColor").html(getHumanReadData(Data["max"],Data["options"]["tooltipDecimals"]));$("#legendMinColor").html(getHumanReadData(Data["min"],Data["options"]["tooltipDecimals"]));$("#legendTitleColor").text($("<div>").html(Data["title"]).text());if("mapRegion"in Data["options"]&&Data["options"]["mapRegion"]!=""&&Data["values"][Data["options"]["mapRegion"]]){var subtext=lang_countries[Data["options"]["mapRegion"].toLowerCase()]+": "+getHumanReadData(Data["values"][Data["options"]["mapRegion"]][1],Data["options"]["tooltipDecimals"]);if(Data["options"]["tooltipUnit"]!=""){subtext+=" "+Data["options"]["tooltipUnit"]}if(Data["values"][Data["options"]["mapRegion"]][0]!=Data["latestYear"]){subtext+=" ("+Data["values"][Data["options"]["mapRegion"]][0]+")"}$("#legendSubtextColor").html(subtext);$("#legendSubtextColor").show();if("mapSource"in lang_labels){$("#topContainer").css("height","66px")}else{$("#topContainer").css("height","58px")}}else{if("mapSource"in lang_labels){$("#topContainer").css("height","58px")}$("#legendSubtextColor").hide()}if(window.relatedDataControl){window.relatedDataControl.updateColors(function(id){return Data.values[id]&&quantize(Data.values[id][1],Data.min,Data.max,Data.colors)})}if(Data["options"]["tooltipUnit"]!=""){$("#legendUnitColor").text(", "+Data["options"]["tooltipUnit"])}else{$("#legendUnitColor").text("")}$("#legendYearColor").text(Data["latestYear"])}else{$("#legendMaxColor").html("");$("#legendMinColor").html("");$("#legendTitleColor").text("No data available");$("#legendUnitColor").text("");$("#legendYearColor").text("")}}else if(mode=="flows"){if(Data){$("#legendBubble").html(window.lang_labels["min"]+": "+getHumanReadData(Data["min"],Data["options"]["tooltipDecimals"])+" - "+window.lang_labels["max"]+": "+getHumanReadData(Data["max"],Data["options"]["tooltipDecimals"]));$("#legendTitleSize").text($("<div>").html(Data["title"]).text());if(Data["options"]["tooltipUnit"]!=""){$("#legendUnitSize").text(", "+Data["options"]["tooltipUnit"])}else{$("#legendUnitSize").text("")}$("#legendYearSize").text("")}else{$("#legendBubble").html("");$("#legendTitleSize").text("No data available");$("#legendUnitSize").text("");$("#legendYearSize").text("")}}else{if(Data){$("#legendBubble").html(window.lang_labels["min"]+": "+getHumanReadData(Data["min"],Data["options"]["tooltipDecimals"])+" - "+window.lang_labels["max"]+": "+getHumanReadData(Data["max"],Data["options"]["tooltipDecimals"]));$("#legendTitleSize").text($("<div>").html(Data["title"]).text());if(Data["options"]["tooltipUnit"]!=""){$("#legendUnitSize").text(", "+Data["options"]["tooltipUnit"])}else{$("#legendUnitSize").text("")}$("#legendYearSize").text(Data["latestYear"])}else{$("#legendBubble").html("");$("#legendTitleSize").text("No data available");$("#legendUnitSize").text("");$("#legendYearSize").text("")}}$("#flowLayer .commodity").text(Data["title"])}function updateMultiLegend(Data,mode){if(mode=="color"){if(Data){$("#legendMaxColor").html(getHumanReadData(Data["max"],Data["options"]["tooltipDecimals"]));$("#legendMinColor").html(getHumanReadData(Data["min"],Data["options"]["tooltipDecimals"]));$("#legendTitleColor").text($("<div>").html(Data["title"]).text());if(Data["options"]["tooltipUnit"]!=""){$("#legendUnitColor").text(", "+Data["unit"])}else{$("#legendUnitColor").text("")}$("#legendYearColor").text("")}else{$("#legendMaxColor").html("");$("#legendMinColor").html("");$("#legendTitleColor").text("No data available");$("#legendUnitColor").text("");$("#legendYearColor").text("")}}else{if(Data){$("#legendBubble").html(window.lang_labels["min"]+": "+getHumanReadData(Data["min"],Data["options"]["tooltipDecimals"])+" - "+window.lang_labels["max"]+": "+getHumanReadData(Data["max"],Data["options"]["tooltipDecimals"]));$("#legendTitleSize").text($("<div>").html(Data["title"]).text());if(Data["options"]["tooltipUnit"]!=""){$("#legendUnitSize").text(", "+Data["unit"])}else{$("#legendUnitSize").text("")}$("#legendYearColor").text("")}else{$("#legendBubble").html("");$("#legendTitleSize").text("No data available");$("#legendUnitSize").text("");$("#legendYearSize").text("")}}}function setLegend(chartType,bubbleMap){if(bubbleMap=="colored"||bubbleMap=="multiColored"||bubbleMap=="coloredPairUnpair"){$("#textLegend").hide()}else if(bubbleMap=="simple"){$("#colorLegend").hide();if(chartType=="mapWizard"){$("#textLegend").hide();$("#sizeLegend").css({width:"100%"})}}else{$("#sizeLegend").hide();if(chartType=="mapWizard"){$("#textLegend").hide();$("#colorLegend").css({width:"100%"})}}}function loopMapIndicator(mode){if(mode=="color"){setInterval(changeColor,2e3)}else if(mode=="bubble"){setInterval(changeBubble,2e3)}var currentLayer=0;function changeBubble(){mapdataviz.removeLayer(bubbles[currentLayer]);layer=Math.floor(Math.random()*bubbles.length+1);currentLayer=layer-1;bubbles[currentLayer].addTo(mapdataviz);updateLegend(DataforMap[currentLayer],"size")}function changeColor(){mapdataviz.removeLayer(shapes[currentLayer]);layer=Math.floor(Math.random()*shapes.length+1);currentLayer=layer-1;shapes[currentLayer].addTo(mapdataviz);updateLegend(DataforMap[currentLayer],"color")}}var landmass;var landmassBorder;var landmassBorderWidth;var landmassGroup;var bubbleDefaultBorder;var bubbleDefaultColor;var bubbleHighlightBorder;var shapeHighlightBorder;if(themeURL=="ecb"){landmass="#f0f0f0";landmassNA="#fff";landmassBorder="#000";landmassBorderWidth=.5;landmassGroup="#f0f0f0";bubbleDefaultBorder="#494444";bubbleDefaultColor="#d56620";bubbleHighlightBorder="#fff";shapeHighlightBorder="#fff"}else{landmass="#939393";landmassNA="#939393";landmassBorder="#939393";landmassBorderWidth=1;landmassGroup="#BBBBBB";bubbleDefaultBorder="#494444";bubbleDefaultColor="#d56620";bubbleHighlightBorder="#fff";shapeHighlightBorder="#fff"}if(project=="trade-in-raw-materials"){landmass="#BBBBBB";landmassNA="#BBBBBB"}if(project=="itf-test"){landmass="#BBBBBB";landmassNA="#BBBBBB"}function getColorCountryShapesStyleGeneric(layerData){return function(feature){if(feature&&feature.properties&&layerData["values"][feature.properties[mapCode]]!=null){return{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:getIndicatorColorScale(layerData["values"][feature.properties[mapCode]][1],layerData["min"],layerData["max"],feature,layerData["colors"])||landmassNA,className:"hasValue"}}else if(feature&&feature.properties&&$.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1){return{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:landmassNA,className:"hasValue"}}else if(feature&&feature.properties&&$.inArray(feature.properties[mapCode].toString().toLowerCase(),["aut","bel","cyp","deu","esp","est","fin","fra","grc","irl","ita","ltu","lux","lva","mlt","nld","prt","svk","svn"])>-1){return{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:"#004996",className:"hasValue"}}else if(feature&&feature.properties&&feature.properties[mapCode]){return{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:landmass,className:"hasValue"}}else{return{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:landmassGroup,className:"hasValue"}}}}function bubblesSimpleGeneric(Data){return function(feature,latlng){return L.circleMarker(latlng,getBubbleStyleGeneric(feature,Data))}}function bubblesSimpleColorGeneric(colorData){return function(feature,latlng){return L.circleMarker(latlng,getBubbleColorGeneric(feature,colorData))}}function bubblesSizeColorGeneric(sizeData,colorData){return function(feature,latlng){return L.circleMarker(latlng,getBubbleSizeColorGeneric(feature,sizeData,colorData))}}function getBubbleStyleGeneric(feature,layerData){var bubbleColor;if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1&&layerData["values"][feature.properties[mapCode]]!=null){bubbleColor=bubbleDefaultColor;if(layerData["values"][feature.properties[mapCode]]!=null){var radius=getBubbleSize(layerData["values"][feature.properties[mapCode]][1],layerData["max"],feature);if(radius!=null){return{radius:radius,fillColor:bubbleColor,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1}}}}return{radius:0,opacity:0}}function getBubbleSizeColorGeneric(feature,sizeData,colorData){var bubbleColor;if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1&&sizeData["values"][feature.properties[mapCode]]!=null){radius=getBubbleSize(sizeData["values"][feature.properties[mapCode]][1],sizeData["max"],feature);if(colorData!=null){if(colorData["values"][feature.properties[mapCode]]!=null){var bubbleColor=getIndicatorColorScale(colorData["values"][feature.properties[mapCode]][1],colorData["min"],colorData["max"],feature,colorData["colors"]);if(radius!=null){return{radius:radius,fillColor:bubbleColor,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1}}}}else{if(radius!=null){return{radius:radius,fillColor:bubbleDefaultBorder,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1}}}}return{radius:0,opacity:0}}function getBubbleColorGeneric(feature,colorData){var bubbleColor;if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1){radius=5;if(colorData["values"][feature.properties[mapCode]]!=null){var bubbleColor=getIndicatorColorScale(colorData["values"][feature.properties[mapCode]][1],colorData["min"],colorData["max"],feature,colorData["colors"]);if(radius!=null){return{radius:radius,fillColor:bubbleColor,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1}}}}return{radius:0,opacity:0}}function getBasicCountryShapesStyle(feature){function getBasicGroupColor(feature){if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1){return landmassGroup}else{return landmass}}return{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:getBasicGroupColor(feature)}}function highlightAndPopup(feature,layer){if(!(feature&&feature.properties&&feature.properties[mapCode]))return;var interaction;if(window.flowStatus=="flow"){interaction=clickFlow}else{interaction=click}var inEuroArea=feature&&feature.properties&&$.inArray(feature.properties[mapCode].toString().toLowerCase(),["aut","bel","cyp","deu","esp","est","fin","fra","grc","irl","ita","ltu","lux","lva","mlt","nld","prt","svk","svn"])>-1;if(themeURL=="ecb"&&!inEuroArea||$.inArray(layer.feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1){layer.on({click:interaction,mouseover:function(){if(!layer.inFront){layer.inFront=true;layer.setStyle({fillOpacity:.8,weight:2,color:bubbleMap!=null?bubbleHighlightBorder:shapeHighlightBorder}).bringToFront()}},mouseout:function(){layer.inFront=false;layer.setStyle({fillOpacity:1,weight:landmassBorderWidth,color:bubbleMap!=null?bubbleDefaultBorder:landmassBorder});if(typeof disputedLines!=="undefined"){disputedLines.bringToFront()}if(typeof flowGroup!=="undefined"){flowGroup.eachLayer(function(layer){if(layer.bringToFront){layer.bringToFront()}else{layer.eachLayer(function(sublayer){sublayer.bringToFront()})}})}}});if(layer.eachLayer){layer.eachLayer(function(sublayer){L.Util.setOptions(sublayer,{clickable:true})})}else{L.Util.setOptions(layer,{clickable:true})}}}function notClickable(feature,layer){- -L.Util.setOptions(layer,{clickable:false})}function click(e){var layer=e.target;var specialTooltip=window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltip;var specialTooltipLinks=window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltipLinks;var teaserText;if(specialTooltip=="export-restrictions-main"){teaserText=mapTeaserExportRestrictionsMain(layer.feature.properties[mapCode])}else if(specialTooltip=="export-restrictions"){teaserText=mapTeaserExportRestrictions(layer.feature.properties[mapCode])}else if(specialTooltip=="ifi-country-data"){teaserText=mapTeaserIfiCountryData(layer.feature.properties[mapCode],specialTooltipLinks)}else if(window.bubbleMap=="multiColored"){teaserText=mapTeaserTextMulti(layer.feature.properties[mapCode])}else{teaserText=mapTeaserText(layer.feature.properties[mapCode])}if(themeURL=="ecb"||$.inArray(layer.feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1){popup.setLatLng(e.latlng);popup.setContent(teaserText);if(!popup._map)popup.openOn(mapdataviz)}}function popupLoop(countryISO){var teaserText=mapTeaserText(countryISO);popup.setLatLng([Centroides[countryISO]["Lat"],Centroides[countryISO]["Long"]]);mapdataviz.setView([Centroides[countryISO]["Lat"],Centroides[countryISO]["Long"]],2);popup.setContent(teaserText);if(!popup._map)popup.openOn(mapdataviz)}var colorIdx=0,flowGroup=L.layerGroup(),activeLayer="";function clickFlow(e){var layer=e.target;var layerCode=layer.feature.properties[mapCode];var color=["blue","blue","blue"];clearFlows();if(activeLayer!=layerCode&&$.inArray(layerCode.toLowerCase(),MapGroup)>-1){addLines({center:layerCode,stars:getFlows(layerCode)},color[colorIdx],centroides,mapdataviz);colorIdx=(colorIdx+1)%3;activeLayer=layerCode;updateFlowLegend(layerCode)}else{activeLayer=""}}function clearFlows(){flowGroup.clearLayers().addTo(mapdataviz)}function getFlows(country){var data=window.DataforFlow;var idxCountry=data.keys[0].indexOf(country.toUpperCase());var newData={};var max=0
;$.each(data.keys[1],function(key,value){var crData=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];if(max<crData){max=crData}});$.each(data.keys[1],function(key,value){var crData1=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];if(crData1/max>.01){newData[value]=getLineSize(crData1,window.maxBubble)}else{newData[value]=0}});function getLineSize(d,max){if(d==null||d<=0)return null;var width=Math.sqrt(d/max)*25;return width}return newData}function clearFlowLegend(){$("#flowLayer .helptext").show();$("#flowLayer #detailsTable").hide();$("#flowLayer .countryPrefix").text("");$("#flowLayer .country").html("")}function updateFlowLegend(layerCode){var flowLabels={tableHead1:{en:"Main export destinations",cn:"主要出口目的地"},tableHead2:{en:"USD Millions",cn:"百万美元"},world:{en:"World",cn:"世界"},unspecified:{en:"unspecified",cn:"未标明"},asia:{en:"Asia n.e.s.",cn:"亚洲n.e.s."},headlinePrefix:{en:"Exports from ",cn:"从"},headlineSuffix:{en:"",cn:"的出口"}};if(window.lang_countries[layerCode.toLowerCase()]!=null){$("#flowLayer .country").html(window.lang_countries[layerCode.toLowerCase()])}else{$("#flowLayer .country").html(layerCode)}$("#flowLayer #countryPrefix").text(flowLabels.headlinePrefix[lang]);$("#flowLayer #countrySuffix").text(flowLabels.headlineSuffix[lang]);$("#flowLayer .helptext").hide();$("#flowLayer #detailsTable").show();$("#flowLayer #detailsTable thead .countries").text(flowLabels.tableHead1[lang]);$("#flowLayer #detailsTable thead .values").text(flowLabels.tableHead2[lang]);$("#flowLayer #detailsTable tbody").remove();$("#flowLayer #detailsTable").append("<tbody>");var legendData=getFlowsLegend(layerCode);$.each(legendData["rank"],function(key,value){if(window.lang_countries[legendData["values"][value].toLowerCase()]!=null){country=window.lang_countries[legendData["values"][value].toLowerCase()]}else if(legendData["values"][value]=="WLD"){country=flowLabels.world[lang]}else if(legendData["values"][value]=="UNSPE"){country=flowLabels.unspecified[lang]}else if(legendData["values"][value]=="XCD"){country=flowLabels.asia[lang]}else{country=legendData["values"][value]}$("#flowLayer #detailsTable tbody").append("<tr><td>"+country+'</td><td  class="tableValues">'+Math.round(value/1e6)+"</td>")});function getFlowsLegend(country){var data=window.DataforFlow;var idxCountry=data.keys[0].indexOf(country.toUpperCase());var newData={};newData["rank"]=[];newData["values"]={};var max=0;$.each(data.keys[1],function(key,value){var crData=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];if(max<crData){max=crData}});$.each(data.keys[1],function(key,value){var crData1=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];if(crData1/max>.01){newData["values"][crData1]=value;newData["rank"].push(crData1)}});newData["rank"].sort(function(a,b){return b-a});return newData}}function addLines(flow,color,centros,mapdataviz){var stars={};$.each(flow.stars,function(country,value){if(centros[country.toUpperCase()]!=undefined){stars[country]={};stars[country]["latlong"]=[parseFloat(centros[country.toUpperCase()].Lat),parseFloat(centros[country.toUpperCase()].Long)];stars[country]["value"]=value}});var center=[parseFloat(centros[flow.center.toUpperCase()].Lat),parseFloat(centros[flow.center.toUpperCase()].Long)];$.each(stars,function(country,values){var lines=L.polyline([center,values.latlong],{color:color,weight:values.value,fill:"blue"});flowGroup.addLayer(lines)})}function updateFlowData(indicator){$.ajax({dataType:"json",url:baseURL+"/api-data?project="+project+"&id="+indicator,success:ajaxSuccess,error:function(xhr,ajaxOptions,thrownError){if(xhr.status=="404"){alert("No data available.")}}});function ajaxSuccess(data){if(data!=null){window.DataforFlow=data}else{alert("No data available.")}}}function mapTeaserText(country){var euGroup=["aut","bel","bgr","cyp","deu","dnk","esp","fin","fra","gbr","grc","hrv","irl","ita","lux","lva","ltu","mlt","nld","prt","swe","cze","est","hun","pol","svk","svn","rou"];var teaser=$("<div>");var teaserTitle=$('<h3 class="tooltipTitle">');var teaserTable=$('<table class="tooltipTable">');teaser.append(teaserTitle);var countryProfile=$('<div class="countryProfilLink">').append($('<span id="countryProfileMap">').attr("value",country).html(lang_labels.countryProfile));if(typeof wizardConfig!=="undefined"&&wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes=="withEU"&&$.inArray(country.toString().toLowerCase(),euGroup)>-1){countryProfile.append('<span value="eu" id="euProfileMap">view EU profile</span>')}teaser.append(countryProfile);var countryName=lang_countries[country.toString().toLowerCase()]||ISO3toFlags[country]||country;teaserTitle.text(countryName);var tableLineCanvas;var tooltipData;var dataValue;var hasData=false;for(var i=0;i<ChartsWithData;i++){if(DataforMap[i]!=null){tableLineCanvas=$("<tr>").append($("<td>").attr("title",$("<div>").html(DataforMap[i]["definition"]).text()).html(DataforMap[i]["title"]));tooltipData=$('<td class="tooltipData">');tableLineCanvas.append(tooltipData);if(DataforMap[i]["values"][country]!=undefined&&DataforMap[i]["values"][country][1]!=null){hasData=true;dataValue=getHumanReadData(DataforMap[i]["values"][country][1],DataforMap[i]["options"]["tooltipDecimals"])+"&nbsp;"+DataforMap[i]["options"]["tooltipUnit"];if(DataforMap[i]["values"][country][0]!=DataforMap[i]["latestYear"]){dataValue+="&nbsp;("+DataforMap[i]["values"][country][0]+")"}tooltipData.html(dataValue)}else{tooltipData.text("—")}teaserTable.append(tableLineCanvas)}}if(hasData||themeURL!="ecb"){teaserTitle.after(teaserTable)}return teaser[0]}function mapTeaserTextMulti(country){var euGroup=["aut","bel","bgr","cyp","deu","dnk","esp","fin","fra","gbr","grc","hrv","irl","ita","lux","lva","ltu","mlt","nld","prt","swe","cze","est","hun","pol","svk","svn","rou"];var teaserTitleStart='<h3 class="tooltipTitle">';var teaserTitleEnd="</h3>";var teaserTableStart='<table class="tooltipTable">';var teaserTableLineCenter='</td><td  class="tooltipData">';var teaserTableEnd="</td></tr></table>";if(typeof wizardConfig!=="undefined"&&wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes=="withEU"&&$.inArray(country.toString().toLowerCase(),euGroup)>-1){var countryProfile="<div class='countryProfilLink'>"+"<span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span>"+""+"<span value='eu' id='euProfileMap' >view EU profile</span>"+"</div>"}else{var countryProfile="<div class='countryProfilLink'>"+"<span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span>"+"</div>"}if(lang_countries[country.toString().toLowerCase()]!=null){var countryName=lang_countries[country.toString().toLowerCase()]+" - "+DataforMap[mapLayerIndex]["title"]}else{var countryName=country+" - "+DataforMap[mapLayerIndex]["title"]}var tableLines;var tableLine=[];tableLine[0]="<tr>"+"<td>"+DataforMap[mapLayerIndex]["options"]["tooltipUnit"]+"</td>"+"<td class='tooltipData'>"+getHumanReadData(DataforMap[mapLayerIndex]["values"][country][1])+"</td>"+"</tr>";if(DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]){tableLine[1]="<tr>"+"<td>"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]["options"]["tooltipUnit"]+"</td>"+"<td class='tooltipData'>"+getHumanReadData(DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]["values"][country][1])+"</td>"+"</tr>"}else{tableLine[1]="<tr><td></td><td></td></tr>"}tableLines=tableLine[0]+tableLine[1];return""+teaserTitleStart+countryName+teaserTitleEnd+teaserTableStart+tableLines+teaserTableEnd+countryProfile+""}function mapTeaserExportRestrictions(country){var labels2={};labels2["en"]={1:"export prohibition",2:"export quota",3:"export tax",4:"non-automatic licencing",5:"other measures",6:"no restrictions",undefined:"not reseached"};labels2["cn"]={1:"禁止出口",2:"出口配额",3:"出口税",4:"非自动许可",5:"其他措施",6:"无限制",undefined:"没有研究"};var teaserTitleStart='<h3 class="tooltipTitle">';var teaserTitleEnd="</h3>";var teaserTableStart='<table class="tooltipTable">';var teaserTableLineCenter='</td><td  class="tooltipData">';var teaserTableEnd="</td></tr></table>";var countryProfile="<div class='countryProfilLink'>"+"<span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span>"+"</div>";var countryName=lang_countries[country.toLowerCase()]+" - "+DataforMap[mapLayerIndex]["title"];var tableLines;var tableLine=[];if(DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]){tableLine[0]="<tr>"+"<td>"+DataforMap[mapLayerIndex]["options"]["tooltipUnit"]+":</td>"+"<td class='tooltipData'>"+getHumanReadData(DataforMap[mapLayerIndex]["values"][country][1])+" "+DataforMap[mapLayerIndex]["unit"]+"</td>"+"</tr>";tableLine[1]="<tr>"+"<td>"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]["options"]["tooltipUnit"]+":</td>"+"<td class='tooltipData'>"+labels2[lang][DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]["values"][country][1]]+"</td>"+"</tr>"}else{tableLine[0]="<tr>"+"<td>"+DataforMap[mapLayerIndex]["options"]["tooltipUnit"]+":</td>"+"<td class='tooltipData'>"+labels2[lang][DataforMap[mapLayerIndex]["values"][country][1]]+"</td>"+"</tr>";tableLine[1]="<tr><td></td><td></td></tr>"}tableLines=tableLine[0]+tableLine[1];return""+teaserTitleStart+countryName+teaserTitleEnd+teaserTableStart+tableLines+teaserTableEnd+countryProfile+""}function mapTeaserExportRestrictionsMain(country){var labels2={};labels2["en"]={1:"export prohibition",2:"export quota",3:"export tax",4:"non-automatic licencing",5:"other measures",6:"no restrictions",undefined:"not reseached"};labels2["cn"]={1:"禁止出口",2:"出口配额",3:"出口税",4:"非自动许可",5:"其他措施",6:"无限制",undefined:"没有研究"};var teaserTitleStart='<h3 class="tooltipTitle">';var teaserTitleEnd="</h3>";var teaserTableStart='<table class="tooltipTable">';var teaserTableLineCenter='</td><td  class="tooltipData">';var teaserTableEnd="</td></tr></table>";var countryProfile="<div class='countryProfilLink'>"+"<span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span>"+"</div>";var countryName=lang_countries[country.toLowerCase()];var tableLineCanvas=[];var tooltipData=[];var tableLines;tableLineCanvas[0]="<tr><td title='"+DataforMap[0]["definition"]+"'>"+DataforMap[0]["title"]+":</td><td class='tooltipData'>";tooltipData[0]=labels2[lang][DataforMap[0]["values"][country][1]];tableLines=tableLineCanvas[0]+tooltipData[0];return""+teaserTitleStart+countryName+teaserTitleEnd+teaserTableStart+tableLines+teaserTableEnd+countryProfile+""}function mapTeaserIfiCountryData(country,links){var teaser=$("<div>");var teaserTitle=$('<h3 class="tooltipTitle">');var teaserTable=$('<table class="tooltipTable">');teaser.append(teaserTitle);var link=links[country.toString().toLowerCase()];if(link!=null){var countryProfile=$('<div style="text-align: center;">').append($('<a target="_blank">').attr("href",link).text(lang_labels.countryProfile));teaser.append(countryProfile)}var countryName=lang_countries[country.toString().toLowerCase()]||country;teaserTitle.text(countryName);var tableLineCanvas;var tooltipData;var dataValue;var hasData=false;var unit;for(var i=0;i<ChartsWithData;i++){if(DataforMap[i]!=null){tableLineCanvas=$("<tr>").append($("<td>").attr("title",$("<div>").html(DataforMap[i]["definition"]).text()).html(DataforMap[i]["title"]));tooltipData=$('<td class="tooltipData">');tableLineCanvas.append(tooltipData);if(DataforMap[i]["values"][country]!=undefined&&DataforMap[i]["values"][country][1]!=null){hasData=true;dataValue=getHumanReadData(DataforMap[i]["values"][country][1],DataforMap[i]["options"]["tooltipDecimals"]);unit=DataforMap[i]["options"]["tooltipUnit"]||"";if(unit!==""){dataValue+="&nbsp;"+unit}if(DataforMap[i]["values"][country][0]!=DataforMap[i]["latestYear"]){dataValue+="&nbsp;("+DataforMap[i]["values"][country][0]+")"}tooltipData.html(dataValue)}else{tooltipData.text("—")}teaserTable.append(tableLineCanvas)}}teaserTitle.after(teaserTable);return teaser[0]}var topLarge=80;var heightSmall=85;if($(window).width()>475){topLarge=92;heightSmall=85}if($(window).width()>650){topLarge=100;heightSmall=70}function largeContainer(){$("#topContainer").css({height:"auto"});$("#topContainer").css({top:topLarge+"px"});$("#itemContainer").fadeIn();$("#item1Container").fadeOut();$("#item2Container").fadeOut();$("#mapLegendContainer").fadeOut();$(".map-legend").css({"padding-top":"30px"});mapdataviz.closePopup()}function largeContainerPDF(){$("#itemContainer").fadeIn()}function smallContainer(){$("#topContainer").animate({height:heightSmall+"px"});$("#topContainer").css({top:"auto"});$("#itemContainer").fadeOut();$("#item1Container").fadeIn();$("#item2Container").fadeOut();$("#mapLegendContainer").fadeIn();$(".map-legend").css({"padding-top":"0px"})}function startContainer(){$("#topContainer").css({height:"auto"});$("#topContainer").css({top:topLarge+"px"});$("#itemContainer").fadeOut();$("#item1Container").fadeOut();$("#item2Container").fadeIn();$("#mapLegendContainer").fadeOut();$(".map-legend").css({"padding-top":"30px"});mapdataviz.closePopup()}$(document).ready(function(){var tab=wizardConfig.project.tabs[page];var subTabsType=wizardConfig.tabs[tab].subTabsType;if(wizardConfig.tabs[tab].teaserLayer&&window.secondVisit==false){startContainer()}else{smallContainer()}$(".countryProfilLink").show();$(".teaserTitle2").text(" - "+lang_labels.TabCountryNote);$.each(subTabs,function(key,value){$("#panelNav").append('<a id="subTabButton'+key+'" href="#subTab'+key+'">');$("#itemContainer").append('<div id="subTab'+key+'" class="tab">');$("#subTabButton"+key+"").text(value.title[lang])});$("#subTabButton0").addClass("active");$("#subTab0").addClass("active");$(document).on("click","#countryProfileMap",function(){if(subTabsType=="simple"){updateCountryProfileSimple($(this).attr("value").toLowerCase())}else{updateCountryProfile($(this).attr("value").toLowerCase())}mapdataviz.closePopup()});$(document).on("click","#euProfileMap",function(){if(subTabsType=="simple"){updateCountryProfileSimple($(this).attr("value").toLowerCase())}else{updateCountryProfile($(this).attr("value").toLowerCase())}mapdataviz.closePopup()});$(".closeLayer").click(smallContainer);$("#panelNav").on("click","a",function(){$(this).addClass("active").siblings("a.active").removeClass("active");$($(this).attr("href")).addClass("active").siblings(".tab.active").removeClass("active");return false})});function updateCountryProfile(profileCountry,mode){$(".noteCountryName").text(lang_countries_titles[profileCountry.toLowerCase()]||"");$.each(window.subTabs,function(key,value){$("#subTab"+key).html("")});$.ajax({dataType:"json",url:baseURL+"/api-notes?project="+project+"&lg="+lang+"&cr="+profileCountry.toLowerCase(),success:ajaxSuccess,error:function(xhr,ajaxOptions,thrownError){if(xhr.status=="404"){alert("Country profile not available.")}}});function ajaxSuccess(data){if(data!=null){$.each(window.subTabs,function(subTab,subTabVal){$.each(subTabVal.content[window.lang],function(section,val){$("#subTab"+subTab).append('<div id="sec'+subTab+"-"+section+'" class="section"><div class="headingElement"><h4><span class="subHeadingText">');$("#sec"+subTab+"-"+section+" .headingElement h4 .subHeadingText").html(val);var subSection=0;if(data[val]!=undefined){$.each(data[val],function(key,content){if(key=="h1 text"){$.each(content,function(element,parts){$("#sec"+subTab+"-"+section).append('<p id="textSec'+subTab+"-"+section+"-"+element+'" class="textElement">');$("#textSec"+subTab+"-"+section+"-"+element).html(parts)})}if(subTabVal.charts!=undefined){addChartSections(subTabVal,subTab,section,profileCountry,val,"chartSectionMain")}if(key!="h1 text"){$("#sec"+subTab+"-"+section).append('<h5 id="headerSec'+subTab+"-"+section+"-"+subSection+'" class="subSection"><table><tr><td>');$("#headerSec"+subTab+"-"+section+"-"+subSection+" table tr td").html(key);var subSubSection=0;$.each(content,function(subkey,subcontent){if(subkey=="h2 text"){$.each(subcontent,function(key,content){$("#sec"+subTab+"-"+section).append('<p id="textSec'+subTab+"-"+section+"-"+subSection+"-"+key+'" class="textElement">');if(subTabVal.display!=null&&subTabVal.display=="expanded"){$("#textSec"+subTab+"-"+section+"-"+subSection+"-"+key).html(content)}else{$("#textSec"+subTab+"-"+section+"-"+subSection+"-"+key).html(content).hide()}});if(subTabVal.charts!=undefined){if(subTabVal.display!=null&&subTabVal.display=="expanded"){addChartSections(subTabVal,subTab,section,profileCountry,key,"chartSectionMain")}else{addChartSections(subTabVal,subTab,section,profileCountry,key,"chartSection")}}}else{$.each(subcontent,function(key,content){$("#sec"+subTab+"-"+section).append('<h6 id="headerSec'+subTab+"-"+section+"-"+subSection+"-"+subSubSection+'" class="subSection">');$("#headerSec"+subTab+"-"+section+"-"+subSection+"-"+subSubSection).text(subkey).hide();$("#sec"+subTab+"-"+section).append('<p id="textSec'+subTab+"-"+section+"-"+subSection+"-"+subSubSection+"-"+key+'" class="textElement">');$("#textSec"+subTab+"-"+section+"-"+subSection+"-"+subSubSection+"-"+key).html(content).hide()})}subSubSection++})}subSection++})}});if(subTabVal.display==null){$("#subTab"+subTab+" .section h5 table tr").append(expand)}})}else{alert("Country profile is not available.")}$(".tab a").attr("target","_blank");$(".expandCollaps").append(expandElements);$("h5").click(function(){var parent=this;$(parent).nextUntil("h5","p").slideToggle(500,function(){});$(parent).nextUntil("h5","h6").slideToggle(500,function(){});$(parent).nextUntil("h5",".simpleTable").toggle();$(parent).nextUntil("h5",".chartSection").toggle();$(parent).find(".expand").toggle();$(parent).find(".collaps").toggle()});if(mode=="pdf"){largeContainerPDF()}else{largeContainer()}}var expand='<td class="expandCollaps">';var expandElements='<span class="controls expand expandText">[expand&nbsp;section]</span><span class="controls collaps expandText">[collapse&nbsp;section]</span>';function addChartSections(subTabVal,subTab,section,profileCountry,sectionName,sectionLevel){$.each(subTabVal.charts,function(chart,config){var chartHeader='<div class="'+sectionLevel+'"><div class="chartTitle">'+subTabVal.ConfigSubCharts[chart].title+"</div>"+'<div class="chartSubTitle">'+subTabVal.ConfigSubCharts[chart].definition+", "+subTabVal.ConfigSubCharts[chart].options.tooltipUnit+"</div>"+'<div style="height:200px" class="chartContainer" id="container'+chart+"-"+subTab+"-"+section+'">';if(config.section[window.lang]==sectionName){if(config.chartType=="simpleTable"){$("#sec"+subTab+"-"+section).append(addSimpleTable(subTabVal.ConfigSubCharts[chart],profileCountry,config.legendType))}if(config.chartType=="lineChart"){values=filterLocation(subTabVal.ConfigSubCharts[chart],[profileCountry.toLowerCase()]);if(values.data.data[0]!=undefined){$("#sec"+subTab+"-"+section).append(chartHeader);addLineChart(values,"container"+chart+"-"+subTab+"-"+section)}}if(config.chartType=="columnChart"){$("#sec"+subTab+"-"+section).append(chartHeader);addColumnChart(filterYear(subTabVal.ConfigSubCharts[chart],["2012"]),"container"+chart+"-"+subTab+"-"+section);highlightDataPoint(profileCountry.toLowerCase(),"blue",0,"#container"+chart+"-"+subTab+"-"+section)}}})}}function updateCountryProfileSimple(profileCountry){$(".noteCountryName").text(lang_countries_titles[profileCountry.toLowerCase()]||"");$.each(window.subTabs,function(key,value){$("#subTab"+key).html("")});addCharts();function addCharts(){$.each(window.subTabs,function(subTab,subTabVal){$.each(subTabVal.content,function(section,val){$("#subTab"+subTab).append('<div id="sec'+subTab+"-"+section+'" class="section"><div class="headingElement"><h4><span class="subHeadingText">');if(subTabVal.charts!=undefined){addChartSections(subTabVal,subTab,section,profileCountry,val,"chartSectionMain")}})});largeContainer()}function addChartSections(subTabVal,subTab,section,profileCountry,sectionName,sectionLevel){var complexCharts=[];var complexTable;$.each(subTabVal.charts,function(chart,config){var chartHeader='<div class="'+sectionLevel+'"><div class="chartTitle">'+subTabVal.ConfigSubCharts[chart].title+"</div>"+'<div class="chartSubTitle">'+subTabVal.ConfigSubCharts[chart].definition+", "+subTabVal.ConfigSubCharts[chart].options.tooltipUnit+"</div>"+'<div style="height:1000px" class="chartContainer" id="container'+chart+"-"+subTab+"-"+section+'">';if(config.chartType=="simpleTable"){$("#sec"+subTab+"-"+section).append(addSimpleTable(subTabVal.ConfigSubCharts[chart],profileCountry,config.legendType))}if(config.chartType=="complexTable"){complexCharts.push(subTabVal.ConfigSubCharts[chart]);complexTable=true}if(config.chartType=="sortedBarChart"){values=filterLocation(subTabVal.ConfigSubCharts[chart],[profileCountry.toLowerCase()]);values.data=flipData(values.data);if(values.data.data[0]!=undefined){$("#sec"+subTab+"-"+section).append(chartHeader);addBarChart(values,"container"+chart+"-"+subTab+"-"+section)}}});if(complexTable==true){var complexTableLabel={en:"Click on column headers to change table sorting. Pass cursor over commodity names and export restriction symbols for detailed definitions and explanations.",cn:"点击列标题改变表格排序。在商品名称和出口限制的符号上点击光标查询详细定义和解释。"};$("#sec"+subTab+"-"+section).append('<div class="helpTextComplexTable">'+complexTableLabel[lang]+"</div>");$("#sec"+subTab+"-"+section).append(addComplexTable(complexCharts,profileCountry));$.tablesorter.formatInt=function(s){var i=parseInt(s);return isNaN(i)?null:i};$.tablesorter.formatFloat=function(s){var i=parseFloat(s);return isNaN(i)?null:i};$(".complexTable").tablesorter({sortList:[[0,0]],headers:{1:{sorter:false}},textExtraction:function(node){var txt=$(node).text();txt=txt.replace("--","");txt=txt.replace("*","");return txt}})}}}function addSimpleTable(values,country,labels){var tableLabels={};tableLabels["fishery-innovation"]={0:'<span style="color:red">No</span>',1:'<span style="color:green">Yes</span>',2:'<span style="color:orange">at EU level</span>',3:'<span style="color:green">EU & national level</span>'};tableLabels["export-restrictions"]={1:'<span style="color:#a80606">Export prohibition</span>',2:'<span style="color:#e70a0d">Export quota</span>',3:'<span style="color:#e78b20">Export tax</span>',4:'<span style="color:#d3e729">Non-automatic licencing</span>',5:'<span style="color:#ca29e7">Other measures</span>',6:'<span style="color:#1ee723">No restrictions</span>'};var labels1={0:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle cx="6" cy="6" r="6" stroke="white" stroke-width="0" fill="red" /></svg>',1:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle cx="6" cy="6" r="6" stroke="white" stroke-width="0" fill="green" /></svg>'};if(labels){var selectedLabels=tableLabels[labels]}var title='<h5 class="simpleTableTitle"><table><tr><td>'+values.title+"</table></tr></td></h5>";var head='<table class="simpleTable">';var foot="</table>";var rows="";var data=getTableData(values.data);$.each(data,function(indicator,v){if(v[country.toUpperCase()]!=null){if(labels){rows=rows.concat("<tr><td>"+indicator+"</td><td>"+selectedLabels[v[country.toUpperCase()]]+"</td></tr>")}else{rows=rows.concat("<tr><td>"+indicator+"</td><td>"+v[country.toUpperCase()]+values.options.tooltipUnit+"</td></tr>")}}});return title+head+rows+foot}function addComplexTable(values,country){var tab=window.wizardConfig.project.tabs[window.page];var commodityLabels=window.wizardConfig.tabs[tab].labels;var purposeCodes=window.wizardConfig.tabs[tab].purposeCodes[country.toUpperCase()];var labels1={1:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#a80606" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',2:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#e70a0d" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',3:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#e78b20" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',4:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#d3e729" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',5:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#ca29e7" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',6:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#1ee723" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>'};var labels2={};labels2["en"]={1:"Export prohibition",2:"Export quota",3:"Export tax",4:"Non-automatic licencing",5:"Other measures",6:"No restrictions"};labels2["cn"]={1:"禁止出口",2:"出口配额",3:"出口税",4:"非自动许可",5:"其他措施",6:"无限制"};var labels3={};labels3["en"]={A:"conservation of natural resources",B:"control of foreign exchange",C:"generate revenue",D:"health or environmental protection",E:"monitor or control export activity",F:"promote further processing/value added",G:"protect local downstream industry",H:"safeguard domestic supply",I:"other",J:"no purpose found/indicated"};labels3["cn"]={A:"自然资源保护",B:"外汇管制",C:"创收",D:"健康或环境保护",E:"出口活动监管",F:"推动进一步处理/增值",G:"保护本地下游产业",H:"保障国内供应",I:"其他",J:"未发现/说明目的"};var labels4={en:"Commodity",cn:"商品"};var labels5={en:"purpose",cn:"目的"};var head='<table class="complexTable tablesorter"><thead><tr>'+"<th><span>"+labels4[lang]+"<span></th>"+"<th><span>"+values[0].title+"<span></th>"+"<th><span>"+values[1].title+"<span></th>"+"<th><span>"+values[2].title+"<span></th></tr></thead><tbody>";var foot="</tbody></table>";var rows="";var data=[];$.each(values,function(chart,content){data[chart]=getTableData(content.data)});$.each(data[0],function(indicator,v){var comLabel=[];if(commodityLabels.labels[indicator]){comLabel[0]=commodityLabels.labels[indicator].name;comLabel[1]=commodityLabels.labels[indicator].definition}else{comLabel[0]=indicator;comLabel[1]="--"}var restrictExplain=labels2[lang][v[country.toUpperCase()]];var purpCode;var purpCodeExplain=[];if(purposeCodes[indicator]){var purpCodeList=purposeCodes[indicator].split("");purpCode=" ("+purpCodeList+")";$.each(purpCodeList,function(keys,codeValue){purpCodeExplain.push(labels3[lang][codeValue])});restrictExplain=restrictExplain+" - "+labels5[lang]+": "+purpCodeExplain}else{purpCode=""}var valRow1;var valRow2;var labelRow1;var labelRow2;if(data[1][indicator]&&data[1][indicator][country.toUpperCase()]){valRow1=data[1][indicator][country.toUpperCase()];labelRow1=valRow1}else{valRow1=0;labelRow1="--"}if(data[2][indicator]&&data[2][indicator][country.toUpperCase()]){valRow2=data[2][indicator][country.toUpperCase()];labelRow2=valRow2}else{valRow2=0;labelRow2="--"}if(v[country.toUpperCase()]!=null){rows=rows.concat('<tr><td title="'+comLabel[1]+'">'+comLabel[0]+"</td>"+'<td title="'+restrictExplain+'">'+labels1[v[country.toUpperCase()]]+purpCode+"</td>"+"<td>"+'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+(valRow1+40)+'" height="13">'+'<rect width="'+valRow1+'" height="13" fill="#a2b9f0" y="0" x="0" stroke="white" stroke-width="0" />'+'<text text-anchor="start" x="'+(valRow1+4)+'" y="11"  font-family="Verdana" font-size="11" color="#636363">'+labelRow1+"</text>"+"</svg>"+"</td>"+"<td>"+'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+(valRow2+40)+'" height="13">'+'<rect width="'+valRow2+'" height="13" fill="#a2b9f0" y="0" x="0" stroke="white" stroke-width="0" />'+'<text text-anchor="start" x="'+(valRow2+4)+'" y="11"  font-family="Verdana" font-size="11" color="#636363">'+labelRow2+"</text>"+"</svg>"+"</td>"+"</tr>")}});return head+rows+foot}function ChartElement(){var self=this;var chart;self.loadChart=function(data,options){var newChart=new chartBasis(data,options);newChart.loadData();chart=newChart};self.displayCharts=function(container){chart.displayChart(container)}}function chartBasis(data,options){var self=this;var loadedData={};var defaults={highcharts:{chart:{backgroundColor:"transparent"},plotOptions:{series:{marker:{enabled:false,states:{hover:{enabled:true}}},pointPadding:0,borderWidth:0,connectNulls:true}},exporting:{enabled:false},legend:{enabled:false},credits:{enabled:false},title:{text:null},xAxis:{labels:{step:1,style:{fontSize:"1em"}}},yAxis:{title:{text:null}}},CYCoptions:{typeOfFirstSeries:null}};options=$.extend(true,defaults,options);self.loadData=function(){var Data=[];var categories=data.keys[1];$.each(data.keys[0],function(index,name){var dataPoints=data.data[index].map(function(y,i){if(y!=null){return{y:parseFloat(y.toFixed(options.CYCoptions.decimals)),id:categories[i],name:categories[i]}}else{return{y:null,id:categories[i]}}});Data.push({name:name,data:dataPoints})});if(options.CYCoptions.typeOfFirstSeries!=null){Data[0].type=options.CYCoptions.typeOfFirstSeries}loadedData={cats:categories,series:Data}};self.displayChart=function(container){var data=loadedData;if(data==null)return false;var seriesOptions={chart:{renderTo:container},xAxis:{categories:data.cats},series:data.series};options.highcharts=$.extend(true,options.highcharts,seriesOptions);new Highcharts.Chart(options.highcharts);return true}}function labelFormat(translatedLables){return function(){if(this.value.toUpperCase()in window.ISO3toFlags){var flag='<img  style="margin-bottom:4px" height=18px src="'+baseURL+"/flags.png?cr="+this.value.toUpperCase()+'">';return'<span style="margin-right:5px" >'+translatedLables[this.value.toLowerCase()]+"</span>"+flag}else{if(translatedLables[this.value.toLowerCase()]!=undefined){return'<span style="margin-right:5px" >'+translatedLables[this.value.toLowerCase()]+"</span>"}else{return'<span style="margin-right:5px" >'+this.value.toLowerCase()+"</span>"}}}}function tooltipFormat(values,translatedLables){return function(){if(translatedLables[this.x.toLowerCase()]!=undefined){var s="<b>"+translatedLables[this.x.toLowerCase()]+"</b>"}else{var s="<b>"+this.x+"</b>"}$.each(this.points,function(){s+="<br/>"+this.series.name+": "+this.y+" "+values.options.tooltipUnit});return s}}function addLineChart(values,container){Highcharts.setOptions({lang:{numericSymbols:null}});if(values.data.data[0]!=undefined){var sbars=new ChartElement;loadAndDisplayData()}function loadAndDisplayData(){sbars.loadChart(values.data,{highcharts:{chart:{type:"line"},legend:{enabled:true,verticalAlign:"top",padding:0,margin:10},plotOptions:{series:{markers:{enabled:false,states:{hover:{enabled:true}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{reversed:true,tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"},colors:["#de3a07","#408000","#dca2bf","#fdd14e","#730000","#ffa640","#234010","#6cc3d9","#4400ff","#f200a2","#750039","#33260d","#00e61f","#0099e6","#1f0073","#962c0b","#734939","#735c00","#00f2a2","#004996"]},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addLineStackedBarChart(values,container){if(values.data.data[0]!=undefined){var sbars=new ChartElement;loadAndDisplayData()}function loadAndDisplayData(){sbars.loadChart(values.data,{highcharts:{chart:{type:"column"},legend:{enabled:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{area:{stacking:"normal"},bar:{stacking:"normal"},column:{stacking:"normal"},series:{markers:{enabled:false,states:{hover:{enabled:true}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},
CYCoptions:{decimals:values.options.tooltipDecimals,typeOfFirstSeries:values.options.typeOfFirstSeries||"line"}});sbars.displayCharts(container)}}function addStackedAreaChart(values,container){if(values.data.data[0]!=undefined){var sbars=new ChartElement;loadAndDisplayData()}function loadAndDisplayData(){sbars.loadChart(values.data,{highcharts:{chart:{type:"area"},legend:{enabled:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{area:{stacking:"normal"},series:{markers:{enabled:false,states:{hover:{enabled:true}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addBarChart(values,container){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){values.data=sortDimension0(values.data,0,desc=true);sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:10},legend:{enabled:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:true,overflow:"none",crop:false,allowOverlap:true}}},yAxis:{labels:{enabled:false},gridLineWidth:0,min:values.options.minimum,max:values.options.maximum},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addBarChartFlag(values,container,translatedLabels){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){values.data=sortDimension0(values.data,0,desc=true);sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:10,marginLeft:150},legend:{enabled:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:true,overflow:"none",crop:false,allowOverlap:true}}},yAxis:{labels:{enabled:false},gridLineWidth:0,min:values.options.minimum,max:values.options.maximum},xAxis:{labels:{useHTML:true,formatter:labelFormat(translatedLabels)}},tooltip:{shared:true,useHTML:true,formatter:tooltipFormat(values,translatedLabels)}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addColumnChart(values,container){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){values.data=sortDimension0(values.data,0,desc=true);sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"column"},legend:{enabled:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:false,overflow:"none",crop:false,allowOverlap:true}}},yAxis:{min:values.options.minimum,max:values.options.maximum},colors:["#88b60f","#232323"],tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addBarsDiamondsChart(values,container){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){values.data=sortDimension0(values.data,0,desc=true);sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"line",marginBottom:20},legend:{enabled:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{marker:{enabled:true},lineWidth:0,states:{hover:{lineWidth:0,lineWidthPlus:0}}}},yAxis:{min:values.options.minimum,max:values.options.maximum},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{typeOfFirstSeries:"bar",decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addStackedColumnChart(values,container){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"column"},legend:{enabled:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{labels:{step:null}},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addStackedBarChart(values,container){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){values.data=sortDimension0sum(values.data,desc=true);sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:20},legend:{enabled:true,reversed:true,verticalAlign:"top",padding:0,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addPyramidRight(values,container){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){sbars.loadChart(flipData(values.data),{highcharts:{title:{text:"Men"},chart:{type:"bar"},legend:{enabled:true,reversed:true,verticalAlign:"bottom",padding:5,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"},series:{animation:false}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{opposite:true},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}function addPyramidLeft(values,container){var sbars=new ChartElement;loadAndDisplayData();function loadAndDisplayData(){sbars.loadChart(flipData(values.data),{highcharts:{title:{text:"Women"},chart:{type:"bar"},legend:{enabled:true,reversed:true,verticalAlign:"bottom",padding:5,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"},series:{animation:false}},xAxis:{},yAxis:{min:values.options.minimum,max:values.options.maximum,reversed:true},tooltip:{shared:true,useHTML:true,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td>'+'<td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}});sbars.displayCharts(container)}}
//# sourceMappingURL=mapWizardLayer.js.map