function filterLocation(d,filter){var parseFilter=[];$.each(filter,function(k,v){parseFilter.push(v.toUpperCase())});var newData={};return newData.title=d.title,newData.definition=d.definition,newData.options=d.options,newData.data={},newData.data.dimensions=d.data.dimensions,newData.data.keys=[],newData.data.keys[0]=[],newData.data.keys[1]=d.data.keys[1],newData.data.data=[],$.each(d.data.keys[0],function(key,value){if($.inArray(value.toUpperCase(),parseFilter)>-1){newData.data.keys[0].push(value.toUpperCase());var a=d.data.keys[0].indexOf(value);newData.data.data.push(d.data.data[a])}}),newData}function filterYear(d,filter){var newData={};newData.title=d.title,newData.definition=d.definition,newData.options=d.options,newData.data={},newData.data.dimensions=d.data.dimensions,newData.data.keys=[],newData.data.keys[0]=d.data.keys[0],newData.data.keys[1]=[],newData.data.data=[];var idxYear=[];return $.each(filter,function(key,value){idxYear.push(d.data.keys[1].indexOf(value)),newData.data.keys[1].push(value)}),$.each(newData.data.keys[0],function(key,cr){newData.data.data[key]=[],$.each(idxYear,function(yKey,value){newData.data.data[key].push(d.data.data[key][value])})}),newData}function flipData(d){var r={keys:d.keys.slice(0),dimensions:d.dimensions.slice(0)};return r.keys.reverse(),r.dimensions.reverse(),r.data=r.keys[0].map(function(k,i0){return r.keys[1].map(function(k,i1){return d.data[i1][i0]})}),r}function getHumanReadData(number,decimals,trimZeros){function decimalAdjust(type,value,exp){return void 0===exp||0==+exp?Math[type](value):(value=+value,exp=+exp,isNaN(value)||"number"!=typeof exp||exp%1!=0?NaN:(value=value.toString().split("e"),value=Math[type](+(value[0]+"e"+(value[1]?+value[1]-exp:-exp))),value=value.toString().split("e"),+(value[0]+"e"+(value[1]?+value[1]+exp:exp))))}function toFixed(number,decimals){var s=decimalAdjust("round",number,-decimals).toFixed(decimals);return trimZeros?s.replace(/\.0+$|(\..*?)0+$/,"$1"):s}if(void 0===decimals&&(decimals=0),decimals<0)return number;number=parseFloat(number);var abs=Math.abs(number);return abs>1e12?toFixed(number/1e12,decimals)+"&nbsp;"+window.lang_labels.trillion:abs>1e9?toFixed(number/1e9,decimals)+"&nbsp;"+window.lang_labels.billion:abs>1e6?toFixed(number/1e6,decimals)+"&nbsp;"+window.lang_labels.million:abs>1e5?toFixed(number/1e3,decimals)+"&nbsp;"+window.lang_labels.thousand:function(val){for(;/(\d+)(\d{3})/.test(val.toString());)val=val.toString().replace(/(\d+)(\d{3})/,"$1 $2");return val}(toFixed(number,decimals))}function sortDimension0(d,key1,desc){desc=desc||!0;var r={dimensions:d.dimensions,keys:d.keys.slice(0)},sorted=d.data.map(function(v,i){return{v:v,i:i}});return sorted.sort(function(a,b){return a.v[key1]==b.v[key1]?0:null==a.v[key1]?1:null==b.v[key1]?-1:a.v[key1]<b.v[key1]!=desc?-1:1}),r.data=sorted.map(function(v){return v.v}),r.keys[0]=sorted.map(function(v){return d.keys[0][v.i]}),r}function sortDimension0sum(d,desc){function add(a,b){return null==a?b:null==b?a:a+b}desc=desc||!0;var r={dimensions:d.dimensions,keys:d.keys.slice(0)},sorted=d.data.map(function(v,i){return{v:v,i:i}});return sorted.sort(function(a,b){return a.v.reduce(add,0)==b.v.reduce(add,0)?0:a.v.reduce(add,0)<b.v.reduce(add,0)!=desc?-1:1}),r.data=sorted.map(function(v){return v.v}),r.keys[0]=sorted.map(function(v){return d.keys[0][v.i]}),r}function sortDimension1(d,key0,desc){desc=desc||!0;var r={dimensions:d.dimensions,keys:d.keys.slice(0)},sorted=d.data[key0].map(function(v,i){return{v:v,i:i}});return sorted.sort(function(a,b){return a.v==b.v?0:null==a.v?1:null==b.v?-1:a.v<b.v!=desc?-1:1}),r.data=d.data.map(function(l){return sorted.map(function(v){return l[v.i]})}),r.keys[1]=sorted.map(function(v){return d.keys[1][v.i]}),r}function getLatestYearData(data){var newData={},latestYear=data.keys[1].length-1;return $.each(data.keys[0],function(key,value){for(newData[value]=[];null==data.data[data.keys[0].indexOf(value)][latestYear]&&latestYear>=0;)latestYear-=1;newData[value][0]=data.keys[1][latestYear],newData[value][1]=data.data[data.keys[0].indexOf(value)][latestYear],latestYear=data.keys[1].length-1}),newData}function getTableData(data){var newData={};return $.each(data.keys[1],function(key,value){newData[value]={},$.each(data.keys[0],function(k,v){newData[value][v]=data.data[data.keys[0].indexOf(v)][data.keys[1].indexOf(value)]})}),newData}function getMapData(wizardConfig,page,countrylist,Chart){function minValueLatest(series){var min=null;return $.each(series,function(k,v){null!=(v=v[1])&&(null==min?min=v:min>v&&(min=v))}),min}function maxValueLatest(series,arrayValue){var max=null;return $.each(series,function(k,v){null!=(v=v[arrayValue])&&(null==max?max=v:max<v&&(max=v))}),max}function getCountryData(series,group){var data={};return $.each(series,function(k,v){$.inArray(k,group)>-1&&(data[k]=v)}),data}var tab=wizardConfig.project.tabs[page],mapType=wizardConfig.tabs[tab].mapType,flowStatus=wizardConfig.tabs[tab].type,ConfigProject=function(wizardConfig,page){var tab=wizardConfig.project.tabs[page],charts=wizardConfig.tabs[tab].charts,pageCharts=[];return $.each(charts,function(k,v){pageCharts.push(wizardConfig.charts[v])}),pageCharts}(wizardConfig,page),DataforMap=[],DataforMap1=[],data={defaultLayer:null!=Chart?Math.max(0,wizardConfig.tabs[tab].charts.indexOf(Chart[0])):0};if("TwoIndicatorsSplitOnYears"==mapType){var labels=wizardConfig.tabs[tab].labels,key=0;$.each(labels.order,function(order,value){$.inArray(value,ConfigProject[0].data.keys[1])>-1&&(DataforMap[key]=filterYear(ConfigProject[0],[value]),labels.labels[value]?(DataforMap[key].title=labels.labels[value].name,DataforMap[key].unit=labels.labels[value].unit):(DataforMap[key].title=value,DataforMap[key].unit=""),DataforMap[key].code=value,DataforMap[key].definition=value,DataforMap[key].values=getCountryData(getLatestYearData(DataforMap[key].data),countrylist),ConfigProject[0].options.minimum&&null!=ConfigProject[0].options.minimum?DataforMap[key].min=ConfigProject[0].options.minimum:DataforMap[key].min=minValueLatest(DataforMap[key].values),ConfigProject[0].options.maximum&&null!=ConfigProject[0].options.maximum?DataforMap[key].max=ConfigProject[0].options.maximum:DataforMap[key].max=maxValueLatest(DataforMap[key].values,1),DataforMap[key].latestYear=maxValueLatest(DataforMap[key].values,0),key++)}),null!=ConfigProject[1]&&$.each(ConfigProject[1].data.keys[1],function(key,value){DataforMap1[key]=filterYear(ConfigProject[1],[value]),labels.labels[value]?DataforMap1[key].title=labels.labels[value].name:DataforMap1[key].title=value,DataforMap1[key].code=value,DataforMap1[key].definition=value,DataforMap1[key].values=getCountryData(getLatestYearData(DataforMap1[key].data),countrylist),ConfigProject[1].options.minimum&&null!=ConfigProject[1].options.minimum?DataforMap1[key].min=ConfigProject[1].options.minimum:DataforMap1[key].min=minValueLatest(DataforMap1[key].values),ConfigProject[1].options.maximum&&null!=ConfigProject[1].options.maximum?DataforMap1[key].max=ConfigProject[1].options.maximum:DataforMap1[key].max=maxValueLatest(DataforMap1[key].values,1),DataforMap1[key].latestYear=maxValueLatest(DataforMap1[key].values,0)})}else $.each(ConfigProject,function(chart,values){"flow"!=values.type&&DataforMap.push(function(){return mobx.observable({get id(){return chart},get title(){return values.title[lang]},get definition(){return values.definition[lang]},get options(){return values.options},get years(){return values.data.keys[1]},selectedYear:(window.location.search.match(/[?&]t=([^&]*)/)||["",null])[1],get data(){return(null===this.selectedYear?values:filterYear(values,[this.selectedYear])).data},get _values(){return getCountryData(getLatestYearData(this.data),countrylist)},get values(){if("mapRegion"in this.options){var v=$.extend({},this._values);return v[this.options.mapRegion]=getLatestYearData(this.data)[this.options.mapRegion],v}return this._values},get _min(){return this.options.minimum&&null!=this.options.minimum?this.options.minimum:minValueLatest(this._values)},get _max(){return this.options.maximum&&null!=this.options.maximum?this.options.maximum:maxValueLatest(this._values,1)},get latestYear(){return maxValueLatest(this._values,0)},get dMax(){return Math.max(Math.abs(this._min),Math.abs(this._max))},get dMin(){return-this.dMax},get minColor(){return quantize(this._min,this.dMin,this.dMax,MapColors.map(function(x,idx){return idx}))},get maxColor(){return quantize(this._max,this.dMin,this.dMax,MapColors.map(function(x,idx){return idx}))},get colors(){if(this.options.mapDivergent){if(this.minColor>0)return MapColors.slice(this.minColor);if(this.maxColor+1<MapColors.length)return MapColors.slice(0,this.maxColor+1)}return MapColors},get min(){return this.options.mapDivergent&&this.minColor>0?this.dMin+this.minColor*(this.dMax-this.dMin)/MapColors.length:this._min},get max(){return this.options.mapDivergent&&!(this.minColor>0)&&this.maxColor+1<MapColors.length?this.dMax-(MapColors.length-(this.maxColor+1))*(this.dMax-this.dMin)/MapColors.length:this._max}},{values:mobx.computed({keepAlive:!0}),min:mobx.computed({keepAlive:!0}),max:mobx.computed({keepAlive:!0}),colors:mobx.computed({keepAlive:!0}),latestYear:mobx.computed({keepAlive:!0})},{deep:!1,name:"map"})}())});return data.map=DataforMap,data.map1=DataforMap1,data.flow=flowStatus,mobx.observable({defaultLayer:data.defaultLayer,get map(){return data.map},get map1(){return data.map1},get flow(){return data.flow}},{},{deep:!1,name:"DataforMapAll"})}function getIndicatorColorScale(d,dMin,dMax,feature,colors){return $.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1?quantize(d,dMin,dMax,colors):landmass}function quantize(d,dMin,dMax,range){return range[function(d,dMin,dMax,scaleMin,scaleMax){var i=Math.floor((d-dMin)/(dMax-dMin)*(scaleMax-scaleMin+1))+scaleMin;return i<scaleMin?scaleMin:i>scaleMax?scaleMax:i}(d,dMin,dMax,0,range.length-1)]}function getBubbleSize(d,dMax,feature){if(null==d||d<=0)return null;var radius=25*Math.sqrt(d/dMax);return radius<3&&(radius=3),radius}function getDisputedLines(lines,group){var disputedLinesNew={type:"FeatureCollection",features:[]};return($.inArray("ind",group)>-1||$.inArray("chn",group)>-1||$.inArray("pak",group)>-1)&&$.each(lines.features,function(k,feature){"IndiaChinaPakistan"==feature.properties.SOVEREIGNT&&disputedLinesNew.features.push(feature)}),($.inArray("ind",group)>-1||$.inArray("chn",group)>-1)&&$.each(lines.features,function(k,feature){"IndiaChina"==feature.properties.SOVEREIGNT&&disputedLinesNew.features.push(feature)}),($.inArray("egy",group)>-1||$.inArray("sdn",group)>-1)&&$.each(lines.features,function(k,feature){"EgyptSudan"==feature.properties.SOVEREIGNT&&disputedLinesNew.features.push(feature)}),($.inArray("sdn",group)>-1||$.inArray("ssd",group)>-1)&&$.each(lines.features,function(k,feature){"Sudan"==feature.properties.SOVEREIGNT&&disputedLinesNew.features.push(feature)}),($.inArray("ken",group)>-1||$.inArray("som",group)>-1)&&$.each(lines.features,function(k,feature){"KenyaSom"==feature.properties.SOVEREIGNT&&disputedLinesNew.features.push(feature)}),disputedLinesNew}function getMapSubPoints(mapCentroides){if("ecb"!=themeURL){var mapSubPoints={type:"FeatureCollection",features:[]},smallIslands=["AND","ATG","AIA","ASM","ABW","ALA","BRB","BLM","BMU","BVT","CCK","COK","CPV","CUW","CXR","DMA","FLK","FSM","GRD","GGY","GIB","GLP","SGS","GUM","HKG","IMN","JEY","KIR","COM","KNA","CYM","LCA","LIE","MCO","MAF","MHL","MAC","MNP","MTQ","MSR","MLT","MUS","MDV","NFK","NRU","NIU","PYF","SPM","PCN","PRI","PLW","REU","SYC","SHN","SJM","SMR","STP","SXM","TCA","ATF","TKL","TON","TTO","TUV","VAT","VCT","VGB","VIR","WLF","WSM","MYT","ANT"];return $(mapCentroides.features).each(function(feature){$.inArray(this.properties[mapCode],smallIslands)>-1&&mapSubPoints.features.push(this)}),mapSubPoints}}function addMapLayers(bubbleMap,mapdataviz,flowStatus){var bubbles=[],layerName=[];if("multiColored"==bubbleMap){L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:!1}).addTo(mapdataviz);var i=0,matchIndex=[];$.each(DataforMap,function(key,value){if($.each(DataforMap1,function(key1,value1){value1.title==value.title&&(matchIndex[key]=key1+1)}),matchIndex[key])var colorIndicator=DataforMap1[matchIndex[key]-1];else var colorIndicator=null;bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSizeColorGeneric(value,colorIndicator),onEachFeature:highlightAndPopup}),layerName[$("<div>").html(DataforMap[i].title).text()]=bubbles[i],i++}),bubbles[0].addTo(mapdataviz),updateMultiLegend(DataforMap[0],"size"),updateMultiLegend(DataforMap1[matchIndex[0]-1],"color"),window.mapLayerIndex=0,window.mapLayerMatchIndex=matchIndex,DataforMap.length>1&&($(window).width()<750?L.control.layers(layerName,null,{collapsed:!0}).addTo(mapdataviz):L.control.layers(layerName,null,{collapsed:!1}).addTo(mapdataviz)),$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();updateMultiLegend(DataforMap[index],"size"),updateMultiLegend(DataforMap1[matchIndex[index]-1],"color"),mapdataviz.closePopup(),window.mapLayerIndex=index})}else if("colored"==bubbleMap){for(L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:!1}).addTo(mapdataviz),i=0;i<DataforMap.length-1;i++)bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSizeColorGeneric(DataforMap[0],DataforMap[i+1]),onEachFeature:highlightAndPopup}),layerName[$("<div>").html(DataforMap[i+1].title).text()]=bubbles[i];bubbles[0].addTo(mapdataviz),updateLegend(DataforMap[0],"size"),updateLegend(DataforMap[1],"color"),DataforMap.length-1>1&&($(window).width()<750?L.control.layers(layerName,null,{collapsed:!0}).addTo(mapdataviz):L.control.layers(layerName,null,{collapsed:!1}).addTo(mapdataviz)),$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();updateLegend(DataforMap[index+1],"color")})}else if("coloredPairUnpair"==bubbleMap){for(L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:!1}).addTo(mapdataviz),i=0;i<DataforMap.length/2;i++)bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSizeColorGeneric(DataforMap[2*i],DataforMap[2*i+1]),onEachFeature:highlightAndPopup}),layerName[$("<div>").html(DataforMap[2*i].title).text()]=bubbles[i];bubbles[0].addTo(mapdataviz),updateLegend(DataforMap[0],"size"),updateLegend(DataforMap[1],"color"),DataforMap.length-1>1&&($(window).width()<750?L.control.layers(layerName,null,{collapsed:!0}).addTo(mapdataviz):L.control.layers(layerName,null,{collapsed:!1}).addTo(mapdataviz)),$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();updateLegend(DataforMap[2*index],"size"),updateLegend(DataforMap[2*index+1],"color")})}else if("simple"==bubbleMap){for(L.geoJson(mapShapes,{style:getBasicCountryShapesStyle,clickable:!1}).addTo(mapdataviz),i=0;i<DataforMap.length;i++)bubbles[i]=L.geoJson(mapCentroides,{pointToLayer:bubblesSimpleGeneric(DataforMap[i]),onEachFeature:highlightAndPopup}),layerName[$("<div>").html(DataforMap[i].title).text()]=bubbles[i];bubbles[0].addTo(mapdataviz),"flow"==flowStatus?(updateLegend(DataforMap[0],"flows"),updateFlowData(DataforMap[0].code),window.maxBubble=DataforMap[0].max):updateLegend(DataforMap[0],"size"),DataforMap.length>1&&($(window).width()<750?L.control.layers(layerName,null,{collapsed:!0}).addTo(mapdataviz):L.control.layers(layerName,null,{collapsed:!1}).addTo(mapdataviz)),$(".leaflet-control-layers-selector").click(function(){var index=$(this).parent().index();"flow"==flowStatus?(updateFlowData(DataforMap[index].code),clearFlows(),clearFlowLegend(),updateLegend(DataforMap[index],"flows"),window.maxBubble=DataforMap[index].max):updateLegend(DataforMap[index],"size")})}else{var shapes=[],layerGroup=[],mapSubPoints=getMapSubPoints(mapCentroides);DataforMap.forEach(function(data,i){runOnce("createGeoJson"+i,function(){shapes[i]=L.geoJson(mapShapes,{style:getColorCountryShapesStyleGeneric(DataforMap[i]),onEachFeature:highlightAndPopup,clickable:!1}),void 0!=mapSubPoints?(bubbles[i]=L.geoJson(mapSubPoints,{pointToLayer:bubblesSimpleColorGeneric(DataforMap[i]),onEachFeature:highlightAndPopup}),layerGroup[i]=L.layerGroup([shapes[i],bubbles[i]])):layerGroup[i]=L.layerGroup([shapes[i]]),L.stamp(layerGroup[i])},function(){layerGroup[i].eachLayer(function(feature){feature.setStyle(getColorCountryShapesStyleGeneric(DataforMap[i]))})}),layerName[$("<div>").html(DataforMap[i].title).text()]=layerGroup[i]}),runOnce("addDefaultLayer",function(){layerGroup[DataforMapAll.defaultLayer].addTo(mapdataviz),DataforMap.length>1&&($(window).width()<750||2==embed?L.control.layers(layerName,null,{collapsed:!0}).addTo(mapdataviz):L.control.layers(layerName,null,{collapsed:!1}).addTo(mapdataviz))}),$(".leaflet-control-layers-selector").click(mobx.action("layer",function(){var index=$(this).parent().index();DataforMapAll.defaultLayer=index})),mobx.autorun(function(){updateLegend(DataforMap[DataforMapAll.defaultLayer],"color")},{name:"updateLegend"})}}function runOnce(name,f1,f2){mobx.autorun(function(done){return function(reaction){done?f2&&f2():(done=!0,f1(),f2||reaction.dispose())}}(!1),{name:name})}function textColor(hex){var match=hex.match(/^#(..)(..)(..)$/);if(match){var rgb=match.slice(1).map(function(s){return parseInt(s,16)/255});return(Math.min.apply(null,rgb)+Math.max.apply(null,rgb))/2<.5?"#fff":"#000"}return"#000"}function updateLegend(Data,mode){function playStart(){var button=$("div.sliderWrapper input");window.clearInterval(button.data("timer")),button.data("timer",0),button.val(STOP),button.data("timer",window.setInterval(playStep,1e3)),playStep(0)}function playStop(){var button=$("div.sliderWrapper input");button.val(PLAY),window.clearInterval(button.data("timer")),button.data("timer",0)}function playStep(pos){var el=$('div[name="sliderMapColor"]'),options=el.slider("option");"number"!=typeof pos&&(pos=el.slider("value")+1),pos>options.max?playStop():el.slider("value",pos)}if("color"==mode)if(Data){var colors=Data.colors;$("#legendMinColor").parent().parent().empty().append(colors.map(function(color,idx,colors){var el=$("<li>");return 0===idx?(el.addClass("firstLegendElement"),el.append($('<span id="legendMinColor" class="firstLegendElement">').css("background",color).css("color",textColor(color)))):idx+1===colors.length?(el.addClass("lastLegendElement"),el.append($('<span id="legendMaxColor" class="lastLegendElement">').css("background",color).css("color",textColor(color)))):el.append($("<span>").css("background",color)),el})),$("#legendMaxColor").html(getHumanReadData(Data.max,Data.options.tooltipDecimals)),$("#legendMinColor").html(getHumanReadData(Data.min,Data.options.tooltipDecimals)),$("#legendTitleColor").text($("<div>").html(Data.title).text());var sliderHeight=null!==Data.selectedYear?23:0;if("mapRegion"in Data.options&&""!=Data.options.mapRegion&&Data.values[Data.options.mapRegion]){var subtext=lang_countries[Data.options.mapRegion.toLowerCase()]+": "+getHumanReadData(Data.values[Data.options.mapRegion][1],Data.options.tooltipDecimals);""!=Data.options.tooltipUnit&&(subtext+=" "+Data.options.tooltipUnit),Data.values[Data.options.mapRegion][0]!=Data.latestYear&&(subtext+=" ("+Data.values[Data.options.mapRegion][0]+")"),$("#legendSubtextColor").html(subtext),$("#legendSubtextColor").show(),"mapSource"in lang_labels?$("#topContainer").css("height",66+sliderHeight):$("#topContainer").css("height",58+sliderHeight)}else"mapSource"in lang_labels&&$("#topContainer").css("height",58+sliderHeight),$("#legendSubtextColor").hide();window.relatedDataControl&&window.relatedDataControl.updateColors(function(id){return Data.values[id]&&quantize(Data.values[id][1],Data.min,Data.max,Data.colors)}),""!=Data.options.tooltipUnit?$("#legendUnitColor").text(", "+Data.options.tooltipUnit):$("#legendUnitColor").text(""),$("#legendYearColor").text(Data.latestYear);var sliderCreated=void 0!==$('div[name="sliderMapColor"]').slider("instance");if(null!==Data.selectedYear){$("div.sliderWrapper").show();var PLAY="▶",STOP="◾";sliderCreated||($('div[name="sliderMapColor"]').slider({max:1,disabled:!0}),$("div.sliderWrapper input").val(PLAY),$("div.sliderWrapper input").off("click").click(function(){$(this).val()!==PLAY?playStop():playStart()})),$('div[name="sliderMapColor"]').slider("option",{start:function(){playStop()},change:mobx.action("slider",function(ev,ui){ev.originalTarget&&playStop(),Data.selectedYear=Data.years[ui.value]})}),$('div[name="sliderMapColor"]').slider("option",{max:Data.years.length-1,value:(Data.years.length+Data.years.indexOf(Data.selectedYear))%Data.years.length,disabled:!1})}else sliderCreated&&$('div[name="sliderMapColor"]').slider("destroy"),$("div.sliderWrapper").hide()}else $("#legendMaxColor").html(""),$("#legendMinColor").html(""),$("#legendTitleColor").text("No data available"),$("#legendUnitColor").text(""),$("#legendYearColor").text("");else"flows"==mode?Data?($("#legendBubble").html(window.lang_labels.min+": "+getHumanReadData(Data.min,Data.options.tooltipDecimals)+" - "+window.lang_labels.max+": "+getHumanReadData(Data.max,Data.options.tooltipDecimals)),$("#legendTitleSize").text($("<div>").html(Data.title).text()),""!=Data.options.tooltipUnit?$("#legendUnitSize").text(", "+Data.options.tooltipUnit):$("#legendUnitSize").text(""),$("#legendYearSize").text("")):($("#legendBubble").html(""),$("#legendTitleSize").text("No data available"),$("#legendUnitSize").text(""),$("#legendYearSize").text("")):Data?($("#legendBubble").html(window.lang_labels.min+": "+getHumanReadData(Data.min,Data.options.tooltipDecimals)+" - "+window.lang_labels.max+": "+getHumanReadData(Data.max,Data.options.tooltipDecimals)),$("#legendTitleSize").text($("<div>").html(Data.title).text()),""!=Data.options.tooltipUnit?$("#legendUnitSize").text(", "+Data.options.tooltipUnit):$("#legendUnitSize").text(""),$("#legendYearSize").text(Data.latestYear)):($("#legendBubble").html(""),$("#legendTitleSize").text("No data available"),$("#legendUnitSize").text(""),$("#legendYearSize").text(""));$("#flowLayer .commodity").text(Data.title)}function updateMultiLegend(Data,mode){"color"==mode?Data?($("#legendMaxColor").html(getHumanReadData(Data.max,Data.options.tooltipDecimals)),$("#legendMinColor").html(getHumanReadData(Data.min,Data.options.tooltipDecimals)),$("#legendTitleColor").text($("<div>").html(Data.title).text()),""!=Data.options.tooltipUnit?$("#legendUnitColor").text(", "+Data.unit):$("#legendUnitColor").text(""),$("#legendYearColor").text("")):($("#legendMaxColor").html(""),$("#legendMinColor").html(""),$("#legendTitleColor").text("No data available"),$("#legendUnitColor").text(""),$("#legendYearColor").text("")):Data?($("#legendBubble").html(window.lang_labels.min+": "+getHumanReadData(Data.min,Data.options.tooltipDecimals)+" - "+window.lang_labels.max+": "+getHumanReadData(Data.max,Data.options.tooltipDecimals)),$("#legendTitleSize").text($("<div>").html(Data.title).text()),""!=Data.options.tooltipUnit?$("#legendUnitSize").text(", "+Data.unit):$("#legendUnitSize").text(""),$("#legendYearColor").text("")):($("#legendBubble").html(""),$("#legendTitleSize").text("No data available"),$("#legendUnitSize").text(""),$("#legendYearSize").text(""))}function setLegend(chartType,bubbleMap){"colored"==bubbleMap||"multiColored"==bubbleMap||"coloredPairUnpair"==bubbleMap?$("#textLegend").hide():"simple"==bubbleMap?($("#colorLegend").hide(),"mapWizard"==chartType&&($("#textLegend").hide(),$("#sizeLegend").css({width:"100%"}))):($("#sizeLegend").hide(),"mapWizard"==chartType&&($("#textLegend").hide(),$("#colorLegend").css({width:"100%"})))}function getColorCountryShapesStyleGeneric(layerData){return function(feature){return feature&&feature.properties&&null!=layerData.values[feature.properties[mapCode]]?{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:getIndicatorColorScale(layerData.values[feature.properties[mapCode]][1],layerData.min,layerData.max,feature,layerData.colors)||landmassNA,className:"hasValue"}:feature&&feature.properties&&$.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1?{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:landmassNA,className:"hasValue"}:feature&&feature.properties&&$.inArray(feature.properties[mapCode].toString().toLowerCase(),["aut","bel","cyp","deu","esp","est","fin","fra","grc","irl","ita","ltu","lux","lva","mlt","nld","prt","svk","svn"])>-1?{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:"#004996",className:"hasValue"}:feature&&feature.properties&&feature.properties[mapCode]?{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:landmass,className:"hasValue"}:{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:landmassGroup,className:"hasValue"}}}function bubblesSimpleGeneric(Data){return function(feature,latlng){return L.circleMarker(latlng,getBubbleStyleGeneric(feature,Data))}}function bubblesSimpleColorGeneric(colorData){return function(feature,latlng){return L.circleMarker(latlng,getBubbleColorGeneric(feature,colorData))}}function bubblesSizeColorGeneric(sizeData,colorData){return function(feature,latlng){return L.circleMarker(latlng,getBubbleSizeColorGeneric(feature,sizeData,colorData))}}function getBubbleStyleGeneric(feature,layerData){var bubbleColor;if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1&&null!=layerData.values[feature.properties[mapCode]]&&(bubbleColor=bubbleDefaultColor,null!=layerData.values[feature.properties[mapCode]])){var radius=getBubbleSize(layerData.values[feature.properties[mapCode]][1],layerData.max,feature);if(null!=radius)return{radius:radius,fillColor:bubbleColor,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1}}return{radius:0,opacity:0}}function getBubbleSizeColorGeneric(feature,sizeData,colorData){var bubbleColor;if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1&&null!=sizeData.values[feature.properties[mapCode]])if(radius=getBubbleSize(sizeData.values[feature.properties[mapCode]][1],sizeData.max,feature),null!=colorData){if(null!=colorData.values[feature.properties[mapCode]]){var bubbleColor=getIndicatorColorScale(colorData.values[feature.properties[mapCode]][1],colorData.min,colorData.max,feature,colorData.colors);if(null!=radius)return{radius:radius,fillColor:bubbleColor,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1}}}else if(null!=radius)return{radius:radius,fillColor:bubbleDefaultBorder,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1};return{radius:0,opacity:0}}function getBubbleColorGeneric(feature,colorData){var bubbleColor;if($.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1&&(radius=5,null!=colorData.values[feature.properties[mapCode]])){var bubbleColor=getIndicatorColorScale(colorData.values[feature.properties[mapCode]][1],colorData.min,colorData.max,feature,colorData.colors);if(null!=radius)return{radius:radius,fillColor:bubbleColor,color:bubbleDefaultBorder,weight:1,opacity:1,fillOpacity:1}}return{radius:0,opacity:0}}function getBasicCountryShapesStyle(feature){return{weight:landmassBorderWidth,opacity:1,color:landmassBorder,fillOpacity:1,fillColor:function(feature){return $.inArray(feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1?landmassGroup:landmass}(feature)}}function highlightAndPopup(feature,layer){if(feature&&feature.properties&&feature.properties[mapCode]){var interaction;interaction="flow"==window.flowStatus?clickFlow:highlightAndPopupClick;var inEuroArea=feature&&feature.properties&&$.inArray(feature.properties[mapCode].toString().toLowerCase(),["aut","bel","cyp","deu","esp","est","fin","fra","grc","irl","ita","ltu","lux","lva","mlt","nld","prt","svk","svn"])>-1;("ecb"==themeURL&&!inEuroArea||$.inArray(layer.feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1)&&(layer.on({click:interaction,mouseover:function(){layer.inFront||(layer.inFront=!0,layer.setStyle({fillOpacity:.8,weight:2,color:null!=bubbleMap?bubbleHighlightBorder:shapeHighlightBorder}).bringToFront())},mouseout:function(){layer.inFront=!1,layer.setStyle({fillOpacity:1,weight:landmassBorderWidth,color:null!=bubbleMap?bubbleDefaultBorder:landmassBorder}),"undefined"!=typeof disputedLines&&disputedLines.bringToFront(),void 0!==flowGroup&&flowGroup.eachLayer(function(layer){layer.bringToFront?layer.bringToFront():layer.eachLayer(function(sublayer){sublayer.bringToFront()})})}}),layer.eachLayer?layer.eachLayer(function(sublayer){L.Util.setOptions(sublayer,{clickable:!0})}):L.Util.setOptions(layer,{clickable:!0}))}}function clickFlow(e){var layer=e.target,layerCode=layer.feature.properties[mapCode],color=["blue","blue","blue"];clearFlows(),activeLayer!=layerCode&&$.inArray(layerCode.toLowerCase(),MapGroup)>-1?(addLines({center:layerCode,stars:getFlows(layerCode)},color[colorIdx],centroides,mapdataviz),colorIdx=(colorIdx+1)%3,activeLayer=layerCode,updateFlowLegend(layerCode)):activeLayer=""}function clearFlows(){flowGroup.clearLayers().addTo(mapdataviz)}function getFlows(country){function getLineSize(d,max){return null==d||d<=0?null:25*Math.sqrt(d/max)}var data=window.DataforFlow,idxCountry=data.keys[0].indexOf(country.toUpperCase()),newData={},max=0;return $.each(data.keys[1],function(key,value){var crData=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];max<crData&&(max=crData)}),$.each(data.keys[1],function(key,value){var crData1=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];newData[value]=crData1/max>.01?getLineSize(crData1,window.maxBubble):0}),newData}function clearFlowLegend(){$("#flowLayer .helptext").show(),$("#flowLayer #detailsTable").hide(),$("#flowLayer .countryPrefix").text(""),$("#flowLayer .country").html("")}function updateFlowLegend(layerCode){var flowLabels={tableHead1:{en:"Main export destinations",cn:"主要出口目的地"},tableHead2:{en:"USD Millions",cn:"百万美元"},world:{en:"World",cn:"世界"},unspecified:{en:"unspecified",cn:"未标明"},asia:{en:"Asia n.e.s.",cn:"亚洲n.e.s."},headlinePrefix:{en:"Exports from ",cn:"从"},headlineSuffix:{en:"",cn:"的出口"}};null!=window.lang_countries[layerCode.toLowerCase()]?$("#flowLayer .country").html(window.lang_countries[layerCode.toLowerCase()]):$("#flowLayer .country").html(layerCode),$("#flowLayer #countryPrefix").text(flowLabels.headlinePrefix[lang]),$("#flowLayer #countrySuffix").text(flowLabels.headlineSuffix[lang]),$("#flowLayer .helptext").hide(),$("#flowLayer #detailsTable").show(),$("#flowLayer #detailsTable thead .countries").text(flowLabels.tableHead1[lang]),$("#flowLayer #detailsTable thead .values").text(flowLabels.tableHead2[lang]),$("#flowLayer #detailsTable tbody").remove(),$("#flowLayer #detailsTable").append("<tbody>");var legendData=function(country){var data=window.DataforFlow,idxCountry=data.keys[0].indexOf(country.toUpperCase()),newData={};newData.rank=[],newData.values={};var max=0;return $.each(data.keys[1],function(key,value){var crData=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];max<crData&&(max=crData)}),$.each(data.keys[1],function(key,value){var crData1=data.data[idxCountry][data.keys[1].indexOf(value.toUpperCase())][0];crData1/max>.01&&(newData.values[crData1]=value,newData.rank.push(crData1))}),newData.rank.sort(function(a,b){return b-a}),newData}(layerCode);$.each(legendData.rank,function(key,value){null!=window.lang_countries[legendData.values[value].toLowerCase()]?country=window.lang_countries[legendData.values[value].toLowerCase()]:"WLD"==legendData.values[value]?country=flowLabels.world[lang]:"UNSPE"==legendData.values[value]?country=flowLabels.unspecified[lang]:"XCD"==legendData.values[value]?country=flowLabels.asia[lang]:country=legendData.values[value],$("#flowLayer #detailsTable tbody").append("<tr><td>"+country+'</td><td  class="tableValues">'+Math.round(value/1e6)+"</td>")})}function addLines(flow,color,centros,mapdataviz){var stars={}
;$.each(flow.stars,function(country,value){void 0!=centros[country.toUpperCase()]&&(stars[country]={},stars[country].latlong=[parseFloat(centros[country.toUpperCase()].Lat),parseFloat(centros[country.toUpperCase()].Long)],stars[country].value=value)});var center=[parseFloat(centros[flow.center.toUpperCase()].Lat),parseFloat(centros[flow.center.toUpperCase()].Long)];$.each(stars,function(country,values){var lines=L.polyline([center,values.latlong],{color:color,weight:values.value,fill:"blue"});flowGroup.addLayer(lines)})}function updateFlowData(indicator){function ajaxSuccess(data){null!=data?window.DataforFlow=data:alert("No data available.")}$.ajax({dataType:"json",url:baseURL+"/api-data?project="+project+"&id="+indicator,success:ajaxSuccess,error:function(xhr,ajaxOptions,thrownError){"404"==xhr.status&&alert("No data available.")}})}function mapTeaserText(country){var euGroup=["aut","bel","bgr","cyp","deu","dnk","esp","fin","fra","gbr","grc","hrv","irl","ita","lux","lva","ltu","mlt","nld","prt","swe","cze","est","hun","pol","svk","svn","rou"],teaser=$("<div>"),teaserTitle=$('<h3 class="tooltipTitle">'),teaserTable=$('<table class="tooltipTable">');teaser.append(teaserTitle);var countryProfile=$('<div class="countryProfilLink">').append($('<span id="countryProfileMap">').attr("value",country).html(lang_labels.countryProfile));"undefined"!=typeof wizardConfig&&"withEU"==wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes&&$.inArray(country.toString().toLowerCase(),euGroup)>-1&&countryProfile.append('<span value="eu" id="euProfileMap">view EU profile</span>'),teaser.append(countryProfile);var countryName=lang_countries[country.toString().toLowerCase()]||ISO3toFlags[country]||country;teaserTitle.text(countryName);for(var tableLineCanvas,tooltipData,dataValue,hasData=!1,i=0;i<ChartsWithData;i++)null!=DataforMap[i]&&(tableLineCanvas=$("<tr>").append($("<td>").attr("title",$("<div>").html(DataforMap[i].definition).text()).html(DataforMap[i].title)),tooltipData=$('<td class="tooltipData">'),tableLineCanvas.append(tooltipData),void 0!=DataforMap[i].values[country]&&null!=DataforMap[i].values[country][1]?(hasData=!0,dataValue=getHumanReadData(DataforMap[i].values[country][1],DataforMap[i].options.tooltipDecimals)+"&nbsp;"+DataforMap[i].options.tooltipUnit,DataforMap[i].values[country][0]!=DataforMap[i].latestYear&&(dataValue+="&nbsp;("+DataforMap[i].values[country][0]+")"),tooltipData.html(dataValue)):tooltipData.text("—"),teaserTable.append(tableLineCanvas));return(hasData||"ecb"!=themeURL)&&teaserTitle.after(teaserTable),teaser[0]}function mapTeaserTextMulti(country){var euGroup=["aut","bel","bgr","cyp","deu","dnk","esp","fin","fra","gbr","grc","hrv","irl","ita","lux","lva","ltu","mlt","nld","prt","swe","cze","est","hun","pol","svk","svn","rou"];if("undefined"!=typeof wizardConfig&&"withEU"==wizardConfig.tabs[wizardConfig.project.tabs[page]].countrynotes&&$.inArray(country.toString().toLowerCase(),euGroup)>-1)var countryProfile="<div class='countryProfilLink'><span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span><span value='eu' id='euProfileMap' >view EU profile</span></div>";else var countryProfile="<div class='countryProfilLink'><span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span></div>";if(null!=lang_countries[country.toString().toLowerCase()])var countryName=lang_countries[country.toString().toLowerCase()]+" - "+DataforMap[mapLayerIndex].title;else var countryName=country+" - "+DataforMap[mapLayerIndex].title;var tableLines,tableLine=[];return tableLine[0]="<tr><td>"+DataforMap[mapLayerIndex].options.tooltipUnit+"</td><td class='tooltipData'>"+getHumanReadData(DataforMap[mapLayerIndex].values[country][1])+"</td></tr>",DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]?tableLine[1]="<tr><td>"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1].options.tooltipUnit+"</td><td class='tooltipData'>"+getHumanReadData(DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1].values[country][1])+"</td></tr>":tableLine[1]="<tr><td></td><td></td></tr>",tableLines=tableLine[0]+tableLine[1],'<h3 class="tooltipTitle">'+countryName+'</h3><table class="tooltipTable">'+tableLines+"</td></tr></table>"+countryProfile}function mapTeaserExportRestrictions(country){var labels2={};labels2.en={1:"export prohibition",2:"export quota",3:"export tax",4:"non-automatic licencing",5:"other measures",6:"no restrictions",undefined:"not reseached"},labels2.cn={1:"禁止出口",2:"出口配额",3:"出口税",4:"非自动许可",5:"其他措施",6:"无限制",undefined:"没有研究"};var tableLines,countryProfile="<div class='countryProfilLink'><span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span></div>",countryName=lang_countries[country.toLowerCase()]+" - "+DataforMap[mapLayerIndex].title,tableLine=[];return DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1]?(tableLine[0]="<tr><td>"+DataforMap[mapLayerIndex].options.tooltipUnit+":</td><td class='tooltipData'>"+getHumanReadData(DataforMap[mapLayerIndex].values[country][1])+" "+DataforMap[mapLayerIndex].unit+"</td></tr>",tableLine[1]="<tr><td>"+DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1].options.tooltipUnit+":</td><td class='tooltipData'>"+labels2[lang][DataforMap1[mapLayerMatchIndex[mapLayerIndex]-1].values[country][1]]+"</td></tr>"):(tableLine[0]="<tr><td>"+DataforMap[mapLayerIndex].options.tooltipUnit+":</td><td class='tooltipData'>"+labels2[lang][DataforMap[mapLayerIndex].values[country][1]]+"</td></tr>",tableLine[1]="<tr><td></td><td></td></tr>"),tableLines=tableLine[0]+tableLine[1],'<h3 class="tooltipTitle">'+countryName+'</h3><table class="tooltipTable">'+tableLines+"</td></tr></table>"+countryProfile}function mapTeaserExportRestrictionsMain(country){var labels2={};labels2.en={1:"export prohibition",2:"export quota",3:"export tax",4:"non-automatic licencing",5:"other measures",6:"no restrictions",undefined:"not reseached"},labels2.cn={1:"禁止出口",2:"出口配额",3:"出口税",4:"非自动许可",5:"其他措施",6:"无限制",undefined:"没有研究"};var tableLines,countryProfile="<div class='countryProfilLink'><span value='"+country+"' id='countryProfileMap'>"+lang_labels.countryProfile+"</span></div>",countryName=lang_countries[country.toLowerCase()],tableLineCanvas=[],tooltipData=[];return tableLineCanvas[0]="<tr><td title='"+DataforMap[0].definition+"'>"+DataforMap[0].title+":</td><td class='tooltipData'>",tooltipData[0]=labels2[lang][DataforMap[0].values[country][1]],tableLines=tableLineCanvas[0]+tooltipData[0],'<h3 class="tooltipTitle">'+countryName+'</h3><table class="tooltipTable">'+tableLines+"</td></tr></table>"+countryProfile}function mapTeaserIfiCountryData(country,links){var teaser=$("<div>"),teaserTitle=$('<h3 class="tooltipTitle">'),teaserTable=$('<table class="tooltipTable">');teaser.append(teaserTitle);var link=links[country.toString().toLowerCase()];if(null!=link){var countryProfile=$('<div style="text-align: center;">').append($('<a target="_blank">').attr("href",link).text(lang_labels.countryProfile));teaser.append(countryProfile)}var countryName=lang_countries[country.toString().toLowerCase()]||country;teaserTitle.text(countryName);for(var tableLineCanvas,tooltipData,dataValue,unit,i=0;i<ChartsWithData;i++)null!=DataforMap[i]&&(tableLineCanvas=$("<tr>").append($("<td>").attr("title",$("<div>").html(DataforMap[i].definition).text()).html(DataforMap[i].title)),tooltipData=$('<td class="tooltipData">'),tableLineCanvas.append(tooltipData),void 0!=DataforMap[i].values[country]&&null!=DataforMap[i].values[country][1]?(!0,dataValue=getHumanReadData(DataforMap[i].values[country][1],DataforMap[i].options.tooltipDecimals),unit=DataforMap[i].options.tooltipUnit||"",""!==unit&&(dataValue+="&nbsp;"+unit),DataforMap[i].values[country][0]!=DataforMap[i].latestYear&&(dataValue+="&nbsp;("+DataforMap[i].values[country][0]+")"),tooltipData.html(dataValue)):tooltipData.text("—"),teaserTable.append(tableLineCanvas));return teaserTitle.after(teaserTable),teaser[0]}function largeContainer(){$("#topContainer").css({height:"auto"}),$("#topContainer").css({top:topLarge+"px"}),$("#itemContainer").fadeIn(),$("#item1Container").fadeOut(),$("#item2Container").fadeOut(),$("#mapLegendContainer").fadeOut(),$(".map-legend").css({"padding-top":"30px"}),mapdataviz.closePopup()}function largeContainerPDF(){$("#itemContainer").fadeIn()}function smallContainer(){$("#topContainer").animate({height:heightSmall+"px"}),$("#topContainer").css({top:"auto"}),$("#itemContainer").fadeOut(),$("#item1Container").fadeIn(),$("#item2Container").fadeOut(),$("#mapLegendContainer").fadeIn(),$(".map-legend").css({"padding-top":"0px"})}function startContainer(){$("#topContainer").css({height:"auto"}),$("#topContainer").css({top:topLarge+"px"}),$("#itemContainer").fadeOut(),$("#item1Container").fadeOut(),$("#item2Container").fadeIn(),$("#mapLegendContainer").fadeOut(),$(".map-legend").css({"padding-top":"30px"}),mapdataviz.closePopup()}function updateCountryProfile(profileCountry,mode){function ajaxSuccess(data){null!=data?$.each(window.subTabs,function(subTab,subTabVal){$.each(subTabVal.content[window.lang],function(section,val){$("#subTab"+subTab).append('<div id="sec'+subTab+"-"+section+'" class="section"><div class="headingElement"><h4><span class="subHeadingText">'),$("#sec"+subTab+"-"+section+" .headingElement h4 .subHeadingText").html(val);var subSection=0;void 0!=data[val]&&$.each(data[val],function(key,content){if("h1 text"==key&&$.each(content,function(element,parts){$("#sec"+subTab+"-"+section).append('<p id="textSec'+subTab+"-"+section+"-"+element+'" class="textElement">'),$("#textSec"+subTab+"-"+section+"-"+element).html(parts)}),void 0!=subTabVal.charts&&addChartSections(subTabVal,subTab,section,profileCountry,val,"chartSectionMain"),"h1 text"!=key){$("#sec"+subTab+"-"+section).append('<h5 id="headerSec'+subTab+"-"+section+"-"+subSection+'" class="subSection"><table><tr><td>'),$("#headerSec"+subTab+"-"+section+"-"+subSection+" table tr td").html(key);var subSubSection=0;$.each(content,function(subkey,subcontent){"h2 text"==subkey?($.each(subcontent,function(key,content){$("#sec"+subTab+"-"+section).append('<p id="textSec'+subTab+"-"+section+"-"+subSection+"-"+key+'" class="textElement">'),null!=subTabVal.display&&"expanded"==subTabVal.display?$("#textSec"+subTab+"-"+section+"-"+subSection+"-"+key).html(content):$("#textSec"+subTab+"-"+section+"-"+subSection+"-"+key).html(content).hide()}),void 0!=subTabVal.charts&&(null!=subTabVal.display&&"expanded"==subTabVal.display?addChartSections(subTabVal,subTab,section,profileCountry,key,"chartSectionMain"):addChartSections(subTabVal,subTab,section,profileCountry,key,"chartSection"))):$.each(subcontent,function(key,content){$("#sec"+subTab+"-"+section).append('<h6 id="headerSec'+subTab+"-"+section+"-"+subSection+"-"+subSubSection+'" class="subSection">'),$("#headerSec"+subTab+"-"+section+"-"+subSection+"-"+subSubSection).text(subkey).hide(),$("#sec"+subTab+"-"+section).append('<p id="textSec'+subTab+"-"+section+"-"+subSection+"-"+subSubSection+"-"+key+'" class="textElement">'),$("#textSec"+subTab+"-"+section+"-"+subSection+"-"+subSubSection+"-"+key).html(content).hide()}),subSubSection++})}subSection++})}),null==subTabVal.display&&$("#subTab"+subTab+" .section h5 table tr").append(expand)}):alert("Country profile is not available."),$(".tab a").attr("target","_blank"),$(".expandCollaps").append(expandElements),$("h5").click(function(){var parent=this;$(parent).nextUntil("h5","p").slideToggle(500,function(){}),$(parent).nextUntil("h5","h6").slideToggle(500,function(){}),$(parent).nextUntil("h5",".simpleTable").toggle(),$(parent).nextUntil("h5",".chartSection").toggle(),$(parent).find(".expand").toggle(),$(parent).find(".collaps").toggle()}),"pdf"==mode?largeContainerPDF():largeContainer()}function addChartSections(subTabVal,subTab,section,profileCountry,sectionName,sectionLevel){$.each(subTabVal.charts,function(chart,config){var chartHeader='<div class="'+sectionLevel+'"><div class="chartTitle">'+subTabVal.ConfigSubCharts[chart].title+'</div><div class="chartSubTitle">'+subTabVal.ConfigSubCharts[chart].definition+", "+subTabVal.ConfigSubCharts[chart].options.tooltipUnit+'</div><div style="height:200px" class="chartContainer" id="container'+chart+"-"+subTab+"-"+section+'">';config.section[window.lang]==sectionName&&("simpleTable"==config.chartType&&$("#sec"+subTab+"-"+section).append(addSimpleTable(subTabVal.ConfigSubCharts[chart],profileCountry,config.legendType)),"lineChart"==config.chartType&&(values=filterLocation(subTabVal.ConfigSubCharts[chart],[profileCountry.toLowerCase()]),void 0!=values.data.data[0]&&($("#sec"+subTab+"-"+section).append(chartHeader),addLineChart(values,"container"+chart+"-"+subTab+"-"+section))),"columnChart"==config.chartType&&($("#sec"+subTab+"-"+section).append(chartHeader),addColumnChart(filterYear(subTabVal.ConfigSubCharts[chart],["2012"]),"container"+chart+"-"+subTab+"-"+section),highlightDataPoint(profileCountry.toLowerCase(),"blue",0,"#container"+chart+"-"+subTab+"-"+section)))})}$(".noteCountryName").text(lang_countries_titles[profileCountry.toLowerCase()]||""),$.each(window.subTabs,function(key,value){$("#subTab"+key).html("")}),$.ajax({dataType:"json",url:baseURL+"/api-notes?project="+project+"&lg="+lang+"&cr="+profileCountry.toLowerCase(),success:ajaxSuccess,error:function(xhr,ajaxOptions,thrownError){"404"==xhr.status&&alert("Country profile not available.")}});var expand='<td class="expandCollaps">',expandElements='<span class="controls expand expandText">[expand&nbsp;section]</span><span class="controls collaps expandText">[collapse&nbsp;section]</span>'}function updateCountryProfileSimple(profileCountry){function addChartSections(subTabVal,subTab,section,profileCountry,sectionName,sectionLevel){var complexTable,complexCharts=[];if($.each(subTabVal.charts,function(chart,config){var chartHeader='<div class="'+sectionLevel+'"><div class="chartTitle">'+subTabVal.ConfigSubCharts[chart].title+'</div><div class="chartSubTitle">'+subTabVal.ConfigSubCharts[chart].definition+", "+subTabVal.ConfigSubCharts[chart].options.tooltipUnit+'</div><div style="height:1000px" class="chartContainer" id="container'+chart+"-"+subTab+"-"+section+'">';"simpleTable"==config.chartType&&$("#sec"+subTab+"-"+section).append(addSimpleTable(subTabVal.ConfigSubCharts[chart],profileCountry,config.legendType)),"complexTable"==config.chartType&&(complexCharts.push(subTabVal.ConfigSubCharts[chart]),complexTable=!0),"sortedBarChart"==config.chartType&&(values=filterLocation(subTabVal.ConfigSubCharts[chart],[profileCountry.toLowerCase()]),values.data=flipData(values.data),void 0!=values.data.data[0]&&($("#sec"+subTab+"-"+section).append(chartHeader),addBarChart(values,"container"+chart+"-"+subTab+"-"+section)))}),1==complexTable){var complexTableLabel={en:"Click on column headers to change table sorting. Pass cursor over commodity names and export restriction symbols for detailed definitions and explanations.",cn:"点击列标题改变表格排序。在商品名称和出口限制的符号上点击光标查询详细定义和解释。"};$("#sec"+subTab+"-"+section).append('<div class="helpTextComplexTable">'+complexTableLabel[lang]+"</div>"),$("#sec"+subTab+"-"+section).append(addComplexTable(complexCharts,profileCountry)),$.tablesorter.formatInt=function(s){var i=parseInt(s);return isNaN(i)?null:i},$.tablesorter.formatFloat=function(s){var i=parseFloat(s);return isNaN(i)?null:i},$(".complexTable").tablesorter({sortList:[[0,0]],headers:{1:{sorter:!1}},textExtraction:function(node){var txt=$(node).text();return txt=txt.replace("--",""),txt=txt.replace("*","")}})}}$(".noteCountryName").text(lang_countries_titles[profileCountry.toLowerCase()]||""),$.each(window.subTabs,function(key,value){$("#subTab"+key).html("")}),function(){$.each(window.subTabs,function(subTab,subTabVal){$.each(subTabVal.content,function(section,val){$("#subTab"+subTab).append('<div id="sec'+subTab+"-"+section+'" class="section"><div class="headingElement"><h4><span class="subHeadingText">'),void 0!=subTabVal.charts&&addChartSections(subTabVal,subTab,section,profileCountry,val,"chartSectionMain")})}),largeContainer()}()}function addSimpleTable(values,country,labels){var tableLabels={};tableLabels["fishery-innovation"]={0:'<span style="color:red">No</span>',1:'<span style="color:green">Yes</span>',2:'<span style="color:orange">at EU level</span>',3:'<span style="color:green">EU & national level</span>'},tableLabels["export-restrictions"]={1:'<span style="color:#a80606">Export prohibition</span>',2:'<span style="color:#e70a0d">Export quota</span>',3:'<span style="color:#e78b20">Export tax</span>',4:'<span style="color:#d3e729">Non-automatic licencing</span>',5:'<span style="color:#ca29e7">Other measures</span>',6:'<span style="color:#1ee723">No restrictions</span>'};if(labels)var selectedLabels=tableLabels[labels];var title='<h5 class="simpleTableTitle"><table><tr><td>'+values.title+"</table></tr></td></h5>",rows="",data=getTableData(values.data);return $.each(data,function(indicator,v){null!=v[country.toUpperCase()]&&(rows=labels?rows.concat("<tr><td>"+indicator+"</td><td>"+selectedLabels[v[country.toUpperCase()]]+"</td></tr>"):rows.concat("<tr><td>"+indicator+"</td><td>"+v[country.toUpperCase()]+values.options.tooltipUnit+"</td></tr>"))}),title+'<table class="simpleTable">'+rows+"</table>"}function addComplexTable(values,country){var tab=window.wizardConfig.project.tabs[window.page],commodityLabels=window.wizardConfig.tabs[tab].labels,purposeCodes=window.wizardConfig.tabs[tab].purposeCodes[country.toUpperCase()],labels1={1:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#a80606" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',2:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#e70a0d" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',3:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#e78b20" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',4:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#d3e729" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',5:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#ca29e7" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>',6:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><circle fill="#1ee723" cx="6" cy="6" r="6" stroke="white" stroke-width="0" /></svg>'},labels2={};labels2.en={1:"Export prohibition",2:"Export quota",3:"Export tax",4:"Non-automatic licencing",5:"Other measures",6:"No restrictions"},labels2.cn={1:"禁止出口",2:"出口配额",3:"出口税",4:"非自动许可",5:"其他措施",6:"无限制"};var labels3={};labels3.en={A:"conservation of natural resources",B:"control of foreign exchange",C:"generate revenue",D:"health or environmental protection",E:"monitor or control export activity",F:"promote further processing/value added",G:"protect local downstream industry",H:"safeguard domestic supply",I:"other",J:"no purpose found/indicated"},labels3.cn={A:"自然资源保护",B:"外汇管制",C:"创收",D:"健康或环境保护",E:"出口活动监管",F:"推动进一步处理/增值",G:"保护本地下游产业",H:"保障国内供应",I:"其他",J:"未发现/说明目的"};var labels4={en:"Commodity",cn:"商品"},labels5={en:"purpose",cn:"目的"},head='<table class="complexTable tablesorter"><thead><tr><th><span>'+labels4[lang]+"<span></th><th><span>"+values[0].title+"<span></th><th><span>"+values[1].title+"<span></th><th><span>"+values[2].title+"<span></th></tr></thead><tbody>",rows="",data=[];return $.each(values,function(chart,content){data[chart]=getTableData(content.data)}),$.each(data[0],function(indicator,v){var comLabel=[];commodityLabels.labels[indicator]?(comLabel[0]=commodityLabels.labels[indicator].name,comLabel[1]=commodityLabels.labels[indicator].definition):(comLabel[0]=indicator,comLabel[1]="--");var purpCode,restrictExplain=labels2[lang][v[country.toUpperCase()]],purpCodeExplain=[];if(purposeCodes[indicator]){var purpCodeList=purposeCodes[indicator].split("");purpCode=" ("+purpCodeList+")",$.each(purpCodeList,function(keys,codeValue){purpCodeExplain.push(labels3[lang][codeValue])}),restrictExplain=restrictExplain+" - "+labels5[lang]+": "+purpCodeExplain}else purpCode="";var valRow1,valRow2,labelRow1,labelRow2;data[1][indicator]&&data[1][indicator][country.toUpperCase()]?(valRow1=data[1][indicator][country.toUpperCase()],labelRow1=valRow1):(valRow1=0,labelRow1="--"),data[2][indicator]&&data[2][indicator][country.toUpperCase()]?(valRow2=data[2][indicator][country.toUpperCase()],labelRow2=valRow2):(valRow2=0,labelRow2="--"),null!=v[country.toUpperCase()]&&(rows=rows.concat('<tr><td title="'+comLabel[1]+'">'+comLabel[0]+'</td><td title="'+restrictExplain+'">'+labels1[v[country.toUpperCase()]]+purpCode+'</td><td><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+(valRow1+40)+'" height="13"><rect width="'+valRow1+'" height="13" fill="#a2b9f0" y="0" x="0" stroke="white" stroke-width="0" /><text text-anchor="start" x="'+(valRow1+4)+'" y="11"  font-family="Verdana" font-size="11" color="#636363">'+labelRow1+'</text></svg></td><td><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+(valRow2+40)+'" height="13"><rect width="'+valRow2+'" height="13" fill="#a2b9f0" y="0" x="0" stroke="white" stroke-width="0" /><text text-anchor="start" x="'+(valRow2+4)+'" y="11"  font-family="Verdana" font-size="11" color="#636363">'+labelRow2+"</text></svg></td></tr>"))}),head+rows+"</tbody></table>"}function ChartElement(){var chart,self=this;self.loadChart=function(data,options){var newChart=new chartBasis(data,options);newChart.loadData(),chart=newChart},self.displayCharts=function(container){chart.displayChart(container)}}function chartBasis(data,options){var self=this,loadedData={},defaults={highcharts:{chart:{backgroundColor:"transparent"},plotOptions:{series:{marker:{enabled:!1,states:{hover:{enabled:!0}}},pointPadding:0,borderWidth:0,connectNulls:!0}},exporting:{enabled:!1},legend:{enabled:!1},credits:{enabled:!1},title:{text:null},xAxis:{labels:{step:1,style:{fontSize:"1em"}}},yAxis:{title:{text:null}}},CYCoptions:{typeOfFirstSeries:null}};options=$.extend(!0,defaults,options),self.loadData=function(){var Data=[],categories=data.keys[1];$.each(data.keys[0],function(index,name){var dataPoints=data.data[index].map(function(y,i){return null!=y?{y:parseFloat(y.toFixed(options.CYCoptions.decimals)),id:categories[i],name:categories[i]}:{y:null,id:categories[i]}});Data.push({name:name,data:dataPoints})}),null!=options.CYCoptions.typeOfFirstSeries&&(Data[0].type=options.CYCoptions.typeOfFirstSeries),loadedData={cats:categories,series:Data}},self.displayChart=function(container){var data=loadedData;if(null==data)return!1;var seriesOptions={chart:{renderTo:container},xAxis:{categories:data.cats},series:data.series};return options.highcharts=$.extend(!0,options.highcharts,seriesOptions),new Highcharts.Chart(options.highcharts),!0}}function labelFormat(translatedLables){return function(){if(this.value.toUpperCase()in window.ISO3toFlags){var flag='<img  style="margin-bottom:4px" height=18px src="'+baseURL+"/flags.png?cr="+this.value.toUpperCase()+'">';return'<span style="margin-right:5px" >'+translatedLables[this.value.toLowerCase()]+"</span>"+flag}return void 0!=translatedLables[this.value.toLowerCase()]?'<span style="margin-right:5px" >'+translatedLables[this.value.toLowerCase()]+"</span>":'<span style="margin-right:5px" >'+this.value.toLowerCase()+"</span>"}}function tooltipFormat(values,translatedLables){return function(){if(void 0!=translatedLables[this.x.toLowerCase()])var s="<b>"+translatedLables[this.x.toLowerCase()]+"</b>";else var s="<b>"+this.x+"</b>";return $.each(this.points,function(){s+="<br/>"+this.series.name+": "+this.y+" "+values.options.tooltipUnit}),s}}function addLineChart(values,container){if(Highcharts.setOptions({lang:{numericSymbols:null}}),void 0!=values.data.data[0]){var sbars=new ChartElement;!function(){sbars.loadChart(values.data,{highcharts:{chart:{type:"line"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:10},plotOptions:{series:{markers:{enabled:!1,states:{hover:{enabled:!0}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{reversed:!0,tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"},colors:["#de3a07","#408000","#dca2bf","#fdd14e","#730000","#ffa640","#234010","#6cc3d9","#4400ff","#f200a2","#750039","#33260d","#00e61f","#0099e6","#1f0073","#962c0b","#734939","#735c00","#00f2a2","#004996"]},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}}function addLineStackedBarChart(values,container){if(void 0!=values.data.data[0]){var sbars=new ChartElement;!function(){sbars.loadChart(values.data,{highcharts:{chart:{type:"column"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{area:{stacking:"normal"},bar:{stacking:"normal"},column:{stacking:"normal"},series:{markers:{enabled:!1,states:{hover:{enabled:!0}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals,typeOfFirstSeries:values.options.typeOfFirstSeries||"line"}}),sbars.displayCharts(container)}()}}function addStackedAreaChart(values,container){if(void 0!=values.data.data[0]){var sbars=new ChartElement;!function(){sbars.loadChart(values.data,{highcharts:{chart:{type:"area"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{area:{stacking:"normal"},series:{markers:{enabled:!1,states:{hover:{enabled:!0}}},lineWidth:2}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{tickmarkPlacement:"on",labels:{style:{"font-size":"11px"},step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}}function addBarChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:10},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:!0,overflow:"none",crop:!1,allowOverlap:!0}}},yAxis:{labels:{enabled:!1},gridLineWidth:0,min:values.options.minimum,max:values.options.maximum},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addBarChartFlag(values,container,translatedLabels){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:10,marginLeft:150},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:!0,overflow:"none",crop:!1,allowOverlap:!0}}},yAxis:{labels:{enabled:!1},gridLineWidth:0,min:values.options.minimum,max:values.options.maximum},xAxis:{labels:{useHTML:!0,formatter:labelFormat(translatedLabels)}},tooltip:{shared:!0,useHTML:!0,formatter:tooltipFormat(values,translatedLabels)}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addColumnChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"column"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{dataLabels:{enabled:!1,overflow:"none",crop:!1,allowOverlap:!0}}},yAxis:{min:values.options.minimum,max:values.options.maximum},colors:["#88b60f","#232323"],tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addBarsDiamondsChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0(values.data,0,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"line",marginBottom:20},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{series:{marker:{enabled:!0},lineWidth:0,states:{hover:{lineWidth:0,lineWidthPlus:0}}}},yAxis:{min:values.options.minimum,max:values.options.maximum},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{typeOfFirstSeries:"bar",decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addStackedColumnChart(values,container){var sbars=new ChartElement;!function(){sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"column"},legend:{enabled:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{labels:{step:null}},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addStackedBarChart(values,container){var sbars=new ChartElement;!function(){values.data=sortDimension0sum(values.data,desc=!0),sbars.loadChart(flipData(values.data),{highcharts:{chart:{type:"bar",marginBottom:20},legend:{enabled:!0,reversed:!0,verticalAlign:"top",padding:0,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addPyramidRight(values,container){var sbars=new ChartElement;!function(){sbars.loadChart(flipData(values.data),{highcharts:{title:{text:"Men"},chart:{type:"bar"},legend:{enabled:!0,reversed:!0,verticalAlign:"bottom",padding:5,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"},series:{animation:!1}},yAxis:{min:values.options.minimum,max:values.options.maximum},xAxis:{opposite:!0},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{
decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}function addPyramidLeft(values,container){var sbars=new ChartElement;!function(){sbars.loadChart(flipData(values.data),{highcharts:{title:{text:"Women"},chart:{type:"bar"},legend:{enabled:!0,reversed:!0,verticalAlign:"bottom",padding:5,margin:5},plotOptions:{bar:{stacking:"normal"},column:{stacking:"normal"},series:{animation:!1}},xAxis:{},yAxis:{min:values.options.minimum,max:values.options.maximum,reversed:!0},tooltip:{shared:!0,useHTML:!0,headerFormat:"<small>{point.key}</small><table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}'+values.options.tooltipUnit+"</b></td></tr>",footerFormat:"</table>"}},CYCoptions:{decimals:values.options.tooltipDecimals}}),sbars.displayCharts(container)}()}var landmass,landmassBorder,landmassBorderWidth,landmassGroup,bubbleDefaultBorder,bubbleDefaultColor,bubbleHighlightBorder,shapeHighlightBorder;"ecb"==themeURL?(landmass="#f0f0f0",landmassNA="#fff",landmassBorder="#000",landmassBorderWidth=.5,landmassGroup="#f0f0f0",bubbleDefaultBorder="#494444",bubbleDefaultColor="#d56620",bubbleHighlightBorder="#fff",shapeHighlightBorder="#fff"):(landmass="#939393",landmassNA="#939393",landmassBorder="#939393",landmassBorderWidth=1,landmassGroup="#BBBBBB",bubbleDefaultBorder="#494444",bubbleDefaultColor="#d56620",bubbleHighlightBorder="#fff",shapeHighlightBorder="#fff"),"trade-in-raw-materials"==project&&(landmass="#BBBBBB",landmassNA="#BBBBBB"),"itf-test"==project&&(landmass="#BBBBBB",landmassNA="#BBBBBB");var highlightAndPopupClick=function(disposer){return function(e){var layer=e.target;disposer&&disposer(),disposer=mobx.autorun(function(){var teaserText,specialTooltip=window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltip,specialTooltipLinks=window.wizardConfig.tabs[wizardConfig.project.tabs[page]].specialTooltipLinks;teaserText="export-restrictions-main"==specialTooltip?mapTeaserExportRestrictionsMain(layer.feature.properties[mapCode]):"export-restrictions"==specialTooltip?mapTeaserExportRestrictions(layer.feature.properties[mapCode]):"ifi-country-data"==specialTooltip?mapTeaserIfiCountryData(layer.feature.properties[mapCode],specialTooltipLinks):"multiColored"==window.bubbleMap?mapTeaserTextMulti(layer.feature.properties[mapCode]):mapTeaserText(layer.feature.properties[mapCode]),("ecb"==themeURL||$.inArray(layer.feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1)&&popup.setContent(teaserText)},{name:"map.click"}),("ecb"==themeURL||$.inArray(layer.feature.properties[mapCode].toString().toLowerCase(),MapGroup)>-1)&&(popup.setLatLng(e.latlng),popup.openOn(mapdataviz))}}(),colorIdx=0,flowGroup=L.layerGroup(),activeLayer="",topLarge=80,heightSmall=85;$(window).width()>475&&(topLarge=92,heightSmall=85),$(window).width()>650&&(topLarge=100,heightSmall=70),$(document).ready(function(){var tab=wizardConfig.project.tabs[page],subTabsType=wizardConfig.tabs[tab].subTabsType;wizardConfig.tabs[tab].teaserLayer&&0==window.secondVisit?startContainer():smallContainer(),$(".countryProfilLink").show(),$(".teaserTitle2").text(" - "+lang_labels.TabCountryNote),$.each(subTabs,function(key,value){$("#panelNav").append('<a id="subTabButton'+key+'" href="#subTab'+key+'">'),$("#itemContainer").append('<div id="subTab'+key+'" class="tab">'),$("#subTabButton"+key).text(value.title[lang])}),$("#subTabButton0").addClass("active"),$("#subTab0").addClass("active"),$(document).on("click","#countryProfileMap",function(){"simple"==subTabsType?updateCountryProfileSimple($(this).attr("value").toLowerCase()):updateCountryProfile($(this).attr("value").toLowerCase()),mapdataviz.closePopup()}),$(document).on("click","#euProfileMap",function(){"simple"==subTabsType?updateCountryProfileSimple($(this).attr("value").toLowerCase()):updateCountryProfile($(this).attr("value").toLowerCase()),mapdataviz.closePopup()}),$(".closeLayer").click(smallContainer),$("#panelNav").on("click","a",function(){return $(this).addClass("active").siblings("a.active").removeClass("active"),$($(this).attr("href")).addClass("active").siblings(".tab.active").removeClass("active"),!1})});
//# sourceMappingURL=mapWizardLayer.js.map